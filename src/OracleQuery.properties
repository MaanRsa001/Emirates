#Common and List Page Queries
quotation.option=SELECT CODE, CODEDESC, CODEVALUE FROM TABLE(SELECT QUOTATIONDATA(?,?,?,?,?,?,?,?,?,?,?,?,?) FROM DUAL)
broker=SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?
##customer.selection=SELECT UPPER(NVL(COMPANY_NAME,FIRST_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name , VAT_REG_NO,CUST_VAT_YN FROM PERSONAL_INFO WHERE LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) AND APPLICATION_ID \= '1' 
customer.selection=SELECT UPPER(NVL(COMPANY_NAME,FIRST_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, VAT_REG_NO, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name , VAT_REG_NO,CUST_VAT_YN FROM PERSONAL_INFO WHERE LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) AND APPLICATION_ID \= '1'
#customer.selection=SELECT UPPER (FIRST_NAME) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO WHERE LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) AND APPLICATION_ID \= '1'
GET_OPENCUSTOMER_INFO = SELECT UPPER(NVL(COMPANY_NAME,FIRST_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, B.CUSTOMER_ID,B.VAT_REG_NO, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO B, OPEN_COVER_MASTER C WHERE A.OPEN_COVER_NO\=? AND B.CUSTOMER_ID \= C.CUSTOMER_ID AND C.PROPOSAL_NO \= A.PROPOSAL_NO AND C.AMEND_ID\=(SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO \= A.PROPOSAL_NO)    
report.transaction=SELECT A.TRANSACTION_ID,(SELECT COUNT (1) FROM WEBSERVICE_MARINE_QUOTE WHERE STATUS \= 'Q' AND TRANSACTION_ID \= A.TRANSACTION_ID AND OPENCOVER_POLICY_NUMBER \= A.OPENCOVER_POLICY_NUMBER) VALID_RECORDS, (SELECT COUNT (1) FROM XL_OPENCOVER_RAW WHERE TRANSACTION_ID \= A.TRANSACTION_ID AND OPENCOVER_POLICY_NUMBER \= A.OPENCOVER_POLICY_NUMBER) INVALID_RECORDS FROM XL_TRANSACTION_DETAILS A WHERE A.OPENCOVER_POLICY_NUMBER \= ?
report.declaration=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND (BRANCH_CODE=? or BRANCH_CODE='01')) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD WHERE PM.OPEN_COVER_NO = ? AND PM.STATUS = 'Y' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT SYSDATE FROM DUAL) AND PM.LOGIN_ID = ? AND PM.APPLICATION_ID = NVL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO ORDER BY PM.QUOTE_NO
#report.declaration=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND BRANCH_CODE=?) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD WHERE PM.OPEN_COVER_NO = ? AND PM.STATUS = 'Y' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT SYSDATE FROM DUAL) AND PM.LOGIN_ID = ? AND PM.APPLICATION_ID = NVL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO ORDER BY PM.QUOTE_NO
#report.declaration.transaction=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID\=MPD.SETTLING_AGENT_ID) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD, WEBSERVICE_MARINE_QUOTE WMQ WHERE PM.OPEN_COVER_NO \= ? AND PM.STATUS \= 'Y' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT SYSDATE FROM DUAL) AND PM.LOGIN_ID \= ? AND PM.APPLICATION_ID \= NVL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND PM.QUOTE_NO\=WMQ.QUOTE_NO AND MPD.QUOTE_NO\=PM.QUOTE_NO AND WMQ.STATUS\='Q' AND WMQ.OPENCOVER_POLICY_NUMBER\=PM.OPEN_COVER_NO AND WMQ.TRANSACTION_ID\=? ORDER BY PM.QUOTE_NO
report.declaration.transaction=SELECT PM.POLICY_NO,PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID\=MPD.SETTLING_AGENT_ID AND (BRANCH_CODE\=? or branch_code\='01')) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD, WEBSERVICE_MARINE_QUOTE WMQ WHERE PM.OPEN_COVER_NO \= ? AND PM.STATUS \= 'P' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT SYSDATE FROM DUAL) AND PM.LOGIN_ID \= ? AND PM.APPLICATION_ID \= NVL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND PM.QUOTE_NO\=WMQ.QUOTE_NO AND MPD.QUOTE_NO\=PM.QUOTE_NO AND WMQ.OPENCOVER_POLICY_NUMBER\=PM.OPEN_COVER_NO AND PM.POLICY_NO\=? ORDER BY PM.QUOTE_NO
report_declaration_policy=SELECT (A.POLICY_NO), NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, SUM (A.PREMIUM) PREMIUM, COUNT (A.POLICY_NO) POLICY_COUNT, OCM.MISSIPPI_OPENCOVER_NO OPENCOVER_NO, NVL (PI.COMPANY_NAME, PI.FIRST_NAME || ' ' || PI.LAST_NAME) OPENCOVER_CUST_NAME, OCM.AMEND_ID,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM POSITION_MASTER A,OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM, PERSONAL_INFO PI WHERE A.LOGIN_ID =? AND A.STATUS = 'P' AND NVL (A.OPEN_COVER_INT_STATUS, 0) IN ('LINKED') AND A.PRODUCT_ID = ? AND A.APPLICATION_ID = NVL(?,'1') AND A.OPEN_COVER_NO=OCPM.OPEN_COVER_NO AND OCPM.OPEN_COVER_NO = ? AND OCPM.PROPOSAL_NO = OCM.PROPOSAL_NO AND PI.CUSTOMER_ID = OCM.CUSTOMER_ID AND PI.STATUS = 'Y' AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO = ? AND OCPMS.PROPOSAL_NO = OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <= TO_DATE (SYSDATE, 'dd-MM-YYYY')) GROUP BY A.POLICY_NO, A.LOGIN_ID, A.OPEN_COVER_NO,OCM.MISSIPPI_OPENCOVER_NO, NVL (PI.COMPANY_NAME, PI.FIRST_NAME || ' ' || PI.LAST_NAME), PI.COMPANY_NAME, OCM.AMEND_ID,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO ORDER BY SUBSTR (A.POLICY_NO, 9, 16) DESC
#copyquote.quoteNo=SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND QUOTE_NO = ? AND NVL(PM.OPEN_COVER_NO,'0')=NVL(?,'0') AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
#copyquote.policyNo=	SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND POLICY_NO = ? AND NVL(PM.OPEN_COVER_NO,'0')=NVL(?,'0') AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
#copyquote.custName=SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO\=PM.APPLICATION_NO AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND UPPER(PI.FIRST_NAME) \= UPPER(?) AND NVL(PM.OPEN_COVER_NO,'0')\=NVL(?,'0') AND PM.PRODUCT_ID\=? AND LM.LOGIN_ID\=PM.LOGIN_ID ORDER BY PM.QUOTE_NO
##report.policy=SELECT A.POLICY_NO, TO_CHAR (A.INCEPTION_DATE, 'DD-MM-YYYY') POLICY_ISSUE_DATE, B.MODE_OF_TRANSPORT, H.TRANSPORT_DESCRIPTION FORM_OF_TRANSPORT, E.SALE_TERM_NAME BASIS_OF_VALUATION, B.TOTAL_SUM_INSURED SUM_INSURED_LOCAL, A.PREMIUM BASIC_PREMIUM, NVL(B.PREMIUM,0)+NVL(B.EXCESS_PREMIUM,0) TOTAL_PREMIUM, NVL(A.COMMISSION, '0') COMMISSION, B.TOTAL_WAR_CHARGES WSRCC_PREMIUM, A.DEBIT_NOTE_NO,A.CREDIT_NOTE_NO, A.CERTIFICATE_NO, NVL (G.FIRST_NAME, G.COMPANY_NAME) INSURED_NAME, NVL (MP.BANK_NAME, ' ') BANK_NAME, NVL (MP.CARRIER_NAME, ' ') CARRIER_NAME, A.EXCESS_PREMIUM EXCESS_PREMIUM, B.CURRENCY_NAME CURRENCY_TYPE, TO_CHAR (B.INCEPTION_DATE, 'dd-MM-yyyy') INCEPTION_DATE, (CASE WHEN B.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN B.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN B.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN B.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= B.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, B.TOTAL_SUM_INSURED SUM_INSURED_FOREIGN, (SELECT RTRIM(XMLAGG(XMLELEMENT(E,PACKAGE_DESCRIPTION || ',')).EXTRACT('//text()'),',') PACKAGE_DESCRIPTION FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO)) GOODS_DESCRIPTION, (B.EQUIVALENT_USD + NVL(B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT_DH,( B.EQUIVALENT_USD + NVL (B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) / B.EXCHANGE_RATE EQUIVALENT_USD,B.MARINE_PREMIUM, B.POLICY_FEE  FROM POSITION_MASTER A, MARINE_DATA B, COVER_MASTER D, SALE_TERM_MASTER E, EXTRA_COVER_MASTER F, PERSONAL_INFO G, MODE_OF_TRANSPORT H, MARINE_POLICY_DETAILS MP, COUNTRY_MASTER CNM WHERE B.COVER_ID \= D.COVER_ID AND B.SALE_TERM_ID \= E.SALE_TERM_ID AND F.EXTRA_COVER_ID \= B.EXTRA_COVER_ID AND D.BRANCH_CODE \= E.BRANCH_CODE AND D.BRANCH_CODE \= F.BRANCH_CODE AND D.BRANCH_CODE \= H.BRANCH_CODE AND D.BRANCH_CODE \= '01' AND E.BRANCH_CODE \= '01' AND F.BRANCH_CODE \= '01' AND H.BRANCH_CODE \= '01' AND A.APPLICATION_NO \= B.APPLICATION_NO AND G.CUSTOMER_ID \= A.CUSTOMER_ID AND B.MODE_OF_TRANSPORT \= H.MODE_TRANSPORT_ID AND (A.INCEPTION_DATE BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + 1) AND CNM.COUNTRY_ID \= B.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE (SYSDATE, 'DD-MM-YY') AND G.APPLICATION_ID \= '1' AND G.APPLICATION_ID \= A.APPLICATION_ID AND A.LOGIN_ID IN (?) AND MP.QUOTE_NO \= A.QUOTE_NO AND A.STATUS \= 'P' AND A.PRODUCT_ID \= ? ORDER BY A.INCEPTION_DATE DESC
##report.policyissuer=SELECT A.POLICY_NO, TO_CHAR (A.INCEPTION_DATE, 'DD-MM-YYYY') POLICY_ISSUE_DATE, B.MODE_OF_TRANSPORT, H.TRANSPORT_DESCRIPTION FORM_OF_TRANSPORT, E.SALE_TERM_NAME BASIS_OF_VALUATION, B.TOTAL_SUM_INSURED SUM_INSURED_LOCAL, A.PREMIUM BASIC_PREMIUM, NVL(B.PREMIUM,0)+NVL(B.EXCESS_PREMIUM,0) TOTAL_PREMIUM, NVL(A.COMMISSION, '0') COMMISSION, B.TOTAL_WAR_CHARGES WSRCC_PREMIUM, A.DEBIT_NOTE_NO,A.CREDIT_NOTE_NO, A.CERTIFICATE_NO, NVL (G.FIRST_NAME, G.COMPANY_NAME) INSURED_NAME, NVL (MP.BANK_NAME, ' ') BANK_NAME, NVL (MP.CARRIER_NAME, ' ') CARRIER_NAME, A.EXCESS_PREMIUM EXCESS_PREMIUM, B.CURRENCY_NAME CURRENCY_TYPE, TO_CHAR (B.INCEPTION_DATE, 'dd-MM-yyyy') INCEPTION_DATE, (CASE WHEN B.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN B.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN B.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN B.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= B.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, B.TOTAL_SUM_INSURED SUM_INSURED_FOREIGN, (SELECT RTRIM(XMLAGG(XMLELEMENT(E,PACKAGE_DESCRIPTION || ',')).EXTRACT('//text()'),',') PACKAGE_DESCRIPTION FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO)) GOODS_DESCRIPTION, (B.EQUIVALENT_USD + NVL(B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT_DH,( B.EQUIVALENT_USD + NVL (B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) / B.EXCHANGE_RATE EQUIVALENT_USD, B.MARINE_PREMIUM, B.POLICY_FEE FROM POSITION_MASTER A, MARINE_DATA B, COVER_MASTER D, SALE_TERM_MASTER E, EXTRA_COVER_MASTER F, PERSONAL_INFO G, MODE_OF_TRANSPORT H, MARINE_POLICY_DETAILS MP, COUNTRY_MASTER CNM WHERE B.COVER_ID \= D.COVER_ID AND B.SALE_TERM_ID \= E.SALE_TERM_ID AND F.EXTRA_COVER_ID \= B.EXTRA_COVER_ID AND D.BRANCH_CODE \= E.BRANCH_CODE AND D.BRANCH_CODE \= F.BRANCH_CODE AND D.BRANCH_CODE \= H.BRANCH_CODE AND D.BRANCH_CODE \= '01' AND E.BRANCH_CODE \= '01' AND F.BRANCH_CODE \= '01' AND H.BRANCH_CODE \= '01' AND A.APPLICATION_NO \= B.APPLICATION_NO AND G.CUSTOMER_ID \= A.CUSTOMER_ID AND B.MODE_OF_TRANSPORT \= H.MODE_TRANSPORT_ID AND (A.INCEPTION_DATE BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + 1) AND CNM.COUNTRY_ID \= B.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE (SYSDATE, 'DD-MM-YY') AND A.APPLICATION_ID \= ? AND A.LOGIN_ID IN (?) AND MP.QUOTE_NO \= A.QUOTE_NO AND A.STATUS \= 'P' AND A.PRODUCT_ID \= ? ORDER BY A.INCEPTION_DATE DESC   
copyquote.quoteNo=SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND QUOTE_NO = ? AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
##SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND QUOTE_NO = ? AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
copyquote.policyNo=	SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND POLICY_NO = ?  AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
copyquote.custName=SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO\=PM.APPLICATION_NO AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND UPPER(PI.FIRST_NAME) like UPPER('%'||?||'%') AND PM.PRODUCT_ID\=? AND LM.LOGIN_ID\=PM.LOGIN_ID
report.policy=SELECT distinct(B.APPLICATION_NO), A.POLICY_NO,A.INCEPTION_DATE, TO_CHAR (A.INCEPTION_DATE, 'DD-MM-YYYY') POLICY_ISSUE_DATE, B.MODE_OF_TRANSPORT, H.TRANSPORT_DESCRIPTION FORM_OF_TRANSPORT, E.SALE_TERM_NAME BASIS_OF_VALUATION, B.TOTAL_SUM_INSURED SUM_INSURED_LOCAL, A.PREMIUM BASIC_PREMIUM, NVL(B.PREMIUM,0)+NVL(B.EXCESS_PREMIUM,0) TOTAL_PREMIUM, NVL(A.COMMISSION, '0') COMMISSION, B.TOTAL_WAR_CHARGES WSRCC_PREMIUM, A.DEBIT_NOTE_NO,A.CREDIT_NOTE_NO, A.CERTIFICATE_NO, NVL (G.FIRST_NAME, G.COMPANY_NAME) INSURED_NAME, NVL (MP.BANK_NAME, ' ') BANK_NAME, NVL (MP.CARRIER_NAME, ' ') CARRIER_NAME, A.EXCESS_PREMIUM EXCESS_PREMIUM, B.CURRENCY_NAME CURRENCY_TYPE, TO_CHAR (B.INCEPTION_DATE, 'dd-MM-yyyy') INCEPTION_DATE, (CASE WHEN B.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN B.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN B.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN B.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= B.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, B.TOTAL_SUM_INSURED SUM_INSURED_FOREIGN, (SELECT RTRIM(XMLAGG(XMLELEMENT(E,DESCRIPTION || ',')).EXTRACT('//text()'),',') DESCRIPTION FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO)) GOODS_DESCRIPTION,(SELECT INVOICE_NUMBER FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO=B.APPLICATION_NO AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO=B.APPLICATION_NO)) INVOICE_NUMBER, (B.EQUIVALENT_USD + NVL(B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT_DH,( B.EQUIVALENT_USD + NVL (B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) / B.EXCHANGE_RATE EQUIVALENT_USD,( NVL (B.PREMIUM, 0) - NVL (B.TOTAL_WAR_CHARGES, 0) - NVL (b.POLICY_FEE, '0')) MARINE_PREMIUM, B.POLICY_FEE, TM.TOLERANCE_NAME  FROM POSITION_MASTER A, MARINE_DATA B, COVER_MASTER D, SALE_TERM_MASTER E, EXTRA_COVER_MASTER F, PERSONAL_INFO G, MODE_OF_TRANSPORT H, MARINE_POLICY_DETAILS MP, COUNTRY_MASTER CNM, TOLERANCE_MASTER TM WHERE B.COVER_ID \= D.COVER_ID AND B.SALE_TERM_ID \= E.SALE_TERM_ID AND D.BRANCH_CODE \= TM.BRANCH_CODE AND B.TOLERANCE_ID \= TM.TOLERANCE_ID and F.EXTRA_COVER_ID \= B.EXTRA_COVER_ID AND D.BRANCH_CODE \= E.BRANCH_CODE AND D.BRANCH_CODE \= F.BRANCH_CODE AND D.BRANCH_CODE \= H.BRANCH_CODE AND A.APPLICATION_NO \= B.APPLICATION_NO AND G.CUSTOMER_ID \= A.CUSTOMER_ID AND B.MODE_OF_TRANSPORT \= H.MODE_TRANSPORT_ID AND (A.INCEPTION_DATE BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + 1) AND CNM.COUNTRY_ID \= B.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE (SYSDATE, 'DD-MM-YY') AND G.APPLICATION_ID \= '1' AND G.APPLICATION_ID \= A.APPLICATION_ID AND A.LOGIN_ID IN (?) AND MP.QUOTE_NO \= A.QUOTE_NO AND A.STATUS \= 'P' AND A.PRODUCT_ID \= ? ORDER BY A.INCEPTION_DATE DESC
report.policyissuer=SELECT distinct(B.APPLICATION_NO), A.POLICY_NO,A.INCEPTION_DATE, TO_CHAR (A.INCEPTION_DATE, 'DD-MM-YYYY') POLICY_ISSUE_DATE, B.MODE_OF_TRANSPORT, H.TRANSPORT_DESCRIPTION FORM_OF_TRANSPORT, E.SALE_TERM_NAME BASIS_OF_VALUATION, B.TOTAL_SUM_INSURED SUM_INSURED_LOCAL, A.PREMIUM BASIC_PREMIUM, NVL(B.PREMIUM,0)+NVL(B.EXCESS_PREMIUM,0) TOTAL_PREMIUM, NVL(A.COMMISSION, '0') COMMISSION, B.TOTAL_WAR_CHARGES WSRCC_PREMIUM, A.DEBIT_NOTE_NO,A.CREDIT_NOTE_NO, A.CERTIFICATE_NO, NVL (G.FIRST_NAME, G.COMPANY_NAME) INSURED_NAME, NVL (MP.BANK_NAME, ' ') BANK_NAME, NVL (MP.CARRIER_NAME, ' ') CARRIER_NAME, A.EXCESS_PREMIUM EXCESS_PREMIUM, B.CURRENCY_NAME CURRENCY_TYPE, TO_CHAR (B.INCEPTION_DATE, 'dd-MM-yyyy') INCEPTION_DATE, (CASE WHEN B.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN B.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN B.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN B.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= B.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, B.TOTAL_SUM_INSURED SUM_INSURED_FOREIGN, (SELECT RTRIM(XMLAGG(XMLELEMENT(E,DESCRIPTION || ',')).EXTRACT('//text()'),',') DESCRIPTION FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO)) GOODS_DESCRIPTION,(SELECT INVOICE_NUMBER FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO=B.APPLICATION_NO AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO=B.APPLICATION_NO)) INVOICE_NUMBER, (B.EQUIVALENT_USD + NVL(B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT_DH,( B.EQUIVALENT_USD + NVL (B.TOTAL_SALE_TERM_CHARGES, 0) + NVL (B.TOTAL_TOLERANCE_CHARGES, 0)) / B.EXCHANGE_RATE EQUIVALENT_USD,( NVL (B.PREMIUM, 0) - NVL (B.TOTAL_WAR_CHARGES, 0) - NVL (b.POLICY_FEE, '0')) MARINE_PREMIUM, B.POLICY_FEE, TM.TOLERANCE_NAME FROM POSITION_MASTER A, MARINE_DATA B, COVER_MASTER D, SALE_TERM_MASTER E, EXTRA_COVER_MASTER F, PERSONAL_INFO G, MODE_OF_TRANSPORT H, MARINE_POLICY_DETAILS MP, COUNTRY_MASTER CNM, TOLERANCE_MASTER TM WHERE B.COVER_ID \= D.COVER_ID AND B.SALE_TERM_ID \= E.SALE_TERM_ID AND D.BRANCH_CODE \= TM.BRANCH_CODE AND B.TOLERANCE_ID \= TM.TOLERANCE_ID AND F.EXTRA_COVER_ID \= B.EXTRA_COVER_ID AND D.BRANCH_CODE \= E.BRANCH_CODE AND D.BRANCH_CODE \= F.BRANCH_CODE AND D.BRANCH_CODE \= H.BRANCH_CODE AND A.APPLICATION_NO \= B.APPLICATION_NO AND G.CUSTOMER_ID \= A.CUSTOMER_ID AND B.MODE_OF_TRANSPORT \= H.MODE_TRANSPORT_ID AND (A.INCEPTION_DATE BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + 1) AND CNM.COUNTRY_ID \= B.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE (SYSDATE, 'DD-MM-YY') AND A.APPLICATION_ID \= ? AND A.LOGIN_ID IN (?) AND MP.QUOTE_NO \= A.QUOTE_NO AND A.STATUS \= 'P' AND A.PRODUCT_ID \= ? ORDER BY A.INCEPTION_DATE DESC   
executive=SELECT LED.AC_EXECUTIVE_ID FROM LOGIN_EXECUTIVE_DETAILS LED,BROKER_COMPANY_MASTER BCM WHERE LED.AC_EXECUTIVE_ID=BCM.AC_EXECUTIVE_ID AND BCM.AGENCY_CODE=?
executive.oc=SELECT C.EXECUTIVE_ID FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_MASTER C WHERE A.OPEN_COVER_NO\=? AND C.PROPOSAL_NO \= A.PROPOSAL_NO AND C.AMEND_ID\=(SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO \= A.PROPOSAL_NO)
lapsed.reason=SELECT CATEGORY_DETAIL_ID,DETAIL_NAME FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID = (SELECT CATEGORY_ID FROM CONSTANT_MASTER WHERE CATEGORY_NAME = 'LAPSED_QUOTE_REASON' AND BRANCH_CODE=?)
quote.detail=SELECT A.CUSTOMER_ID, A.QUOTE_NO,TO_CHAR (A.ENTRY_DATE, 'dd/MM/YYYY') QUOTE_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'dd/MM/YYYY') VALIDITY_DATE, NVL (B.FIRST_NAME, B.COMPANY_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.QUOTE_NO = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID
lapsed.update=UPDATE POSITION_MASTER SET STATUS \= 'D',EFFECTIVE_DATE \=(SELECT SYSDATE FROM DUAL),LAPSED_REMARKS \=?,LAPSED_DATE \= (SELECT SYSDATE FROM DUAL), LAPSED_UPDATED_BY \=? WHERE QUOTE_NO \=?
active.lapsed=UPDATE POSITION_MASTER SET ENTRY_DATE=(SELECT SYSDATE+8/24 FROM DUAL),EFFECTIVE_DATE=(SELECT ADD_MONTHS(SYSDATE,1)-1 FROM DUAL) WHERE QUOTE_NO=?
##customer.opencover= SELECT UPPER (NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS, cust_name FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO \= A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <\= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID \= AI.ADDITIONAL_INSURED
customer.opencover= SELECT UPPER (NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, VAT_REG_NO, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS, cust_name FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO \= A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <\= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID \= AI.ADDITIONAL_INSURED
#customer.opencover= SELECT UPPER (FIRST_NAME) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO = ? AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO = A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID = AI.ADDITIONAL_INSURED
##customer.opencover.byname=SELECT UPPER (NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO \= A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <\= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID \= AI.ADDITIONAL_INSURED AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
customer.opencover.byname=SELECT UPPER (NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, VAT_REG_NO, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO \= A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <\= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID \= AI.ADDITIONAL_INSURED AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
#customer.opencover.byname=SELECT UPPER (FIRST_NAME) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO \= A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <\= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID \= AI.ADDITIONAL_INSURED AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
customer.selection.common=SELECT UPPER(NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL ( ADDRESS2, ' ') || NVL ((EMIRATE), ' '), 'select', '' ) ADDRESS,cust_name FROM PERSONAL_INFO WHERE LOGIN_ID IN ( SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= ( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?)) AND APPLICATION_ID \='1'
##customer.selection.byname=SELECT UPPER(FIRST_NAME) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL ( ADDRESS2, ' ') || NVL ((EMIRATE), ' '), 'select', '' ) ADDRESS,cust_name FROM PERSONAL_INFO WHERE LOGIN_ID IN ( SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= ( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?)) AND APPLICATION_ID \='1' AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME 
customer.selection.byname=SELECT UPPER(FIRST_NAME) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, VAT_REG_NO, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL ( ADDRESS2, ' ') || NVL ((EMIRATE), ' '), 'select', '' ) ADDRESS,cust_name FROM PERSONAL_INFO WHERE LOGIN_ID IN ( SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= ( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?)) AND APPLICATION_ID \='1' AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
customer.selection.coreAppCode=AND MISSIPPI_CUSTOMER_CODE LIKE ? ORDER BY FIRST_NAME
customer.selection.mobileNo=AND MOBILE LIKE ? ORDER BY FIRST_NAME
customer.selection.email=AND EMAIL LIKE ? ORDER BY FIRST_NAME
#GET_CORE_CUSTOMER_LIST = SELECT '0'CUSTOMER_ID,UPPER (CUSTNAME) FIRST_NAME, CIMSNO MISSIPPI_CUSTOMER_CODE, EMAIL, MOBILE, CUSTADD1 ADDRESS1, CUSTADD2 ADDRESS2, REPLACE ('P.O.BOX.' || NVL (CUSTADD1, ' ') || NVL (CUSTADD2, ' '),'select', '' )ADDRESS, CUSTNAME cust_name FROM C_CUST WHERE BRCODE=?
#GET_CORE_CUSTOMER_LIST = SELECT '0' CUSTOMER_ID,CUST_CODE MISSIPPI_CUSTOMER_CODE,PC.CUST_NAME, CUST_SHORT_NAME FIRST_NAME, CUST_EMAIL_ID_OFF EMAIL, CUST_ADDR1 ADDRESS1,CUST_ADDR2 ADDRESS2,CUST_MOBILE_NO MOBILE, CUST_POST_BOX_NO POBOX FROM PM_CUSTOMER PC WHERE CUST_SRC_BUS=? AND CUST_CLASS IN (SELECT CORE_APP_CODE FROM BRANCH_MASTER BM WHERE BRANCH_CODE=?)


report.searchByQuote=select * from table(search_list(?,?,?,?,?,?))
#SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND QUOTE_NO LIKE ? ORDER BY QUOTE_NO DESC
#report.searchByQuote= SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,A.STATUS, CASE WHEN A.STATUS='P' THEN 'POLICY' WHEN A.STATUS='Y'  AND  A.EFFECTIVE_DATE > = (SELECT SYSDATE FROM DUAL) AND  (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND M.REMARKS IS NULL THEN 'Quote' WHEN (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  = 'R' THEN 'Referral Reject'  WHEN ( (A.REMARKS IN ('Referal') AND  M.ADMIN_REFERRAL_STATUS  = 'N') OR (A.REMARKS='Referal')  AND M.ADMIN_REFERRAL_STATUS  = 'Y') AND A.EFFECTIVE_DATE > = ( SELECT SYSDATE FROM DUAL) AND A.STATUS='Y' THEN 'Referral'  WHEN ((A.REMARKS IN('Admin') AND M.ADMIN_REFERRAL_STATUS  = 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  = 'N')) AND A.STATUS !='D' THEN 'Approved' when A.STATUS='D'  then 'Rejected'  when A.status='Y' and A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) then 'Lapsed'  WHEN A.status='Y' AND A.REMARKS='Normal' AND M.REMARKS IS NOT NULL THEN 'Referral'  END AS REMARKS  FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M  WHERE A.LOGIN_ID =?  AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL)  AND M.APPLICATION_NO  = A.APPLICATION_NO  AND B.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_ID =? AND A.APPLICATION_ID = NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') = NVL(?,'0')  AND QUOTE_NO LIKE ?  ORDER BY QUOTE_NO DESC
report.searchByPolicy=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND POLICY_NO LIKE ? ORDER BY QUOTE_NO DESC
report.searchByCustomer=select * from table(search_list(?,?,?,?,?,?))
##SELECT * FROM (SELECT A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A. LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A. INCEPTION_DATE,A.POLICY_NO, CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= (SELECT SYSDATE FROM DUAL) AND M.APPLICATION_NO \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0')) WHERE LOWER(TRIM(COMPANY_NAME)) LIKE LOWER(TRIM(?)) OR LOWER(TRIM(CUSTOMER_NAME)) LIKE LOWER(TRIM(?)) ORDER BY QUOTE_NO DESC
#report.searchByCustomer= SELECT * FROM (SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,A.STATUS, CASE WHEN A.STATUS='P' THEN 'POLICY' WHEN A.STATUS='Y'  AND  A.EFFECTIVE_DATE > = (SELECT SYSDATE FROM DUAL) AND  (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND M.REMARKS IS NULL THEN 'Quote' WHEN (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  = 'R' THEN 'Referral Reject'  WHEN ( (A.REMARKS IN ('Referal') AND  M.ADMIN_REFERRAL_STATUS  = 'N') OR (A.REMARKS='Referal')  AND M.ADMIN_REFERRAL_STATUS  = 'Y') AND A.EFFECTIVE_DATE > = ( SELECT SYSDATE FROM DUAL) AND A.STATUS='Y' THEN 'Approved'  WHEN ((A.REMARKS IN('Admin') AND M.ADMIN_REFERRAL_STATUS  = 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  = 'N')) AND A.STATUS !='D' THEN 'Approved' when A.STATUS='D'  then 'Rejected'  when A.status='Y' and A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) then 'Lapsed'  WHEN A.status='Y' AND A.REMARKS='Normal' AND M.REMARKS IS NOT NULL THEN 'Referral'  END AS REMARKS  FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M  WHERE A.LOGIN_ID =?  AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL)  AND M.APPLICATION_NO  = A.APPLICATION_NO  AND B.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_ID =? AND A.APPLICATION_ID = NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') = NVL(?,'0')) WHERE LOWER(TRIM(COMPANY_NAME)) LIKE LOWER(TRIM(?)) OR LOWER(TRIM(CUSTOMER_NAME)) LIKE LOWER(TRIM(?)) ORDER BY QUOTE_NO DESC
search.issuer.brokerList=SELECT DISTINCT(A.LOGIN_ID) LOGIN_ID,D.USERNAME FROM POSITION_MASTER A,PERSONAL_INFO B,MARINE_DATA MD,BROKER_COMPANY_MASTER C, LOGIN_MASTER D WHERE A.PRODUCT_ID = ? AND (A.FREIGHT_STATUS NOT IN('F','B') OR A.FREIGHT_STATUS IS NULL) AND MD.APPLICATION_NO=A.APPLICATION_NO AND A.EFFECTIVE_DATE >= (  SELECT   SYSDATE FROM DUAL) AND A.APPLICATION_ID NOT IN (?,'1') AND C.AGENCY_CODE=D.OA_CODE AND C.BRANCH_CODE=? AND D.LOGIN_ID=A.LOGIN_ID
report.searchByQuoteOthers=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS,M.LC_NUMBER FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID NOT IN (?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND QUOTE_NO LIKE ? ORDER BY QUOTE_NO DESC
quotation.brokerloginId=SELECT LOGIN_ID FROM LOGIN_MASTER LM,BROKER_COMPANY_MASTER BCM WHERE LM.AGENCY_CODE\=BCM.AGENCY_CODE AND BCM.AGENCY_CODE\=?
GET_COUNT_LTSYSDATE=SELECT COUNT(*) FROM DUAL WHERE SYSDATE<TO_DATE(?,'DD-MM-YYYY')+1
GET_SMART_REPORT_LIST = select * from table(smart_report(''{0}'',''{1}'',''{2}'',''{3}'',''{4}'',''{5}'',''{6}'',''{7}'',''{8}'',''{9}''))

#report.report=SELECT (CASE WHEN APPLICATION_ID = '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) + '(' + (SELECT USERTYPE FROM LOGIN_MASTER WHERE LOGIN_ID = PI.LOGIN_ID) + ')' USERNAME, (CASE WHEN APPLICATION_ID = '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) FIRST_NAME FROM PERSONAL_INFO PI WHERE (LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ?)) OR CUSTOMER_LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ?))) AND LOGIN_ID != 'NONE' AND APPLICATION_ID IN ('2', '3', '5') AND OA_CODE IS NOT NULL AND AGENCY_CODE IS NOT NULL ORDER BY APPLICATION_ID
report.report=SELECT (CASE WHEN APPLICATION_ID \= '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) || '(' || (SELECT USERTYPE FROM LOGIN_MASTER WHERE LOGIN_ID \= PI.LOGIN_ID) || ')' USERNAME, (CASE WHEN APPLICATION_ID \= '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) FIRST_NAME FROM PERSONAL_INFO PI WHERE (LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) OR CUSTOMER_LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?))) AND LOGIN_ID \!\= 'NONE' AND APPLICATION_ID IN ('2', '3', '5') AND OA_CODE IS NOT NULL AND AGENCY_CODE IS NOT NULL ORDER BY APPLICATION_ID
travel.report.referral.unapproved=SELECT a.quote_no,a.customer_id, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE,B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO  FROM   home_position_master a, personal_info b   WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? and a.APPLICATION_ID IN (''{0}'')  AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
travel.report.referral.unapprovedQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.unapprovedCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.unapprovedOrderBy=ORDER BY   a.quote_no DESC 
travel.report.referral.approved=SELECT a.quote_no, a.customer_id,TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO FROM   home_position_master a, personal_info b  WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id =? and a.APPLICATION_ID IN (''{0}'')   AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
travel.report.referralQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.CustomerName=AND  (LOWER(LTRIM(RTRIM(b.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(b.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.approvedOrderBy=ORDER BY   a.quote_no DESC 
travel.report.referral.reject=SELECT   a.quote_no, a.LAPSED_REMARKS,TO_DATE(A.LAPSED_DATE,''DD/MM/YYYY'') LAPSED_DATE, a.customer_id, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') AS QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NULL OPEN_COVER_NO FROM   home_position_master a, personal_info b WHERE a.login_id = ? AND (A.STATUS IN (''R'')) AND b.customer_id = a.customer_id AND a.product_id = ? and a.APPLICATION_ID IN (''{0}'') AND a.PAYMENT_STATUS IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
travel.report.referral.rejectQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.rejectCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.rejectOrderBy=ORDER BY a.quote_no DESC 
travel.report.lapsedquote=SELECT A.QUOTE_NO,a.LAPSED_REMARKS,TO_CHAR(A.LAPSED_DATE,''DD/MM/YYYY'') LAPSED_DATE,A.APPLICATION_NO, A.CUSTOMER_ID, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'')  QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,''DD/MM/YYYY'') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME,   ''Rejected''  REJECT_DESC  FROM HOME_POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID =?  AND (A.STATUS IN (''D''))  AND B.CUSTOMER_ID  = A.CUSTOMER_ID  AND A.PRODUCT_ID = ? AND A.APPLICATION_ID IN (''{0}'') AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
travel.report.rejectedQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.rejectedCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.rejectedOrderBy=ORDER BY A.QUOTE_NO DESC
travel.userlist.issuer=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.COMPANY_NAME USERNAME FROM HOME_POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID = ? AND LM.LOGIN_ID=PM.LOGIN_ID AND LM.OA_CODE=BCM.AGENCY_CODE AND PM.STATUS in ('P','Y') AND PM.PRODUCT_ID = ?
travel.issuer.brokerList=SELECT DISTINCT(A.LOGIN_ID) LOGIN_ID,D.USERNAME FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,BROKER_COMPANY_MASTER C, LOGIN_MASTER D WHERE A.PRODUCT_ID = ? AND A.INCEPTION_DATE <= SYSDATE AND A.APPLICATION_ID NOT IN (?,'1') AND C.AGENCY_CODE=D.OA_CODE AND C.BRANCH_CODE=? AND D.LOGIN_ID=A.LOGIN_ID
#travel.report.portfolio=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.LOGIN_ID = ? AND HPM.STATUS = 'P' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID = ? AND PI.STATUS='Y' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND HPM.LOGIN_ID=LM.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE ORDER BY HPM.INCEPTION_DATE DESC
travel.report.portfolio=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,TO_CHAR(HPM.EFFECTIVE_DATE,''DD/MM/YYYY'') QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.LOGIN_ID = ? AND HPM.STATUS = ''P'' AND HPM.AMEND_ID=''0'' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID = ? {0} AND PI.STATUS=''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND HPM.LOGIN_ID=LM.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE
travel.report.portfolioQuoteNo=AND  HPM.QUOTE_NO LIKE ? 
travel.report.portfolioPolicyNo=AND  HPM.POLICY_NO LIKE ?
travel.report.portfolioCustomerName=AND  (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.portfolioissuer=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,TO_CHAR(HPM.EFFECTIVE_DATE,'DD/MM/YYYY') QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.STATUS = 'P' AND HPM.AMEND_ID='0' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID = ? AND HPM.POLICY_NO LIKE ? AND PI.STATUS='Y' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND HPM.LOGIN_ID=LM.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE
travel.report.portfolioOrderBy=ORDER BY HPM.EFFECTIVE_DATE DESC
travel.customer.selection=SELECT UPPER(NVL(COMPANY_NAME,FIRST_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL(ADDRESS1, ' ') || NVL(ADDRESS2, ' ') || NVL(EMIRATE , ' '), 'select', '') ADDRESS,PI.CUSTOMER_SOURCE FROM PERSONAL_INFO PI,LOGIN_MASTER LM1,LOGIN_MASTER LM2 WHERE PI.LOGIN_ID = LM1.LOGIN_ID AND LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID = ? AND pi.APPLICATION_ID = '1' AND PI.STATUS = 'Y' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.customer.selectionCustomerId=AND  PI.CUSTOMER_ID LIKE ?
travel.customer.selectionCusCivilId=AND  PI.CUSTOMER_SOURCE LIKE ?
travel.customer.selectionMobileNo=AND  PI.MOBILE LIKE ? 
travel.customer.selectionCustomerName=AND  (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM( ? ))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.customer.selectionOrderBy=ORDER BY PI.FIRST_NAME 
travel.report.policy=SELECT A.POLICY_NO,TO_CHAR(A.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,A.OVERALL_PREMIUM,A.REMARKS,A.LOGIN_ID,A.QUOTE_NO,A.DEBIT_NOTE_NO,A.RECEIPT_NO,NVL(B.COMPANY_NAME,B.FIRST_NAME) INSURED_NAME,A.COMMISSION,NVL(A.PAYMENT_MODE,'-') PAYMENT_MODE,TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,PM.PRODUCT_DESCRIPTION,NVL(PM.BROKER_ID,'Travel') FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,HOME_PRODUCT_MASTER PM WHERE A.EFFECTIVE_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY')+1 AND A.LOGIN_ID IN (?) AND A.STATUS='P' AND  A.PRODUCT_ID=? AND A.DEBIT_NOTE_NO IS NOT NULL AND A.CUSTOMER_ID=B.CUSTOMER_ID AND PM.PRODUCT_ID = A.PRODUCT_ID  AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS='Y'  and PM.STATUS='Y' ORDER BY A.EFFECTIVE_DATE DESC
travel.report.searchByQuote=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,TO_CHAR(hpm.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(hpm.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (pi.COMPANY_NAME, pi.FIRST_NAME) CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, TO_CHAR(hpm.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE, NVL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND trunc(HPM.EFFECTIVE_DATE) >= trunc(SYSDATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = NVL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID)  AND QUOTE_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.report.searchByPolicy=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,TO_CHAR(hpm.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(hpm.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (pi.COMPANY_NAME, pi.FIRST_NAME) CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, TO_CHAR(hpm.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE, NVL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND trunc(HPM.EFFECTIVE_DATE) >= trunc(SYSDATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = NVL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID)  AND POLICY_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.report.searchByCustomer=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,TO_CHAR(hpm.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(hpm.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (pi.COMPANY_NAME, pi.FIRST_NAME) CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, TO_CHAR(hpm.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE, NVL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND trunc(HPM.EFFECTIVE_DATE) >= trunc(SYSDATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = NVL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID) AND (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?)))) AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.report.searchByQuoteOthers=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR(A.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,TO_CHAR(A.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  = 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID =? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND trunc(A.EFFECTIVE_DATE) > =trunc(SYSDATE) AND M.APPLICATION_NO  = A.APPLICATION_NO AND B.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_ID = ? AND A.APPLICATION_ID NOT IN (?,'1') AND NVL(A.OPEN_COVER_NO,'0') = NVL(?,'0') AND QUOTE_NO LIKE ? AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and B.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.copyquote.quoteNo=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (nvl(pm.PREMIUM,0) + nvl(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE       PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.QUOTE_NO\=? AND LM.LOGIN_ID \= PM.LOGIN_ID  AND (PM.LOGIN_ID\=? OR PM.APPLICATION_ID IN ('1','2')) AND PM.PRODUCT_ID\=? AND PI.STATUS \= 'Y' AND PM.REMARKS IS NULL AND PM.ADMIN_REFERRAL_STATUS IS NULL AND PM.PAYMENT_STATUS IS NULL AND PM.QUOTE_NO IS NOT NULL  AND (TRUNC(PM.EFFECTIVE_DATE) >\= TRUNC(SYSDATE)  OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'P') AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC                             
travel.copyquote.policyNo=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (nvl(pm.PREMIUM,0) + nvl(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE    PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.POLICY_NO\=? AND LM.LOGIN_ID \= PM.LOGIN_ID AND (PM.LOGIN_ID\=? OR PM.APPLICATION_ID IN ('1','2')) AND PM.PRODUCT_ID\=? AND PI.STATUS \= 'Y' AND PM.REMARKS IS NULL AND PM.ADMIN_REFERRAL_STATUS IS NULL AND PM.PAYMENT_STATUS IS NULL AND PM.QUOTE_NO IS NOT NULL AND (TRUNC(PM.EFFECTIVE_DATE) >\= TRUNC(SYSDATE)  OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'P') AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC 
travel.copyquote.custName=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (nvl(pm.PREMIUM,0) + nvl(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE   PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND UPPER (PI.FIRST_NAME) \= UPPER (?) AND LM.LOGIN_ID \= PM.LOGIN_ID AND PI.STATUS \= 'Y' AND PM.REMARKS IS NULL AND PM.ADMIN_REFERRAL_STATUS IS NULL AND PM.PAYMENT_STATUS IS NULL AND PM.QUOTE_NO IS NOT NULL AND PM.LOGIN_ID\=? AND PM.PRODUCT_ID\=? AND (TRUNC(PM.EFFECTIVE_DATE) >\= TRUNC(SYSDATE) OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'P')   AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC
travel.quote.detail=SELECT A.CUSTOMER_ID, A.QUOTE_NO,TO_CHAR(A.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTE_DATE, TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (B.FIRST_NAME, B.COMPANY_NAME) CUSTOMER_NAME FROM HOME_POSITION_MASTER A, PERSONAL_INFO B WHERE A.QUOTE_NO = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.lapsed.update=UPDATE HOME_POSITION_MASTER SET STATUS= 'D',LAPSED_REMARKS=?,LAPSED_DATE=SYSDATE, LAPSED_UPDATED_BY=? WHERE QUOTE_NO=?
travel.active.lapsed=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE\=SYSDATE+30,INCEPTION_DATE\=SYSDATE WHERE QUOTE_NO\=? 
travel.update.correction = UPDATE TRAVEL_DETAIL SET PASSENGER_NAME=? ,GENDER=?,NATIONALITY=? WHERE APPLICATION_NO=? AND SERIAL_NO=?
TRAVEL_CORRECTION_CHECK=select APPLICATION_NO from Home_position_master where INCEPTION_DATE>SYSDATE AND quote_no=?
TRAVEL_GET_CUSTOMER_DETAILS = SELECT pi.CUSTOMER_ID, NVL(pi.FIRST_NAME,'') ||' '|| NVL(pi.LAST_NAME,'') CUS_NAME, pi.NATIONALITY, to_date(pi.DOB,'dd/mm/yyyy') DOB, pi.GENDER, pi.TELEPHONE, pi.MOBILE, pi.FAX, pi.EMAIL, (pi.ADDRESS1||''|| pi.ADDRESS2) address, pi.OCCUPATION,pi.POBOX, pi.COUNTRY, pi.EMIRATE FROM PERSONAL_INFO pi, HOME_POSITION_MASTER hpm WHERE pi.CUSTOMER_ID = hpm.CUSTOMER_ID and hpm.qUOTE_NO =? AND hpm.PRODUCT_ID = ? and pi.status='Y' AND pi.amend_id=(select max(amend_id) from PERSONAL_INFO where CUSTOMER_ID=PI.CUSTOMER_ID)
TRAVEL_GET_PASSENGER_DETAILS = SELECT A.PASSENGER_NAME,TO_CHAR(A.DOB,'DD/MM/YYYY') DOB,A.RELATION,A.NATIONALITY,A.GENDER,B.DETAIL_NAME FROM TRAVEL_DETAIL A,CONSTANT_DETAIL B WHERE B.CATEGORY_ID ='53'  AND A.RELATION=B.CATEGORY_DETAIL_ID AND B.BRANCH_CODE=? AND A.QUOTE_NO=?
TRAVEL_GET_CUSTOMER_POLICY_DETAILS = SELECT POLICY_NO, PREMIUM, TO_CHAR(EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY')  EFFECTIVE_DATE, POLICY_TERM, REMARKS, LAPSED_REMARKS, TO_CHAR(LAPSED_DATE,'DD/MM/YYYY') LAPSED_DATE, LAPSED_UPDATED_BY FROM HOME_POSITION_MASTER WHERE QUOTE_NO =?
 
#travel.report.chart.portfolio= SELECT  COUNT( a.quote_no) FROM HOME_POSITION_MASTER a, personal_info b    WHERE A.EFFECTIVE_DATE<=SYSDATE and  A.effective_Date+30> SYSDATE and {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and a.APPLICATION_ID=?  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.portfolio= SELECT  COUNT( a.quote_no) FROM HOME_POSITION_MASTER a, personal_info b    WHERE A.EFFECTIVE_DATE<=SYSDATE and {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and a.APPLICATION_ID=?  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.quoteregister.lapsed=SELECT COUNT(a.quote_no)  FROM HOME_POSITION_MASTER a, personal_info PI WHERE A.effective_Date < SYSDATE and A.effective_Date+30 >=SYSDATE and {0} a.product_id =? and a.APPLICATION_ID=? AND a.status=''Y''  AND PI.customer_id = a.customer_id  AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.quoteregister.chart.existing=SELECT COUNT( a.quote_no) FROM HOME_POSITION_MASTER a, personal_info b  WHERE {0}  A.effective_Date >= SYSDATE  AND a.status = ''Y'' AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ? AND a.APPLICATION_ID = ? AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.unapproved=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b   WHERE {0} A.effective_Date >= SYSDATE AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? AND a.APPLICATION_ID = ? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.approved=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b  WHERE {0} A.effective_Date >= SYSDATE AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id =?  and a.APPLICATION_ID=? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.reject=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b  WHERE {0} A.effective_date >= SYSDATE AND a.status = ''R'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =?  and a.APPLICATION_ID=? AND  a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
#travel.report.chart.portfolio.amount= SELECT  sum( a.OVERALL_PREMIUM) FROM HOME_POSITION_MASTER a, personal_info b  WHERE A.EFFECTIVE_DATE<=SYSDATE and A.effective_Date+30 > SYSDATE AND {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and a.APPLICATION_ID=? AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.portfolio.amount= SELECT  sum( a.OVERALL_PREMIUM) FROM HOME_POSITION_MASTER a, personal_info b  WHERE A.EFFECTIVE_DATE<=SYSDATE AND {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and a.APPLICATION_ID=? AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.quoteregister.lapsed.amount=SELECT sum( a.OVERALL_PREMIUM)  FROM HOME_POSITION_MASTER a, personal_info PI WHERE A.effective_Date < SYSDATE and A.effective_Date+30 >= SYSDATE and  {0} a.product_id =? and a.APPLICATION_ID=?  AND  a.status=''Y''  AND PI.customer_id = a.customer_id AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.quoteregister.chart.existing.amount=SELECT sum( a.OVERALL_PREMIUM) FROM HOME_POSITION_MASTER a, personal_info b  WHERE {0}  A.effective_Date >= SYSDATE  AND a.status = ''Y'' AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id =? AND a.APPLICATION_ID = ? AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.unapproved.amount=SELECT sum( a.OVERALL_PREMIUM) FROM home_position_master a, personal_info b   WHERE {0} A.effective_Date >\= SYSDATE AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id \=? AND a.APPLICATION_ID \= ? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)  
travel.report.referral.chart.approved.amount=SELECT sum( a.OVERALL_PREMIUM) FROM home_position_master a, personal_info b  WHERE {0} A.effective_Date >\= SYSDATE AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id \=?  and a.APPLICATION_ID\=? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) 
travel.report.referral.chart.reject.amount=SELECT sum( a.OVERALL_PREMIUM) FROM home_position_master a, personal_info b  WHERE {0} (A.STATUS IN (''D'', ''R'')) AND b.customer_id = a.customer_id AND a.product_id =?  and a.APPLICATION_ID=? AND a.PAYMENT_STATUS IS NULL AND A.effective_Date  >= SYSDATE AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)

#Login 
UPD_SESSION_END_TIME=UPDATE SESSION_MASTER SET END_TIME=SYSDATE WHERE SESSION_ID = ? AND LOGIN_ID = ? AND STATUS = ?
GET_BROKER_BRANCH_CODE=SELECT NVL(BRANCH_CODE,'01') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = (SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID IN (''{0}''))
GET_SESSION_CNT=SELECT COUNT(*) FROM SESSION_MASTER WHERE SESSION_ID = ? AND LOGIN_ID = ? AND SYSDATE >= (END_TIME + ({0}/1440)) AND STATUS = ?
GET_CONSTANT_CNT=SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID='40' AND LOWER(DETAIL_NAME)=(SELECT LOWER(USERTYPE) FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND BRANCH_CODE=(SELECT NVL(BRANCH_CODE,'0') FROM LOGIN_MASTER WHERE LOGIN_ID=?)
INS_SESSION_DTL=INSERT INTO SESSION_MASTER(SESSION_ID,LOGIN_ID,START_TIME,END_TIME,STATUS,SYS_IP_ADDRESS)  VALUES(?,?,SYSDATE,SYSDATE,?,?)
UPD_SWAPED_PSW_ID=UPDATE LOGIN_MASTER SET  LPASS10 =  ?, LPASS9 =  ?, LPASS8 =  ?, LPASS7 =  ?, LPASS6 =  ?, LPASS5 =  ?,  LPASS4 =  ?, LPASS3=  ?,LPASS2 =  ?,LPASS1 =  ?,PASSWORD =  ?, PASSDATE=SYSDATE+45 ,STATUS = ? WHERE LOGIN_ID = ?
UPD_SWAPED_PSW_USER=UPDATE LOGIN_MASTER SET LPASS10 =  ?, LPASS9 =  ?, LPASS8 =  ?, LPASS7 =  ?, LPASS6 =  ?, LPASS5 = ? , LPASS4 = ?,LPASS3 = ? ,LPASS2 = ?,LPASS1 = ? ,PASSWORD = ? ,PASS_DT=SYSDATE, STATUS = ? WHERE USERNAME = ?
GET_BR_CODE_BYOACODE=SELECT NVL(BRANCH_CODE,'020') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_BR_CODE_BYLOGINID=SELECT NVL(BRANCH_CODE,'020') FROM LOGIN_RSAUSER_DETAILS WHERE LOGIN_ID=?
GET_BR_DTLS=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,NVL(TAX,'0'),EMAIL FROM BRANCH_MASTER where BRANCH_CODE\=?

#Marine Insurance
quotation.title=SELECT TITLE_NAME FROM TITLE_MASTER WHERE BRANCH_CODE=? AND STATUS='Y' ORDER BY TITLE_NAME
#report.portfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID\=? AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND ORIGINAL_POLICY_NO IS NULL ORDER BY SUBSTR (A.POLICY_NO, 9, 16) DESC
#report.portfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID\=? AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND ORIGINAL_POLICY_NO IS NULL ORDER BY to_number(SUBSTR (A.POLICY_NO, 9, 3)) desc,to_number(regexp_substr(A.POLICY_NO,'[^-]+',1,2)) desc
#report.portfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE {0} A.STATUS \= ''P'' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,''1'')  AND NVL(A.OPEN_COVER_NO,''0'') \= NVL(?,''0'') AND ORIGINAL_POLICY_NO IS NULL
report.portfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE {0} A.STATUS in(''P'',''D'') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ?  AND decode(?,''1'',''1'','''',''1'',a.application_id) \= NVL(?,''1'')  AND NVL(A.OPEN_COVER_NO,''0'') \= NVL(?,''0'') AND ORIGINAL_POLICY_NO IS NULL
#report.lapsedquote=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (ADD_MONTHS (A.EFFECTIVE_DATE - 1, 1), 'DD/MM/YYYY') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC,A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= '1' AND A.APPLICATION_ID  \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0')  ORDER BY A.QUOTE_NO DESC
report.lapsedquote=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.LAPSED_DATE, 'DD/MM/YYYY') LAPSED_DATE, TO_CHAR (ADD_MONTHS (A.ENTRY_DATE - 1, 1), 'DD/MM/YYYY') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC,A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
premium.quotation.insured_goods_info=SELECT CM.COMMODITY_ID, CM.COMMODITY_NAME, NVL(MRD.COMMODITY_EXCESS_PREMIUM,0) POLICY_EXCESS, MRD.DESCRIPTION, MRD.SUM_INSURED, NVL(MRD.RATE,0) RATE, NVL(MRD.WARRATE,0)WARRATE,(RATE+WARRATE) MARINE_WAR_RATE, DECODE(MRD.FRAGILE,'on','YES','off','NO') FRAGILE, MRD.PACKAGE_DESCRIPTION, MRD.SUPPLIER_NAME, MRD.INVOICE_NUMBER FROM MARINE_RESULT_DETAILS MRD, COMMODITYMASTER CM WHERE MRD.APPLICATION_NO \= ? AND CM.COMMODITY_ID \= MRD.COMMODITY_ID AND CM.BRANCH_CODE \= ? AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID \= CM.COMMODITY_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY')) AND TO_DATE (CM.EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY') AND MRD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=MRD.APPLICATION_NO) ORDER BY SNO 
#premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, ( NVL (MD.PREMIUM, 0) - NVL (MD.TOTAL_WAR_CHARGES, 0) - NVL (MD.POLICY_FEE, '0')) MARINE_PREMIUM, NVL (MD.TOTAL_WAR_CHARGES, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, (NVL (MD.PREMIUM, 0) - NVL (MD.POLICY_FEE, '0')) TOTAL_PREMIUM, (NVL (MD.PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER, MPD.BANK_NAME, (SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.SNO,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE SNO \= CYM.SNO AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY')) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.SNO \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.SNO\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID 
#premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, ( NVL (MD.PREMIUM, 0) - NVL (MD.TOTAL_WAR_CHARGES, 0) - NVL (MD.POLICY_FEE, '0')) MARINE_PREMIUM, NVL (MD.TOTAL_WAR_CHARGES, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, (NVL (MD.PREMIUM, 0) - NVL (MD.POLICY_FEE, '0')) TOTAL_PREMIUM, (NVL (MD.PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') THEN 'Y' WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'Y') THEN 'A' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER, MPD.BANK_NAME, (SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.SNO,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE SNO \= CYM.SNO AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY')) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.SNO \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.SNO\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID 
#premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, ( NVL (MD.PREMIUM, 0) - NVL (MD.TOTAL_WAR_CHARGES, 0) - NVL (MD.POLICY_FEE, '0')) MARINE_PREMIUM, NVL (MD.TOTAL_WAR_CHARGES, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, (NVL (MD.PREMIUM, 0) - NVL (MD.POLICY_FEE, '0')) TOTAL_PREMIUM, (NVL (MD.PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER, MPD.BANK_NAME, (SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NVL(MD.EXCESS_PREMIUM,0)<0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.SNO,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE SNO \= CYM.SNO AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY')) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.SNO \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.SNO\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MON-YY') <\= TO_DATE (SYSDATE, 'DD-MON-YY') AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID
#premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION,MD.MODE_OF_TRANSPORT, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, ( NVL (MD.PREMIUM, 0) - NVL (MD.WAR_PREMIUM, 0) - NVL (MD.POLICY_FEE, '0')) MARINE_PREMIUM, NVL (MD.WAR_PREMIUM, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, (NVL (MD.PREMIUM, '0')- NVL (MD.POLICY_FEE, '0')) TOTAL_PREMIUM, (NVL (ROUND(MD.PREMIUM,2), 0) + NVL (MD.EXCESS_PREMIUM, 0)) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER,MPD.BANK_NAME,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID  and (branch_code\=? or branch_code\='01')) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NVL(MD.EXCESS_PREMIUM,0)<0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID, PM.ADMIN_REFERRAL_REMARKS, PM.ADMIN_REMARKS,PM.REMARKS,MD.CHANNEL_TYPE FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.SNO,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE SNO \= CYM.SNO AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE)) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.SNO \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.SNO\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID
#premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION,MD.MODE_OF_TRANSPORT, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, ( NVL (MD.PREMIUM, 0) - NVL (MD.WAR_PREMIUM, 0) - NVL (MD.POLICY_FEE, '0')) MARINE_PREMIUM, NVL (MD.WAR_PREMIUM, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, (NVL (MD.PREMIUM, '0')- NVL (MD.POLICY_FEE, '0')) TOTAL_PREMIUM, (NVL (ROUND(MD.PREMIUM,2), 0) + NVL (MD.EXCESS_PREMIUM, 0)) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER,MPD.BANK_NAME,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID  and (branch_code\=? or branch_code\='01')) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NVL(MD.EXCESS_PREMIUM,0)<0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID, PM.ADMIN_REFERRAL_REMARKS, PM.ADMIN_REMARKS,PM.REMARKS,MD.CHANNEL_TYPE FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.CONV_MEAN,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN \= CYM.CONV_MEAN AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE)) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.CONV_MEAN \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.CONV_MEAN\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID
##premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION,MD.MODE_OF_TRANSPORT, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, MARINE_PREMIUM, NVL (MD.WAR_PREMIUM, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, (NVL (MD.PREMIUM, '0')- NVL (MD.POLICY_FEE, '0')) TOTAL_PREMIUM, (NVL (ROUND(MD.PREMIUM,2), 0) + NVL (MD.EXCESS_PREMIUM, 0)) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER,MPD.BANK_NAME,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID  and (branch_code\=? or branch_code\='01')) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NVL(MD.EXCESS_PREMIUM,0)<0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID, PM.ADMIN_REFERRAL_REMARKS, PM.ADMIN_REMARKS,PM.REMARKS,MD.CHANNEL_TYPE FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.CONV_MEAN,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN \= CYM.CONV_MEAN AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE)) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.CONV_MEAN \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.CONV_MEAN\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID
premium.quotation.information=SELECT round(md.VAT_TAX_AMT,2) VAT_TAX_AMT,md.VAT_TAX_PERCENT,MT.TRANSPORT_DESCRIPTION,MD.MODE_OF_TRANSPORT, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, MARINE_PREMIUM, NVL (MD.WAR_PREMIUM, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, (NVL (MD.PREMIUM, '0')- NVL (MD.POLICY_FEE, '0')) TOTAL_PREMIUM, ROUND((NVL (ROUND(MD.PREMIUM,2), 0) + NVL (MD.EXCESS_PREMIUM, 0)+NVL (MD.VAT_TAX_AMT, 0)),2) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER,MPD.BANK_NAME,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID  and (branch_code\=? or branch_code\='01')) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NVL(MD.EXCESS_PREMIUM,0)<0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID, PM.ADMIN_REFERRAL_REMARKS, PM.ADMIN_REMARKS,PM.REMARKS,MD.CHANNEL_TYPE FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.SNO,CYM.CONV_MEAN,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN \= CYM.CONV_MEAN AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) UNION ALL SELECT 0,0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE)) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.SNO \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.CONV_MEAN\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID and rownum=1
quotation.branchInfo=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,NVL(TAX,'0'),EMAIL FROM BRANCH_MASTER WHERE BRANCH_CODE=?
GET_SALETERM_VALUE = select sale_term_value from sale_term_master where sale_term_id\=? and branch_code\=(select belonging_branch from branch_master where branch_code\=?) and status\='Y'
GET_SALETERM_VAL = select sale_term_value from sale_term_master where sale_term_id\=? and branch_code\=?
GET_TOLERANCE_PERCENT = SELECT TOLERANCE_VALUE FROM TOLERANCE_MASTER WHERE TOLERANCE_ID=? AND BRANCH_CODE=?

quotation.commodity.total=SELECT COUNT(1) TOTAL_COMMODITY, SUM(SUMINSURED) SUM_INSURED,RTRIM(XMLAGG(XMLELEMENT(E,COMMODITY_DESCRIPTION || ',')).EXTRACT('//text()'),',') COMMODITY_DESCRIPTION  FROM WEBSERVICE_MARINE_COMMODITY WHERE REFERENCE_NUMBER=?
commodity.update=UPDATE WEBSERVICE_MARINE_COMMODITY SET SUPPLIER_NAME=?,PACKAGE_DESCRIPTION=?,INVOICE_NUMBER=?,INVOICE_DATE=?,COMMODITY_GROUP_ID=? WHERE APPLICATION_NO=? AND COMMODITY_ID=?
#quote.add=INSERT INTO WEBSERVICE_MARINE_QUOTE (BROKER_CODE, REFERENCE_NUMBER, TYPE, OPENCOVER_POLICY_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT, POLICY_START_DATE, SAILING_DATE, VESSEL_NAME, LC_NUMBER, ISSUING_BANK, LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, BL_AWB_DATE, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_VALUE,ADDRESS1,ADDRESS2,EMAIL,CUSTOMER_ID,CUST_TITLE,CUST_CORE_APP_CODE,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER,SETTLING_AGENT_NAME,AC_EXECUTIVE_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID,APPLICATION_NO, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME, core_customer_name) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) 
quote.add=INSERT INTO WEBSERVICE_MARINE_QUOTE (BROKER_CODE, REFERENCE_NUMBER, TYPE, OPENCOVER_POLICY_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT, POLICY_START_DATE, SAILING_DATE, VESSEL_NAME,VESSEL_IMO_NO,LC_NUMBER, ISSUING_BANK, LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, BL_AWB_DATE, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_VALUE,ADDRESS1,ADDRESS2,EMAIL,CUSTOMER_ID,CUST_TITLE,CUST_CORE_APP_CODE,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER,SETTLING_AGENT_NAME,AC_EXECUTIVE_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID,APPLICATION_NO, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME, core_customer_name,CHANNEL_TYPE,EXCHANGE_RATE,VAT_REG_NO,CUST_VAT_YN,VAT_APPLICABLE,SHIPMENT_TRANSIT) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
quote.update=UPDATE WEBSERVICE_MARINE_QUOTE SET TYPE=?, CUSTOMER_NAME=?, PO_BOX=?, EMIRATE=?, MOBILE_NUMBER=?, MODE_OF_TRANSPORT=?, ORIGINATING_COUNTRY=?, DESTINATION_COUNTRY=?, ORIGINATING_COUNTRY_CITY=?, DESTINATION_COUNTRY_CITY=?, ORIGIN_CITY_NAME=?, DEST_CITY_NAME=?, ORIGINATING_WAREHOUSE_COVERAGE=?, DESTINATION_WAREHOUSE_COVERAGE=?, SALETERM_PERCENT=?, CURRENCY=?, SETTLING_AGENT=?, POLICY_START_DATE=TO_DATE(?,'DD/MM/YYYY'), SAILING_DATE=TO_DATE(?,'DD/MM/YYYY'), VESSEL_NAME=?,VESSEL_IMO_NO=?, LC_NUMBER=?, ISSUING_BANK=?, LC_DATE=TO_DATE(?,'DD/MM/YYYY'), PARTIAL_SHIPMENT=?, BL_AWB_NUMBER=?, BL_AWB_DATE=TO_DATE(?,'DD/MM/YYYY'), COVERAGES=?, SEA_COVERAGES=?, WSRCC=?, TOLERANCE=?, PACKAGE_TYPE=?, SALETERM_VALUE=?,ADDRESS1=?,ADDRESS2=?,EMAIL=?,CUSTOMER_ID=?,CUST_TITLE=?,CUST_CORE_APP_CODE=?,CUST_CONTRACT_NO=?, CUST_FMS_CASE_NO=?, CUST_REFERENCE_NO=?,SETTLING_AGENT_NAME=?,SHIPMENT_EXPOSURE=?,EXPOSURE_CURRENCY=?,AC_EXECUTIVE_ID=?,CUST_AR_NO=?,VESSEL_ID=?,ISSUER=?,PROMOTIONAL_CODE=?, CONSIGNEE_DET=?, SPECIAL_TERM=?, ADD_CUST_NAME=?, core_customer_name=?,EXCHANGE_RATE=?,CHANNEL_TYPE=?,VAT_REG_NO=?,CUST_VAT_YN=? ,VAT_APPLICABLE=?,SHIPMENT_TRANSIT=?,QUOTE_NO=? WHERE APPLICATION_NO=?
quote.count=SELECT (CASE WHEN COUNT(1)>0 THEN 'M' ELSE 'F' END) FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO\=? OR QUOTE_NO\=?
#quote.edit=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, MOC_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_VALUE, CURRENCY, (CASE WHEN SETTLING_AGENT IS NULL AND LENGTH(TRIM(SETTLING_AGENT_NAME))>0 THEN '0' ELSE SETTLING_AGENT END) SETTLING_AGENT, TO_CHAR(POLICY_START_DATE,'MM/DD/YYYY') POLICY_START_DATE, TO_CHAR(SAILING_DATE,'MM/DD/YYYY') SAILING_DATE, VESSEL_NAME, DECODE(LC_NUMBER,'0','',LC_NUMBER) LC_NUMBER, ISSUING_BANK, TO_CHAR(LC_DATE,'MM/DD/YYYY') LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, TO_CHAR(BL_AWB_DATE,'MM/DD/YYYY') BL_AWB_DATE, QUOTE_NO, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_PERCENT,CUST_TITLE,CUST_CORE_APP_CODE,ADDRESS1,ADDRESS2,EMAIL,OPENCOVER_POLICY_NUMBER,APPLICATION_NO,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER, SETTLING_AGENT_NAME, AC_EXECUTIVE_ID,CUSTOMER_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME,core_customer_name FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO=? OR QUOTE_NO=?
quote.edit=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, MOC_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_VALUE, CURRENCY, (CASE WHEN SETTLING_AGENT IS NULL AND LENGTH(TRIM(SETTLING_AGENT_NAME))>0 THEN '0' ELSE SETTLING_AGENT END) SETTLING_AGENT, TO_CHAR(POLICY_START_DATE,'MM/DD/YYYY') POLICY_START_DATE, TO_CHAR(SAILING_DATE,'MM/DD/YYYY') SAILING_DATE, VESSEL_NAME, DECODE(LC_NUMBER,'0','',LC_NUMBER) LC_NUMBER, ISSUING_BANK, TO_CHAR(LC_DATE,'MM/DD/YYYY') LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, TO_CHAR(BL_AWB_DATE,'MM/DD/YYYY') BL_AWB_DATE, QUOTE_NO, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_PERCENT,CUST_TITLE,CUST_CORE_APP_CODE,ADDRESS1,ADDRESS2,EMAIL,OPENCOVER_POLICY_NUMBER,APPLICATION_NO,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER, SETTLING_AGENT_NAME, AC_EXECUTIVE_ID,CUSTOMER_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME,core_customer_name,CHANNEL_TYPE,EXCHANGE_RATE,VAT_REG_NO,nvl(CUST_VAT_YN,'NO') CUST_VAT_YN ,VAT_APPLICABLE,VESSEL_IMO_NO,SHIPMENT_TRANSIT FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO=? OR QUOTE_NO=?
premium.update.policy.info=UPDATE WEBSERVICE_MARINE_QUOTE SET PDF_PRE_SHOW_STATUS=?, PDF_BANKER_STATUS=?, PDF_GENERATE_STATUS=?, PDF_BANKER_ASSURED_STATUS=?, PDF_CURRENCY_STATUS=?,PDF_STAMP_STATUS=?,NOTE_TYPE=?, PAYMENT_MODE=?, BASIS_VAL=?,CERT_CLAUSES_YN=?,DEBIT_CUST_ID=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=? WHERE APPLICATION_NO=?
premium.update.referral=UPDATE MARINE_DATA A SET ADMIN_REFERRAL_STATUS=?, REMARKS=? WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO=A.APPLICATION_NO)
report.quoteregister.lapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= '1' AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
UPD_EXCESS_WMC=UPDATE WEBSERVICE_MARINE_COMMODITY SET COMMODITY_EXCESS_PREMIUM=? where APPLICATION_NO=?
UPD_EXCESS_MRD=UPDATE Marine_Result_details SET COMMODITY_EXCESS_PREMIUM=? where APPLICATION_NO=?
#report.quoteregister.lapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0')
report.quoteregister.existing= SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
report.referral.unapproved= SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
report.referral.approved= SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
report.referral.reject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') AS QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0'), NVL (A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0')    
premium.update.md=UPDATE MARINE_DATA A SET PREMIUM=?,EXCESS_PREMIUM=?,POLICY_FEE=?,TOTAL_WAR_CHARGES=? WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO=A.APPLICATION_NO)
premium.update.pm=UPDATE POSITION_MASTER A SET PREMIUM=?,EXCESS_PREMIUM=? WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
premium.getpolicy.info=SELECT PM.QUOTE_NO, TO_CHAR (PM.ENTRY_DATE, 'DD/MM/YYYY') QUOTE_DATE,TO_CHAR (PM.ENTRY_DATE, 'DD/MM/YYYY') POL_DATE,TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') COVER_START_DATE, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN '' ELSE PM.CREDIT_NOTE_NO END) CREDIT_NOTE_NO, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN '' ELSE PM.POLICY_NO END) POLICY_NO, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN '' ELSE PM.DEBIT_NOTE_NO END) DEBIT_NOTE_NO, MD.TOTAL_SUM_INSURED, NVL(MD.PREMIUM,0)+NVL(MD.EXCESS_PREMIUM,0)+NVL(MD.VAT_TAX_AMT,0)  PREMIUM, (SELECT NVL (FIRST_NAME, COMPANY_NAME) || LAST_NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID)) PROPOSER_NAME, PDF_PRE_SHOW_STATUS, PDF_BANKER_STATUS, PDF_BANKER_ASSURED_STATUS, PDF_CURRENCY_STATUS,PDF_EXCESS_STATUS,PDF_STAMP_STATUS,(CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS,PM.LOGIN_ID,PM.CERT_CLAUSES_YN,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN,MD.EQUIVALENT_USD,(MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT FROM POSITION_MASTER PM, MARINE_DATA MD WHERE PM.APPLICATION_NO \= ? AND PM.APPLICATION_NO \= MD.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO \= MD.APPLICATION_NO) AND PM.AMEND_ID\=MD.AMEND_ID
#premium.getpolicy.info=SELECT PM.QUOTE_NO, TO_CHAR (PM.ENTRY_DATE, 'DD/MM/YYYY') QUOTE_DATE,TO_CHAR (PM.ENTRY_DATE, 'DD/MM/YYYY') POL_DATE,TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') COVER_START_DATE, (CASE WHEN (SELECT FREIGHT_DEBIT_OPTION FROM LOGIN_USER_DETAILS LUD WHERE AGENCY_CODE\=(SELECT AGENCY_CODE FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID\=PM.LOGIN_ID) AND ROWNUM\=1 AND LUD.PRODUCT_ID\=PM.PRODUCT_ID)\='Y' AND PM.STATUS IN ('P','D') THEN 'Y' ELSE '' END) CREDIT_NOTE_NO, (CASE WHEN PM.STATUS NOT IN('P','C') THEN '' ELSE PM.POLICY_NO END) POLICY_NO, (CASE WHEN PM.STATUS NOT IN('P','C') THEN '' ELSE PM.DEBIT_NOTE_NO END) DEBIT_NOTE_NO, MD.TOTAL_SUM_INSURED, NVL(MD.PREMIUM,0)+NVL(MD.EXCESS_PREMIUM,0) PREMIUM, (SELECT NVL (FIRST_NAME, COMPANY_NAME) || LAST_NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID)) PROPOSER_NAME, PDF_PRE_SHOW_STATUS, PDF_BANKER_STATUS, PDF_BANKER_ASSURED_STATUS, PDF_CURRENCY_STATUS,PDF_EXCESS_STATUS,PDF_STAMP_STATUS,(CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS,PM.LOGIN_ID,PM.CERT_CLAUSES_YN,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN,MD.EQUIVALENT_USD,(MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT FROM POSITION_MASTER PM, MARINE_DATA MD WHERE PM.APPLICATION_NO \= ? AND PM.APPLICATION_NO \= MD.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO \= MD.APPLICATION_NO) AND PM.AMEND_ID\=MD.AMEND_ID     
premium.custAccount=SELECT CUST_AR_NO FROM PERSONAL_INFO WHERE CUSTOMER_ID=(SELECT A.CUSTOMER_ID FROM POSITION_MASTER A WHERE A.APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO))
premium.clauses.update=UPDATE POSITION_MASTER A SET  PDF_MODIFY_CLAUSE\=?, PDF_MODIFY_WARRANTY\=?, PDF_MODIFY_EXCLUSION\=?, PDF_MODIFY_EXTRACLAUSES\=? WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO\=A.APPLICATION_NO)
warOption=SELECT NVL(WRSC_YN,'Y') FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))     
brokerType=SELECT (CASE WHEN COUNT(*)>0 THEN 'GHQ' ELSE '' END) BROKER_TYPE FROM LOGIN_USER_DETAILS WHERE LOGIN_ID \= ? AND  OA_CODE IN (SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=133)
quotation.getvessel=SELECT VESSEL_ID,VESSEL_NAME,VESSEL_TYPE,VESSEL_CLASS,MANUFACTURE_YEAR FROM VESSEL_MASTER WHERE STATUS IN ('Y','R') AND UPPER(VESSEL_NAME) LIKE UPPER(?) ORDER BY VESSEL_NAME                    
loginId=SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE\=? AND USERTYPE\='Broker'
report.userlist=SELECT LOGIN_ID,USERNAME FROM LOGIN_MASTER WHERE OA_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USERTYPE != 'Customer' AND USERTYPE != 'User' AND USERTYPE != 'Freight') AND USERTYPE != 'Freight' AND LOGIN_ID IN (SELECT DISTINCT (A.LOGIN_ID) FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.PRODUCT_ID = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y')
report.userlist.issuer=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.COMPANY_NAME USERNAME FROM POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID \= ? AND LM.LOGIN_ID\=PM.LOGIN_ID AND LM.OA_CODE\=BCM.AGENCY_CODE AND PM.STATUS in ('P','Y') AND PM.PRODUCT_ID \= ?
declaration.quote.info=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM, PM.POLICY_NO, NVL(PM.CREDIT_NOTE_NO,0) CREDIT_NOTE_NO, NVL(PM.DEBIT_NOTE_NO,0) DEBIT_NOTE_NO FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD WHERE PM.QUOTE_NO IN (\:QUOTE_NOS) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND PI.CUSTOMER_ID\=PM.CUSTOMER_ID
#declaration.update.quote=UPDATE POSITION_MASTER SET PDF_GENERATE_STATUS\=?,PDF_STAMP_STATUS\=? WHERE QUOTE_NO IN (\:QUOTE_NOS)
declaration.update.quote=UPDATE POSITION_MASTER SET PDF_GENERATE_STATUS\=''{0}'',PDF_STAMP_STATUS\=''{1}'' WHERE QUOTE_NO IN ({2})
declaratiion_policy_individual=SELECT A.POLICY_NO||'/'||(ROWNUM) POLICY_NO, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS QUOTE_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.QUOTE_NO, NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM POSITION_MASTER WHERE POLICY_NO \= ?) AND A.STATUS \= 'P' AND NVL (A.OPEN_COVER_INT_STATUS, 0) IN ('LINKED') AND A.POLICY_NO \= ? AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= 11 ORDER BY POLICY_NO
quotation.lcnoExist=SELECT CASE WHEN COUNT(LC_NUMBER)=0 THEN 'FALSE' ELSE 'TRUE' END AVAILABLE FROM WEBSERVICE_MARINE_QUOTE WHERE LC_NUMBER=? AND APPLICATION_NO!=?
quotation.invoiceExist=SELECT CASE WHEN COUNT(INVOICE_NUMBER)\=0 THEN 'FALSE' ELSE 'TRUE' END AVAILABLE FROM WEBSERVICE_MARINE_COMMODITY WHERE INVOICE_NUMBER\=?  AND APPLICATION_NO\!\=?
condition1=SELECT CLAUSES_ID CODE,CLAUSES_DESCRIPTION CODE_DESC FROM CLAUSES_MASTER WHERE COVER_ID=:cover AND CLAUSES_ID NOT IN(:id) AND EXTRA_COVER_ID=0 AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY CLAUSES_ID
condition2=SELECT CLAUSES_ID CODE,CLAUSES_DESCRIPTION CODE_DESC FROM CLAUSES_MASTER WHERE COVER_ID=:cover AND CLAUSES_ID NOT IN(:id) AND EXTRA_COVER_ID!=0 AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY CLAUSES_ID
condition3=SELECT EXCLUSION_ID CODE,EXCLUSION_DESCRIPTION CODE_DESC FROM EXCLUSION_MASTER WHERE EXCLUSION_ID NOT IN(:id) AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY EXCLUSION_ID
condition4=SELECT WARRANTY_ID CODE,WARRANTY_DESCRIPTION CODE_DESC FROM WARRANTY_MASTER WHERE WARRANTY_ID NOT IN(:id) AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY WARRANTY_ID
premium.clauses.add=UPDATE POSITION_MASTER SET  PDF_MODIFY_CLAUSE\=PDF_MODIFY_CLAUSE||?, PDF_MODIFY_WARRANTY\=PDF_MODIFY_WARRANTY||?, PDF_MODIFY_EXCLUSION\=PDF_MODIFY_EXCLUSION||?, PDF_MODIFY_EXTRACLAUSES\=PDF_MODIFY_EXTRACLAUSES||? WHERE QUOTE_NO\=?
report.customer= SELECT NVL (FIRST_NAME, COMPANY_NAME) CUSTOMER_NAME , EMAIL, MOBILE, MISSIPPI_CUSTOMER_CODE, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') ||','|| NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') ||','|| NVL (EMIRATE, ' '), 'select','') ADDRESS FROM PERSONAL_INFO WHERE LOGIN_ID \=? AND APPLICATION_ID\= 1 ORDER BY CUSTOMER_ID DESC 
arNoStatus=SELECT CUST_AR_NO FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
opencover.customer=SELECT PI.CUST_AR_NO FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM, PERSONAL_INFO PI WHERE OCPM.OPEN_COVER_NO=? AND PI.CUSTOMER_ID=OCM.CUSTOMER_ID AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCMS.PROPOSAL_NO AND TO_DATE(OCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY'))
#direct.status=SELECT DECODE (cd.remarks, NULL, 'N', 'Y') direct_status FROM position_master pm LEFT OUTER JOIN constant_detail cd ON  CD.REMARKS = PM.LOGIN_ID AND CD.CATEGORY_ID = 129 AND cd.branch_code = ? AND cd.status = 'Y' WHERE pm.application_no = ?
direct.status=Select decode(Count(*),0,'N','Y') direct_status from constant_detail cd Where cd.branch_code = ? and  Cd.remarks =(Select login_id from login_master lm Where agency_code = (Select Oa_Code From Login_Master Lm Where Lm.Login_Id In (Select Pm.Login_Id From Position_Master Pm Where Pm.Application_No=?)))
premium.basisValList=SELECT CATEGORY_DETAIL_ID, REMARKS FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=135 AND BRANCH_CODE\=? AND STATUS\='Y' ORDER BY CATEGORY_DETAIL_ID
report.searchByPortfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE,'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,BCM.COMPANY_NAME FROM POSITION_MASTER A, PERSONAL_INFO B ,BROKER_COMPANY_MASTER BCM,LOGIN_MASTER LM WHERE A.LOGIN_ID=? AND LM.LOGIN_ID=A.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE AND B.AMEND_ID = (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID ) AND A.STATUS = 'P' AND B.CUSTOMER_ID = A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID = ? AND A.APPLICATION_ID = NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') = NVL(?,'0') AND ORIGINAL_POLICY_NO IS NULL AND DECODE(?,'policyNo',A.POLICY_NO,'quoteNo',A.QUOTE_NO,'custName',UPPER(NVL (B.COMPANY_NAME, B.FIRST_NAME)),A.POLICY_NO) LIKE UPPER(?) ORDER BY TO_NUMBER(SUBSTR (A.POLICY_NO, 6, 6)) DESC,TO_NUMBER(REGEXP_SUBSTR(A.POLICY_NO,'[^-]+',1,2)) DESC
report.searchByQuoteExisting=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByQuoteLapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByQuoteReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (ADD_MONTHS (A.ENTRY_DATE - 1, 1), 'DD/MM/YYYY') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC, A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= '1' AND A.APPLICATION_ID  \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByReferralApproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC 
report.searchByReferralUnapproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC 
report.searchByReferralReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') AS QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0'), NVL(A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteExisting=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteLapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(PI.COMPANY_NAME) like upper(?) OR  UPPER(PI.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (ADD_MONTHS (A.ENTRY_DATE - 1, 1), 'DD/MM/YYYY') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC, A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= '1' AND A.APPLICATION_ID  \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerReferralApproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC 
report.searchByCustomerReferralUnapproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC 
report.searchByCustomerReferralReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') AS QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0'), NVL(A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
VIEW_CLAUSES_OPTION = SELECT NVL(CLAUSES_YN,'N') FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))
GET_RSABROKER_CODE = SELECT RSA_BROKER_CODE FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_CORECUSTOMER_CODE = SELECT MISSIPPI_CUSTOMER_CODE FROM PERSONAL_INFO PI WHERE CUSTOMER_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID=PI.CUSTOMER_ID)
marine.exchangeLimit=SELECT ROUND(EM.EXCHANGE_RATE-(EM.EXCHANGE_RATE*(NVL(CM.EX_MINLMT,'1')/100)),4) MIN_LIMIT,ROUND(EM.EXCHANGE_RATE+(EM.EXCHANGE_RATE*(NVL(CM.EX_MAXLMT,'1')/100)),4) MAX_LIMIT  FROM CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE CM.COUNTRY_ID\=(SELECT ORIGINATION_COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE\=?) AND CM.CURRENCY_ID\=? AND CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=CM.CURRENCY_ID AND CURRENCY_ID\=CM.CURRENCY_ID AND TRUNC(EFFECTIVE_DATE)<\=TRUNC(SYSDATE)) AND TRUNC(CM.EFFECTIVE_DATE)<\=TRUNC(SYSDATE) AND CM.CURRENCY_ID\=EM.CURRENCY_ID AND CM.COUNTRY_ID\=EM.COUNTRY_ID  AND EM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM EXCHANGE_MASTER WHERE CURRENCY_ID\=EM.CURRENCY_ID AND COUNTRY_ID\=EM.COUNTRY_ID AND TRUNC(EFFECTIVE_DATE)<\=TRUNC(SYSDATE)) AND TRUNC(EM.EFFECTIVE_DATE)<\=TRUNC(SYSDATE)
GET_OPENCOVER_DEBITTO = Select Debit_Note From Open_Cover_Master Ocm Where Ocm.Proposal_No=(Select Proposal_No From Open_Cover_Position_Master Ocpm Where Ocpm.Open_Cover_No= ? and ocpm.status='P') and amend_id=(select max(amend_id) from Open_Cover_Master oc Where ocm.proposal_no=oc.proposal_no)


GET_SUM_INSURED_ENDT=SELECT   *  FROM   (SELECT  APPLICATION_NO,(round(NVL ( EQUIVALENT_USD, 0) + NVL (TOTAL_SALE_TERM_CHARGES, 0))) suminsured, LAG (round(NVL ( EQUIVALENT_USD, 0) + NVL (TOTAL_SALE_TERM_CHARGES, 0)), 1,0 ) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS suminsured_PREV FROM   MARINE_DATA_ENDT) WHERE   APPLICATION_NO = ?
GET_SUM_INSURED=select  ROUND ((  nvl(MD.EQUIVALENT_USD,0) + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)),0 ) from marine_data md where application_no\=?
UPDATE_OPEN_COVER_UTILIZED_AMOUNT=UPDATE OPEN_COVER_MASTER SET UTILIZED_AMOUNT=NVL(UTILIZED_AMOUNT,0)+NVL(?,0) WHERE PROPOSAL_NO=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?)
validate.sum.insured=select case when nvl(UTILIZED_AMOUNT,0)+nvl(?,0) > nvl(CROSS_VOYAGE_TURNOVER,0) then 'false' else 'true' end STATUS from open_cover_master ocm,open_cover_position_master ocpm where ocm.proposal_no=ocpm.proposal_no and ocpm.open_cover_no=?

#REFERRAL VALIDATION
referral.deposit=select  DEPOSITDETAIL(?,?,?,?,?)from dual
referral.coverage=SELECT REFERAL_STATUS FROM COVER_MASTER WHERE COVER_ID\=? AND BRANCH_CODE\=?
referral.vessel=SELECT STATUS FROM VESSEL_MASTER WHERE VESSEL_ID=?
referral.policyDate.diff=SELECT TO_DATE(TO_CHAR(SYSDATE))-TO_DATE(?,'DD/MM/YYYY') FROM DUAL
referral.policyDate.openCoverDiff=SELECT TO_DATE(A.INCEPTION_DATE,'DD-MM-YYYY')-TO_DATE(?,'DD/MM/YYYY') FROM OPEN_COVER_POSITION_MASTER A WHERE A.OPEN_COVER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE A.OPEN_COVER_NO=OPEN_COVER_NO)
#referral.country=SELECT STATUS FROM COUNTRY_MASTER_DETAIL A WHERE COUNTRY_ID IN(:id) AND BELONGING_COUNTRY_ID=:orgCountryId AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=A.COUNTRY_ID AND BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
referral.country=SELECT status  FROM country_master  WHERE  (country_id=? and amend_id = (SELECT   MAX (amend_id) FROM   country_master WHERE   country_id = ?)) or (country_id=? AND amend_id = (SELECT   MAX (amend_id) FROM   country_master  WHERE   country_id = ?))
referral.crossVoyageSI=SELECT NVL(SUM(MRD.SUMINSUREDLOCAL),0) FROM MARINE_DATA MD,POSITION_MASTER PM,MARINE_RESULT_DETAILS MRD,OPEN_COVER_POSITION_MASTER OCPM WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND MRD.APPLICATION_NO=MD.APPLICATION_NO AND MD.OPEN_COVER_NO=PM.OPEN_COVER_NO AND PM.STATUS='P' AND MD.STATUS='Y' AND MD.TRANSIT_FROM_COUNTRY_ID NOT IN(?) AND MD.FINAL_DESTINATION_COUNTRY_ID NOT IN(?) AND MD.OPEN_COVER_NO=? AND OCPM.OPEN_COVER_NO=PM.OPEN_COVER_NO
referral.crossVoyage=SELECT STATUS FROM COUNTRY_MASTER_DETAIL A WHERE COUNTRY_ID IN(:id) AND BELONGING_COUNTRY_ID=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=A.COUNTRY_ID AND BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
referral.land=SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID=8 AND BRANCH_CODE=? AND CATEGORY_DETAIL_ID=? AND STATUS='Y'
referral.policyDate.backDate=SELECT NVL(BACK_DATE_ALLOWED,0) FROM LOGIN_USER_DETAILS WHERE AGENCY_CODE IN(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND PRODUCT_ID=?
referral.master=SELECT A.REFERAL_ID,A.STATUS FROM REFERAL_MASTER A WHERE A.BRANCH_CODE=? AND A.EFFECTIVE_START_DATE<(SELECT SYSDATE FROM DUAL) AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM REFERAL_MASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND EFFECTIVE_START_DATE<(SELECT SYSDATE FROM DUAL)) ORDER BY REFERAL_ID
referral.suminsured=SELECT INSURANCE_END_LIMIT SUM_INSURED_LIMIT,MIN_PREMIUM_AMOUNT MIN_PREMIUM FROM LOGIN_USER_DETAILS  WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND PRODUCT_ID=?
referral.OCsuminsured=SELECT  (OCD.SUM_INSURED_LIMIT*OCD.EXCHANGE_RATE) SUM_INSURED_LIMIT,OCD.MODE_TRANSPORT_ID,OCD.EXCHANGE_ID,OCD.CURRENCY_ID,OCD.EXCHANGE_RATE,OCD.CURRENCY_NAME,OCD.AMEND_ID FROM OPEN_COVER_DETAIL OCD,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO =? AND OCPM.PROPOSAL_NO=OCD.PROPOSAL_NO AND OCD.AMEND_ID IN (SELECT MAX(OCDS.AMEND_ID) FROM OPEN_COVER_DETAIL OCDS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCDS.PROPOSAL_NO AND TO_DATE(OCDS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY')) AND OCD.MODE_TRANSPORT_ID=?
referral.LCsuminsured=SELECT NVL(SUM(MRD.SUMINSUREDLOCAL+MD.TOTAL_SALE_TERM_CHARGES+MD.TOTAL_TOLERANCE_CHARGES),0) SUM_INSURED_LIMIT FROM MARINE_DATA MD,MARINE_RESULT_DETAILS MRD,POSITION_MASTER PM WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND MD.APPLICATION_NO=MRD.APPLICATION_NO AND MD.OPEN_COVER_NO=PM.OPEN_COVER_NO AND PM.STATUS='P' AND MD.STATUS='Y' AND MD.OPEN_LC_ID=? AND MD.OPEN_BANK_ID=? AND MD.OPEN_COVER_NO=?
referral.basisVal=SELECT A.SALE_TERM_VALUE,B.TOLERANCE_VALUE FROM SALE_TERM_MASTER A, TOLERANCE_MASTER B WHERE A.SALE_TERM_ID=? AND A.BRANCH_CODE=? AND B.TOLERANCE_ID=? AND B.BRANCH_CODE=A.BRANCH_CODE
referral.countryStartPlace=SELECT STARTING_PLACE FROM COUNTRY_MASTER_DETAIL A WHERE A.COUNTRY_ID=? AND A.BELONGING_COUNTRY_ID=? AND A.AMEND_ID=(SELECT MAX(B.AMEND_ID) FROM COUNTRY_MASTER_DETAIL B WHERE B.COUNTRY_ID=A.COUNTRY_ID AND A.BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
referral.countryEndPlace=SELECT ENDING_PLACE FROM COUNTRY_MASTER_DETAIL A WHERE A.COUNTRY_ID=? AND A.BELONGING_COUNTRY_ID=? AND A.AMEND_ID=(SELECT MAX(B.AMEND_ID) FROM COUNTRY_MASTER_DETAIL B WHERE B.COUNTRY_ID=A.COUNTRY_ID AND A.BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
marine.lc.master=SELECT BM.BANK_NAME,OPLM.LC_NUMBER,(OPLM.LC_AMOUNT*EM.EXCHANGE_RATE) LC_AMOUNT,OPLM.LC_DATE,CM.CURRENCY_NAME,OPLM.LC_CURRENCY_ID,EM.EXCHANGE_RATE,BM.BANK_ID FROM OPEN_COVER_LC_MASTER OPLM,OPEN_COVER_BANK_MASTER BM,CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE OPLM.STATUS='Y' AND LC_ID=? AND OPLM.BANK_ID=? AND OPLM.BANK_ID=BM.BANK_ID AND CM.CURRENCY_ID=NVL(OPLM.LC_CURRENCY_ID,'0') AND OPEN_COVER_NO=? AND CM.AMEND_ID||'-'||CM.CURRENCY_ID IN (SELECT MAX(CMS.AMEND_ID)||'-'||CMS.CURRENCY_ID FROM CURRENCY_MASTER CMS WHERE TO_CHAR(CMS.EFFECTIVE_DATE,'dd-mm-YYYY') <= TO_CHAR(SYSDATE,'dd-mm-YYYY') GROUP BY CMS.CURRENCY_ID ) AND BM.AMEND_ID||'-'||BM.BANK_ID IN (SELECT MAX(OCBMS.AMEND_ID)||'-'||OCBMS.BANK_ID FROM OPEN_COVER_BANK_MASTER OCBMS WHERE TO_DATE(OCBMS.EFFECTIVE_DATE,'dd-mm-YYYY') <=TO_DATE(SYSDATE,'dd-mm-YYYY') GROUP BY OCBMS.BANK_ID) AND EM.AMEND_ID||'-'||EM.CURRENCY_ID IN (SELECT MAX(EMS.AMEND_ID)||'-'||EMS.CURRENCY_ID FROM EXCHANGE_MASTER EMS WHERE TO_CHAR(EMS.EFFECTIVE_DATE,'dd-mm-YYYY') <= TO_CHAR(SYSDATE,'dd-mm-YYYY') GROUP BY EMS.CURRENCY_ID ) AND EM.CURRENCY_ID=OPLM.LC_CURRENCY_ID ORDER BY OPLM.LC_ID
marine.oc.master=SELECT OCM.BROKER_ID,OCM.BROKER_USER_ID,OCM.POLICY_START_DATE,OCM.POLICY_END_DATE,OCM.PRODUCT_ID,OCM.CUSTOMER_ID,OCM.BRANCH_CODE,OCM.CROSS_VOYAGE_TURNOVER,OCM.CROSS_VOYAGE_SUMINSURED_LIMIT,OCM.BACK_DATE_DAYS,OCM.COMMISSION,OCM.NO_OF_INSURANCE_COMPANY,OCM.CROSS_VOYAGE_PERCENTAGE,OCM.RSA_SHARED_PERCENTAGE,OCM.CROSS_VOYAGE,OCM.EXPORT_MIN_PREMIUM_AMOUNT,OCM.FREE_TEXT_ALLOWED,OCM.AMEND_ID,OCM.BUSINESS_TYPE,OCM.MISSIPPI_OPENCOVER_NO FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO =? AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCMS.PROPOSAL_NO AND TO_DATE(OCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY'))
marine.commodity=SELECT MRD.APPLICATION_NO,MRD.COMMODITY_ID,MRD.SUM_INSURED,MRD.DESCRIPTION,MRD.FRAGILE,MRD.COMMODITY_TYPE_ID,MRD.COMMODITY_EXCESS_PREMIUM FROM MARINE_RESULT_DETAILS MRD WHERE MRD.APPLICATION_NO=? AND  STATUS='Y' AND MRD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO=MRD.APPLICATION_NO AND STATUS=MRD.STATUS) ORDER by sno
marine.commodity.OCrate=SELECT NVL(OCCD.COMMODITY_BASE_RATE,0) FROM OPEN_COVER_COMMODITY_DETAIL OCCD,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO=? AND OCCD.PROPOSAL_NO=OCPM.PROPOSAL_NO AND OCCD.AMEND_ID IN (SELECT MAX(OCCDS.AMEND_ID) FROM OPEN_COVER_COMMODITY_DETAIL OCCDS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO=OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCCDS.PROPOSAL_NO AND TO_DATE(OCCDS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY')) AND OCCD.COMMODITY_ID=? AND OCCD.COVER_ID=? AND OCCD.COVER_TYPE_ID=?
marine.loadValue.WTH=SELECT NVL(LOAD_VALUE,'0') FROM REFERAL_MASTER WHERE REFERAL_ID='17' AND BRANCH_CODE=?
marine.loadValue.LCL=SELECT NVL(LOAD_VALUE,'0') FROM REFERAL_MASTER WHERE REFERAL_ID='16' AND BRANCH_CODE=?
round=SELECT ROUND(?,NVL(RFACTOR,'0')) FROM CURRENCY_MASTER A WHERE CURRENCY_ID\=? AND COUNTRY_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=A.CURRENCY_ID AND COUNTRY_ID\=A.COUNTRY_ID)
marine.appNo.max=SELECT APPLICATION_NO.NEXTVAL FROM DUAL
marine.update.premium.rate=UPDATE MARINE_RESULT_DETAILS SET RATE\=?,PREMIUM\=?,CURRENCY_ID\=?,EXCHANGE_ID\=?,CURRENCY_NAME\=?,EXCHANGE_RATE\=?,SALE_TERM_CHARGES\=?,WAR_CHARGES\=?,REFERRAL\=?,WARRATE\=?,SUMINSUREDLOCAL\=?,RAG\=(SELECT RAG FROM COMMODITYMASTER WHERE COMMODITY_ID\=? AND BRANCH_CODE\='01' AND AMEND_ID||'-'||COMMODITY_ID  IN(SELECT MAX(AMEND_ID)||'-'||COMMODITY_ID FROM COMMODITYMASTER WHERE  TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <\=TO_DATE(SYSDATE,'dd-MM-YYYY') AND  STATUS IN ('Y','R') AND BRANCH_CODE\='01' GROUP BY COMMODITY_ID)),SEA_OPTION_LCL\=?,WAREHOUSE_WAREHOUSE\=?,TOLERANCE_CHARGES\=?,AGREED_STATUS\=?,COMMODITY_EXCESS_PREMIUM\=? WHERE  APPLICATION_NO\=? AND COMMODITY_ID\=? AND STATUS\=?
marine.data.count=SELECT COUNT(*) FROM MARINE_DATA WHERE APPLICATION_NO=? AND AMEND_ID=?
marine.currency.info=SELECT EM.EXCHANGE_ID, EM.EXCHANGE_RATE, EM.CURRENCY_ID, CM.CURRENCY_NAME FROM EXCHANGE_MASTER EM, CURRENCY_MASTER CM WHERE EM.CURRENCY_ID = ? AND EM.CURRENCY_ID = CM.CURRENCY_ID AND EM.STATUS = 'Y' AND CM.STATUS = 'Y' AND EM.COUNTRY_ID = ? AND EM.COUNTRY_ID=CM.COUNTRY_ID AND EM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM EXCHANGE_MASTER WHERE CURRENCY_ID = EM.CURRENCY_ID AND STATUS = 'Y' AND COUNTRY_ID = EM.COUNTRY_ID AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE)) AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND STATUS = 'Y' AND COUNTRY_ID = CM.COUNTRY_ID AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE))
marine.executive.name=SELECT AC_EXECUTIVE_NAME FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID\=? AND STATUS\='Y'
#marine.data.insert=INSERT INTO MARINE_DATA (APPLICATION_NO,MODE_OF_TRANSPORT,WAREHOUSE_TO_WAREHOUSE,TRANSIT_FROM,FINAL_DESTINATION, NO_OF_ITEMS,TOTAL_SUM_INSURED,CURRENCY_ID,EXCHANGE_ID,CURRENCY_NAME,EXCHANGE_RATE,SALE_TERM_ID,COVER_ID,EXTRA_COVER_ID,AC_EXECUTIVE_ID,AC_EXECUTIVE_NAME,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS,EQUIVALENT_USD,COMPANY_ID,PREMIUM,TRANSIT_FROM_CITY_ID,TRANSIT_FROM_COUNTRY_ID,FINAL_DESTINATION_CITY_ID,FINAL_DESTINATION_COUNTRY_ID,REFERRAL,TOTAL_SALE_TERM_CHARGES,TOTAL_WAR_CHARGES,SEA_OPTIONS,WARE_TO_WARE_FINAL_DEST,PRODUCT_ID,OPEN_COVER_NO,OPEN_BANK_ID,OPEN_LC_ID,OPEN_VESSEL_NAME,OPEN_VESSEL_OPTION,TOLERANCE_ID,TOTAL_TOLERANCE_CHARGES,PARTIAL_SHIPPING,PARTIAL_SUM_INSURED_AMOUNT,EXPOSURE_CURRENCY,OC_VESSEL_ID,POLICY_FEE, GOVT_TAX, EMERGENCY_FUND,EXCESS_PREMIUM,ADMIN_REFERRAL_STATUS) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'dd-mm-yyyy hh24:mi:ss'),SYSDATE,SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
marine.data.insert=INSERT INTO MARINE_DATA (APPLICATION_NO,MODE_OF_TRANSPORT,WAREHOUSE_TO_WAREHOUSE,TRANSIT_FROM,FINAL_DESTINATION, NO_OF_ITEMS,TOTAL_SUM_INSURED,CURRENCY_ID,EXCHANGE_ID,CURRENCY_NAME,EXCHANGE_RATE,SALE_TERM_ID,COVER_ID,EXTRA_COVER_ID,AC_EXECUTIVE_ID,AC_EXECUTIVE_NAME,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS,EQUIVALENT_USD,COMPANY_ID,PREMIUM,TRANSIT_FROM_CITY_ID,TRANSIT_FROM_COUNTRY_ID,FINAL_DESTINATION_CITY_ID,FINAL_DESTINATION_COUNTRY_ID,REFERRAL,TOTAL_SALE_TERM_CHARGES,TOTAL_WAR_CHARGES,SEA_OPTIONS,WARE_TO_WARE_FINAL_DEST,PRODUCT_ID,OPEN_COVER_NO,OPEN_BANK_ID,OPEN_LC_ID,OPEN_VESSEL_NAME,OPEN_VESSEL_OPTION,TOLERANCE_ID,TOTAL_TOLERANCE_CHARGES,PARTIAL_SHIPPING,PARTIAL_SUM_INSURED_AMOUNT,EXPOSURE_CURRENCY,OC_VESSEL_ID,POLICY_FEE, GOVT_TAX, EMERGENCY_FUND,EXCESS_PREMIUM,ADMIN_REFERRAL_STATUS,CHANNEL_TYPE,VAT_APPLICABLE,SHIPMENT_TRANSIT) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'dd-mm-yyyy hh24:mi:ss'),SYSDATE,SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
marine.data.update=UPDATE MARINE_DATA SET MODE_OF_TRANSPORT=?,WAREHOUSE_TO_WAREHOUSE=?,TRANSIT_FROM=?,FINAL_DESTINATION=?,NO_OF_ITEMS=?,TOTAL_SUM_INSURED=?,CURRENCY_ID=?,EXCHANGE_ID=?,CURRENCY_NAME=?,EXCHANGE_RATE=?,SALE_TERM_ID=?,COVER_ID=?,EXTRA_COVER_ID=?,AC_EXECUTIVE_ID=?,AC_EXECUTIVE_NAME=?,INCEPTION_DATE=TO_DATE(?,'dd-mm-yyyy hh24:mi:ss'),EXPIRY_DATE=SYSDATE,EFFECTIVE_DATE=SYSDATE,ENTRY_DATE=SYSDATE,EQUIVALENT_USD=?,COMPANY_ID=?,PREMIUM=?,TRANSIT_FROM_CITY_ID=?,TRANSIT_FROM_COUNTRY_ID=?,FINAL_DESTINATION_CITY_ID=?,FINAL_DESTINATION_COUNTRY_ID=?,REFERRAL=?,TOTAL_SALE_TERM_CHARGES=?,TOTAL_WAR_CHARGES=?,SEA_OPTIONS=?,WARE_TO_WARE_FINAL_DEST=?,PRODUCT_ID=?,OPEN_COVER_NO=?,OPEN_BANK_ID=?,OPEN_LC_ID=?,OPEN_VESSEL_NAME=?,OPEN_VESSEL_OPTION=?,TOLERANCE_ID=?,TOTAL_TOLERANCE_CHARGES=?,PARTIAL_SHIPPING=?,PARTIAL_SUM_INSURED_AMOUNT=?,EXPOSURE_CURRENCY=?,OC_VESSEL_ID=?,DEC_EXCESS_PREMIUM='',REMARKS=?,POLICY_FEE=?, GOVT_TAX=?, EMERGENCY_FUND=?,EXCESS_PREMIUM=?,ADMIN_REFERRAL_STATUS=?,CHANNEL_TYPE=? ,VAT_APPLICABLE=?,SHIPMENT_TRANSIT=? WHERE APPLICATION_NO=? AND STATUS=? AND AMEND_ID=?
marine.update.linked.Status=UPDATE POSITION_MASTER A SET a.OPEN_COVER_INT_STATUS\='' WHERE A.APPLICATION_NO\=?
marine.tracking.count=SELECT COUNT(*) FROM TRACKING_MASTER WHERE APPLICATION_NO=? AND LOGIN_ID=? AND SESSION_ID=? AND STATUS='Y'
marine.tracking.insert=INSERT INTO TRACKING_MASTER (SERIAL_NO,SESSION_ID,LOGIN_ID,STAGE_ID,APPLICATION_NO,PRODUCT_ID,REMARKS,STATUS,START_TIME) VALUES((SELECT NVL(MAX(SERIAL_NO),'0')+1 FROM TRACKING_MASTER),?,?,?,?,?,?,?,SYSDATE)
marine.tracking.update=UPDATE TRACKING_MASTER SET STAGE_ID\=?,END_TIME\=SYSDATE WHERE APPLICATION_NO\=? AND STATUS\=? AND SESSION_ID\=? AND LOGIN_ID\=?
marine.customer.count=SELECT COUNT(*) FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
marine.customer.insert=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID,MISSIPPI_CUSTOMER_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME,VAT_REG_NO,CUST_VAT_YN) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?)
marine.customer.update=UPDATE PERSONAL_INFO SET APPLICATION_ID=?,TITLE=?,FIRST_NAME=?,LAST_NAME=?,MOBILE=?,EMAIL=?,ADDRESS1=?,ADDRESS2=?,POBOX=?,EMIRATE=?,STATUS=?,MISSIPPI_CUSTOMER_CODE=?,CLIENT_CUSTOMER_ID=?,CUST_AR_NO=?,CUST_NAME=? ,VAT_REG_NO=?,CUST_VAT_YN=? WHERE CUSTOMER_ID=?
marine.policy.fee=SELECT PERCENT POLICY_FEE_DEFAULT,'0' POLICY_FEE_PERCENT FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 AND BRANCH_CODE=? AND CATEGORY_ID=131 AND STATUS='Y'
marine.policy.fee.oc=SELECT A.MIN_PREMIUM_ISSUANCE_FEE POLICY_FEE_DEFAULT,A.ISSUANCE_FEE POLICY_FEE_PERCENT,A.COMMISSION COMMISSION FROM OPEN_COVER_MASTER A  WHERE A.MISSIPPI_OPENCOVER_NO=? AND A.BRANCH_CODE=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO=A.MISSIPPI_OPENCOVER_NO)
marine.fee.broker=SELECT (CASE WHEN (POLICY_FEE_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN NVL(POLICY_FEE,'0') ELSE 0 END) POLICY_FEE,(CASE WHEN (GOVT_TAX_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN NVL(GOVT_TAX,'0') ELSE 0 END)GOVT_TAX,(CASE WHEN (EMERGENCY_FUND_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH'  OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN NVL(EMERGENCY_FUND,'0') ELSE 0 END)EMERGENCY_FUND,POLICY_FEE_STATUS FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE) AND AMEND_ID||AGENCY_CODE IN(SELECT MAX(AMEND_ID)||AGENCY_CODE FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE) GROUP BY AGENCY_CODE)
#marine.fee.issuer=SELECT (CASE WHEN (POLICY_FEE_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'ADNICUSER')) THEN NVL(POLICY_FEE,'0') ELSE 0 END) POLICY_FEE,(CASE WHEN (GOVT_TAX_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'ADNICUSER')) THEN NVL(GOVT_TAX,'0') ELSE 0 END)GOVT_TAX,(CASE WHEN (EMERGENCY_FUND_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH'  OR UPPER(TAX_APPLICABLE) = 'ADNICUSER')) THEN NVL(EMERGENCY_FUND,'0') ELSE 0 END)EMERGENCY_FUND,POLICY_FEE_STATUS FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE,'dd-MM-YYYY') AND AMEND_ID||AGENCY_CODE IN(SELECT MAX(AMEND_ID)||AGENCY_CODE FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE,'dd-MM-YYYY') GROUP BY AGENCY_CODE)
marine.fee.issuer=SELECT (CASE WHEN (POLICY_FEE_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'USER')) THEN NVL(POLICY_FEE,'0') ELSE 0 END) POLICY_FEE,(CASE WHEN (GOVT_TAX_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'USER')) THEN NVL(GOVT_TAX,'0') ELSE 0 END)GOVT_TAX,(CASE WHEN (EMERGENCY_FUND_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH'  OR UPPER(TAX_APPLICABLE) = 'USER')) THEN NVL(EMERGENCY_FUND,'0') ELSE 0 END)EMERGENCY_FUND,POLICY_FEE_STATUS FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE,'dd-MM-YYYY') AND AMEND_ID||AGENCY_CODE IN(SELECT MAX(AMEND_ID)||AGENCY_CODE FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE,'dd-MM-YYYY') GROUP BY AGENCY_CODE)
marine.quote.count=SELECT COUNT(1) FROM POSITION_MASTER WHERE QUOTE_NO=? AND AMEND_ID=?
marine.quoteNo.max=SELECT ONEOFF_QUOTE.NEXTVAL FROM DUAL
marine.quoteNo.max.oc=SELECT OPENCOVER_QUOTE.NEXTVAL FROM DUAL
marine.quote.insert=INSERT INTO POSITION_MASTER (PRODUCT_ID,LOGIN_ID,COMPANY_ID,APPLICATION_NO,AMEND_ID,QUOTE_NO,CUSTOMER_ID,APPLICATION_ID,STATUS,ENTRY_DATE,EFFECTIVE_DATE,EXCESS_PREMIUM,BUSINESS_TYPE,OPEN_COVER_NO,MISSIPPI_OPENCOVER_NO,REMARKS,PREMIUM) VALUES(?,?,?,?,?,?,?,?,?,SYSDATE,(SELECT ADD_MONTHS(SYSDATE,1)-1 FROM DUAL),?,?,?,?,?,?)
marine.quote.update=UPDATE POSITION_MASTER SET CUSTOMER_ID\=?,EXCESS_PREMIUM\=?,REMARKS\=?,PREMIUM\=?,APPLICATION_ID\=? WHERE APPLICATION_NO\=? AND QUOTE_NO\=? AND AMEND_ID\=?
GET_WAR_OPTION = SELECT EXTRA_COVER_ID FROM MARINE_DATA MD WHERE APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO=MD.APPLICATION_NO)

#COMMODITY INSERT/UPDATE
CAL_PROC_COMM=CALL MARINE_COMMODITY_INSERT(?,?,?)

#MASTER INFO
GET_LC_MASTER_INFO=SELECT BM.BANK_NAME,OPLM.LC_NUMBER,(OPLM.LC_AMOUNT*EM.EXCHANGE_RATE) LC_AMOUNT,OPLM.LC_DATE,CM.CURRENCY_NAME,OPLM.LC_CURRENCY_ID,EM.EXCHANGE_RATE,BM.BANK_ID FROM OPEN_COVER_LC_MASTER OPLM,OPEN_COVER_BANK_MASTER BM,CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE OPLM.STATUS='Y' AND LC_ID=? AND OPLM.BANK_ID=? AND OPLM.BANK_ID=BM.BANK_ID AND CM.CURRENCY_ID=NVL(OPLM.LC_CURRENCY_ID,'0') AND OPEN_COVER_NO=? AND CM.AMEND_ID=(  SELECT   MAX (CMS.AMEND_ID) FROM   CURRENCY_MASTER CMS WHERE   To_Date (CMS.EFFECTIVE_DATE, 'dd-mm-YYYY') <= To_Date (SYSDATE, 'dd-mm-YYYY') and CMS.CURRENCY_ID=CM.CURRENCY_ID) AND BM.AMEND_ID||'-'||BM.BANK_ID IN (SELECT MAX(OCBMS.AMEND_ID)||'-'||OCBMS.BANK_ID FROM OPEN_COVER_BANK_MASTER OCBMS WHERE TO_DATE(OCBMS.EFFECTIVE_DATE,'dd-mm-YYYY') <=TO_DATE(SYSDATE,'dd-mm-YYYY') GROUP BY OCBMS.BANK_ID) AND EM.AMEND_ID||'-'||EM.CURRENCY_ID IN (SELECT MAX(EMS.AMEND_ID)||'-'||EMS.CURRENCY_ID FROM EXCHANGE_MASTER EMS WHERE TO_DATE(EMS.EFFECTIVE_DATE,'dd-mm-YYYY') <= TO_DATE(SYSDATE,'dd-mm-YYYY') GROUP BY EMS.CURRENCY_ID ) AND EM.CURRENCY_ID=OPLM.LC_CURRENCY_ID ORDER BY OPLM.LC_ID
GET_PREM_LOAD_DISC=SELECT LUD.PRODUCT_ID,NVL(LUD.COMMISSION,0)COMMISSION,NVL(LUD.LOADING_OF_PREMIUM,0)LOADING_OF_PREMIUM,NVL(LUD.DISCOUNT_OF_PREMIUM,0)DISCOUNT_OF_PREMIUM,NVL(LUD.MIN_PREMIUM_AMOUNT,0)MIN_PREMIUM_AMOUNT FROM LOGIN_MASTER LM,LOGIN_USER_DETAILS LUD WHERE LM.AGENCY_CODE=LUD.AGENCY_CODE AND LUD.LOGIN_ID=LM.LOGIN_ID AND LUD.AGENCY_CODE =(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND LUD.PRODUCT_ID='3'
GET_CONDITIONS=SELECT CODE,CODEDESC,CODESTATUS FROM TABLE(SELECT VIEWCLAUSES(?,?,?) FROM DUAL)
GET_CONSTANT=SELECT CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID=? AND STATUS='Y'

#CUSTOMER
GET_CUST_ID_MAX=SELECT CUSTOMER_NUMBER_SEQ.NEXTVAL FROM DUAL
GET_CUST_SEQ = select CUST_SEQ_CREATION(?,?) FROM DUAL

#MARINE_POLICY_DETAILS
CNT_MARINE_POLICY=SELECT COUNT(*) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO=? AND AMEND_ID=?
INS_MARINE_POLICY=INSERT INTO MARINE_POLICY_DETAILS(QUOTE_NO,CUSTOMER_ID,BL_AWB_NO,BL_AWB_DATE,SETTLING_AGENT_ID,CARRIER_NAME,LC_NUMBER,LC_DATE,BANK_NAME,PARTIAL_SHIPMENT_ALLOWED,SPECIAL_DISCOUNT,COMPANY_ID,AMEND_ID,ENTRY_DATE,INCEPTION_DATE,SETTLING_AGENT_NAME,STATUS,SAILING_DATE,PACKAGE_CODE,GHQ_CONTRACT_NO,GHQ_FMS_CASE_NO,GHQ_REFERENCE_NO)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,'Y',to_date(?,'DD/MM/YYYY'),?,?,?,?)
UPD_MARINE_POLICY=UPDATE MARINE_POLICY_DETAILS SET CUSTOMER_ID=?,BL_AWB_NO=?,BL_AWB_DATE=?,SETTLING_AGENT_ID=?,CARRIER_NAME=?,LC_NUMBER=?,LC_DATE=?,BANK_NAME=?,PARTIAL_SHIPMENT_ALLOWED=?,SPECIAL_DISCOUNT=?,COMPANY_ID=?,SETTLING_AGENT_NAME=?,SAILING_DATE=?,PACKAGE_CODE=?,GHQ_CONTRACT_NO=?,GHQ_FMS_CASE_NO=?,GHQ_REFERENCE_NO=? WHERE QUOTE_NO=? AND AMEND_ID=?
CNT_MARINE_RESULT=SELECT COUNT(*) FROM MARINE_RESULT WHERE QUOTE_NO=? AND APPLICATION_NO=? AND AMEND_ID=?
INS_MARINE_RESULT=INSERT INTO MARINE_RESULT(APPLICATION_NO,QUOTE_NO,COMPANY_ID,AMEND_ID,CUSTOMER_ID,TOTAL_SUM_INSURED,PREMIUM,INSURANCE_FEE,NET_PREMIUM,SPECIAL_DISCOUNT,AMOUNT_PAYABLE,ENTRY_DATE) VALUES(?,?,?,?,?,?,?,?,?,?,?,SYSDATE)
UPD_MARINE_RESULT=UPDATE MARINE_RESULT SET TOTAL_SUM_INSURED=?,PREMIUM=?,INSURANCE_FEE=?,NET_PREMIUM=?,SPECIAL_DISCOUNT=?,AMOUNT_PAYABLE=?,CUSTOMER_ID=? WHERE QUOTE_NO=? AND APPLICATION_NO=? AND AMEND_ID=?

#RATE CALCULATION
rate.coveragevalue=SELECT COVERAGE_REFERAL FROM COMMODITYMASTER  WHERE COMMODITY_ID = ? AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE =? AND COMMODITY_ID=?)
##rate.coverreferral=SELECT COUNT(COMMODITY_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID = ? AND ? IN (?) AND BRANCH_CODE = ?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.coverreferral=SELECT COUNT(COMMODITY_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID = ? AND {0} IN ({1}) AND BRANCH_CODE = ?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.commodityreferral=SELECT STATUS FROM COMMODITYMASTER WHERE  COMMODITY_ID = ? AND BRANCH_CODE = ? AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.coveragereferral=SELECT COUNT(*) FROM COMMODITYMASTER WHERE  COMMODITY_ID = ? AND COVERAGE_REFERAL IN(?) AND BRANCH_CODE = ? AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.basevalue=SELECT COVER_RATE FROM COVER_MASTER WHERE COVER_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT max(amend_id) from COVER_MASTER where cover_id=? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.fact1value=SELECT SUMINSURED_RATE FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED<=? AND  END_SUM_INSURED>=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED<=? AND  END_SUM_INSURED>=? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy') ) AND STATUS='Y'
rate.fact2value=SELECT MATERIAL_RATE FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID =? AND BRANCH_CODE=? and COVER_ID=? AND AMEND_ID=( SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID=? AND BRANCH_CODE=? and COVER_ID=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
##Emirates change
#rate.fact2value=SELECT MATERIAL_RATE FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID=?  AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.fact3value=SELECT GEO_RATE  FROM  COUNTRY_MASTER WHERE COUNTRY_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy') ) AND STATUS='Y'
rate.fact4value=SELECT CONV_RATE FROM CONVEYAN_MASTER WHERE SNO =? AND MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE SNO =? AND MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.fact5value=SELECT COMMODITY_RATE FROM COMMODITYMASTER WHERE COMMODITY_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE  COMMODITY_ID =? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.wsrccvalue=SELECT WAR_RATE FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID=? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.insertfactor=INSERT INTO COMMODITY_RATE_FACTOR(AMEND_ID, COMMODITY, COVER_RATE, SUM_INSURED_RATE, MATERIAL_RATE, GEO_RATE, CONV_RATE, COMMODITY_RATE, WAR_RATE,RATE,APPLICATION_NO) vALUES((SELECT NVL((MAX(AMEND_ID)+1),'0') FROM COMMODITY_RATE_FACTOR WHERE COMMODITY=?),?,?,?,?,?,?,?,?,?,?)
rate.coverdesc=SELECT DISTINCT DESCRIPTION FROM COVER_MASTER WHERE COVER_ID=?
rate.selectcoverdesc=SELECT SUBSTR(?,INSTR(?,'~',1,4)+1,LENGTH(?)) FROM COMMODITYMASTER A WHERE A.BRANCH_CODE=? AND A.COMMODITY_ID=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND COMMODITY_ID=A.COMMODITY_ID)
rate.excessamt=SELECT NVL (A.EXCESS_AMOUNT, '0') EXCESS_AMOUNT,EXCESS_PERCENT  FROM OPEN_COVER_DEDUCTIBLE_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE ? BETWEEN A.START_RANGE AND A.END_RANGE AND A.OPEN_COVER_PROPOSAL_NO = B.PROPOSAL_NO AND B.OPEN_COVER_NO = ? AND A.STATUS = 'Y' AND TO_DATE(A.effective_date,'dd-MM-YY') <= TO_DATE(SYSDATE,'dd-MM-YY') AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE TO_DATE(effective_date,'dd-MM-YY') <= TO_DATE(SYSDATE,'dd-MM-YY') AND OPEN_COVER_PROPOSAL_NO = A.OPEN_COVER_PROPOSAL_NO)
rate.selectdeductibles=SELECT NVL(DEDUCTIBLE,'0') FROM COMMODITY_EXCESS_PREMIUM WHERE ? BETWEEN START_SUM_INSURED AND END_SUM_INSURED AND STATUS='Y'
GET_OPENCOVER_EXCESS_DETAILS = select PROPOSAL_NO,COMMODITY_ID,COVER_ID,DISCOUNT_PERCENT,DISCOUNT_VALUE from OPEN_COVER_COMMODITY_DETAIL OCC where PROPOSAL_NO=(select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER where OPEN_COVER_NO=?) and cover_id=? and commodity_id=? and COVER_TYPE_ID=? and amend_id=(select max(amend_id) from OPEN_COVER_COMMODITY_DETAIL oc where oc.proposal_no=occ.proposal_no)

#WAR RATE
GET_CONVEY_WARRATE=SELECT A.WAR_RATE FROM WAR_RATE_MASTER A WHERE A.MODE_TRANSPORT_ID =? AND A.BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID=A.MODE_TRANSPORT_ID  AND BRANCH_CODE=A.BRANCH_CODE) AND STATUS='Y'
GET_CONVEY_WARRATE_OC=SELECT SUBSTR(OCCMSS.WAR_RATE||'#',INSTR(OCCMSS.WAR_RATE||'#','~',INSTR(OCCMSS.WAR_RATE,?))+1,INSTR(OCCMSS.WAR_RATE||'#','#',INSTR(OCCMSS.WAR_RATE,?))-INSTR(OCCMSS.WAR_RATE||'#','~',INSTR(OCCMSS.WAR_RATE||'#',?))-1) FROM OPEN_COVER_COUNTRY_MASTER OCCMSS,OPEN_COVER_POSITION_MASTER OCPMSS WHERE OCPMSS.OPEN_COVER_NO=? AND OCPMSS.PROPOSAL_NO=OCCMSS.PROPOSAL_NO AND OCCMSS.AMEND_ID IN (SELECT MAX(OCCMS.AMEND_ID) FROM OPEN_COVER_COUNTRY_MASTER OCCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO=OCPMSS.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCCMS.PROPOSAL_NO AND TO_DATE(OCCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY'))

#POLICY GENERATION
GET_CERT_NO=CALL GET_CERTIFNO(?,?,?)
GET_POLICY_GENERATE = SELECT Policy_Generate (?,?,?) FROM DUAL
GET_POL_NO=SELECT ?||'-' FROM BRANCH_MASTER A, CONSTANT_DETAIL B, CONSTANT_DETAIL C  WHERE A.BRANCH_CODE=? AND B.BRANCH_CODE=A.BRANCH_CODE AND C.BRANCH_CODE=A.BRANCH_CODE AND B.CATEGORY_ID=124 AND B.CATEGORY_DETAIL_ID=1 AND C.CATEGORY_ID=125 AND C.CATEGORY_DETAIL_ID=1
GET_PROD_PREFIX=SELECT RSACODE FROM PRODUCT_MASTER WHERE PRODUCT_ID=? AND BRANCH_CODE=?
GET_OC_NOTE_CNT=SELECT COUNT(1) FROM OPEN_COVER_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE A.PROPOSAL_NO=B.PROPOSAL_NO AND B.OPEN_COVER_NO=? AND A.DEPOSIT_PREMIUM_YN='Y'
GET_OC_CKEY=SELECT CKEY FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?
GET_EXECUTIVE_ID=SELECT AC_EXECUTIVE_ID FROM MARINE_DATA MD WHERE APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO=MD.APPLICATION_NO)
GET_COREEXECUTIVE_ID = SELECT RSACODE FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID=?
#GET_COMMISSION_PERCENT=SELECT NVL(COMMISSION,0) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?
GET_COMMISSION_PERCENT=SELECT NVL (COMMISSION, 0) FROM LOGIN_USER_DETAILS lud WHERE LUD.AGENCY_CODE = (SELECT   DECODE (USERTYPE, 'RSAIssuer', agency_code, oa_code) FROM LOGIN_MASTER WHERE LOGIN_ID = ?) AND PRODUCT_ID=? AND amend_id = (SELECT MAX (amend_id) FROM LOGIN_USER_DETAILS LUD1 WHERE LUD1.AGENCY_CODE = (SELECT   DECODE (USERTYPE, 'RSAIssuer', agency_code, oa_code) FROM LOGIN_MASTER WHERE LOGIN_ID = ?) AND LUD.PRODUCT_ID=LUD1.PRODUCT_ID)
GET_OC_COMMISSION_PERCENT=SELECT NVL(OCM.COMMISSION,0) FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO\=? AND OCPM.PROPOSAL_NO\=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \=OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO\=OCMS.PROPOSAL_NO AND TO_DATE(OCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <\= TO_DATE(SYSDATE,'dd-MM-YYYY'))
GET_COMMISSION_PERCENT_ISSUER_ONEOFF=SELECT ISSUER_COMMISSION_ONEOFF FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(select oa_code from login_master where login_id=?)
GET_COMMISSION_PERCENT_ISSUER_OPENCOVER=SELECT ISSUER_COMMISSION_OPENCOVER FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(select oa_code from login_master where login_id=?)
UPD_POLICY_INFO=UPDATE POSITION_MASTER SET POLICY_TERM='1 year',POLICY_NO=?,PDF_PRE_SHOW_STATUS=?,PDF_BANKER_STATUS=?,PDF_GENERATE_STATUS=?,PDF_BANKER_ASSURED_STATUS=?,PDF_CURRENCY_STATUS=?,OPEN_COVER_NO=?,NOTE_TYPE=?,PAYMENT_MODE=?,BASIS_VAL=?,DEBIT_CUST_ID=?,CERT_CLAUSES_YN=?,COMMISSION=?,TAX=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=?,PDF_STAMP_STATUS=?,DISCOUNT_PREMIUM=? WHERE  QUOTE_NO=? AND AMEND_ID=? and STATUS <> 'P'
UPD_INCEPTION_DATE=UPDATE POSITION_MASTER SET INCEPTION_DATE=TO_DATE(?, 'DD-MM-YYYY HH24:MI:SS'),EXPIRY_DATE=TO_DATE(?, 'DD-MM-YYYY HH24:MI:SS') WHERE QUOTE_NO=?
UPD_WEBSERVICE_MARINE_QUOTE_POLICY_INFO=update webservice_marine_quote set POLICY_NO=?, status=? where QUOTE_NO=?
GET_EXECUTIVE_PERCENT = SELECT COMMISSION FROM LOGIN_EXECUTIVE_DETAILS LED WHERE AC_EXECUTIVE_ID=? AND TRUNC(EFFECTIVE_DATE) <= TRUNC(SYSDATE) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_EXECUTIVE_DETAILS LED1 WHERE LED1.AC_EXECUTIVE_ID=LED.AC_EXECUTIVE_ID AND TRUNC(LED1.EFFECTIVE_DATE)=TRUNC(LED.EFFECTIVE_DATE))
GET_OPENCOVER_EXECUTIVE_PERCENT = SELECT COMMISSION FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))
GET_ENDT_COMMISSION_PERCENT = Select nvl(discount_premium,0) from position_master pm Where policy_no\=(Select original_policy_no from position_master Where application_no\=?) 

UPD_POLICY_STS=UPDATE POSITION_MASTER SET DEBIT_NOTE_DATE = TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'), MISSIPPI_TRANFER_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS') ,INCEPTION_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'), CREDIT_NOTE_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'), EXPIRY_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'),DEBIT_NOTE_NO=?, CREDIT_NOTE_NO=?, DEBIT_TO=?, CREDIT_TO=?, DEBIT_TO_ID=?, CREDIT_TO_ID=?, STATUS='P' WHERE QUOTE_NO=? AND AMEND_ID=?
GET_QUOTE_STATUS=SELECT STATUS,POLICY_NO,REMARKS,PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=A.QUOTE_NO)
CNT_POLICY_NO=SELECT COUNT(*) FROM POSITION_MASTER WHERE POLICY_NO\=? AND QUOTE_NO \!\=?
GET_LC_INFO=SELECT MD.OPEN_LC_ID,MD.OPEN_BANK_ID,POS.OPEN_COVER_NO FROM MARINE_DATA MD, POSITION_MASTER POS WHERE MD.APPLICATION_NO\=POS.APPLICATION_NO AND POS.QUOTE_NO\=?
GET_TOTAL_USED_SI=SELECT SUM(MRD.SUMINSUREDLOCAL+MD.TOTAL_SALE_TERM_CHARGES+MD.TOTAL_TOLERANCE_CHARGES) FROM MARINE_DATA MD,MARINE_RESULT_DETAILS MRD,POSITION_MASTER PM WHERE MD.APPLICATION_NO\=PM.APPLICATION_NO AND MD.APPLICATION_NO\=MRD.APPLICATION_NO AND MD.OPEN_COVER_NO\=PM.OPEN_COVER_NO AND PM.STATUS\='P' AND MD.STATUS\='Y' AND MD.OPEN_LC_ID\=? AND MD.OPEN_BANK_ID\=? AND MD.OPEN_COVER_NO\=? AND PM.QUOTE_NO\=?
GET_LC_BAL_AMT=SELECT LC_BALANCE_AMOUNT FROM OPEN_COVER_LC_MASTER WHERE LC_ID\=? AND BANK_ID\=? AND OPEN_COVER_NO\=?
UPD_LC_INFO=UPDATE OPEN_COVER_LC_MASTER SET LC_BALANCE_AMOUNT=? WHERE LC_ID=? AND BANK_ID=? AND OPEN_COVER_NO=?
GET_SYSDATE=SELECT CASE WHEN TRUNC(SYSDATE) BETWEEN TRUNC(TRN.CLO_DATE_OPENED) AND TRUNC(TRN.CLO_DATE_CLOSED) THEN TO_CHAR(SYSTIMESTAMP,'DD-MM-YYYY hh24\:mi\:ss') ELSE TO_CHAR(TRN.CLO_DATE_OPENED, 'DD-MM-YYYY hh24\:mi\:ss') END X FROM T_TRN_CLOSING TRN, PRODUCT_MASTER PM, POSITION_MASTER HPM WHERE PM.BRANCH_CODE \= TRN.BRANCH_CODE AND TRN.BRANCH_CODE \=? AND PM.PRODUCT_ID \= HPM.PRODUCT_ID AND TRN.PRODUCT_CORE_CODE \='1' AND HPM.QUOTE_NO \= ? AND HPM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=HPM.QUOTE_NO)
CNT_QUOTE=SELECT COUNT(*) FROM MARINE_DATA MD, MARINE_RESULT_DETAILS MRD, MARINE_RESULT MR, MARINE_POLICY_DETAILS MPD, POSITION_MASTER PM WHERE MD.APPLICATION_NO = PM.APPLICATION_NO AND MD.OPEN_COVER_NO = PM.OPEN_COVER_NO AND MRD.APPLICATION_NO = PM.APPLICATION_NO AND MRD.OPEN_COVER_NO = PM.OPEN_COVER_NO AND MR.APPLICATION_NO = PM.APPLICATION_NO AND MR.QUOTE_NO = PM.QUOTE_NO AND MR.CUSTOMER_ID = PM.CUSTOMER_ID AND MPD.QUOTE_NO = PM.QUOTE_NO AND MPD.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.QUOTE_NO = ?
GET_COMMISSION=SELECT POS.QUOTE_NO,(((NVL(POS.PREMIUM,'0')-ROUND((NVL(MD.POLICY_FEE,'0')+(case  WHEN POS.STATUS like '%E%' then NVL(MD.VAT_TAX_AMT,'0') else 0 end)+NVL(MD.GOVT_TAX,'0')+NVL(MD.EMERGENCY_FUND,'0')),0))+NVL(POS.EXCESS_PREMIUM,'0'))*?/100) COMMISSION,(((NVL(POS.PREMIUM,'0')-ROUND((NVL(MD.POLICY_FEE,'0')+NVL(MD.GOVT_TAX,'0')+NVL(MD.EMERGENCY_FUND,'0')),0))+NVL(POS.EXCESS_PREMIUM,'0'))*?/100)TAX FROM POSITION_MASTER POS,MARINE_DATA MD WHERE POS.APPLICATION_NO=? AND MD.APPLICATION_NO=POS.APPLICATION_NO AND POS.AMEND_ID=(SELECT MAX(AMEND_ID)FROM POSITION_MASTER WHERE APPLICATION_NO=POS.APPLICATION_NO) AND MD.AMEND_ID=POS.AMEND_ID ORDER BY POS.QUOTE_NO
CAL_PROC_INTEG=CALL INTEGRATION_TYPE(?)
GET_NOTE_TYPE=SELECT NOTE_TYPE FROM POSITION_MASTER WHERE APPLICATION_NO=?
GET_PAYMENT_MODE=SELECT NVL(PAYMENT_MODE,'CA') FROM POSITION_MASTER WHERE APPLICATION_NO=?

GET_BRANCH_INFO=SELECT CURRENCY_ABBREVIATION CURR_NAME,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,DECIMAL_PLACES,NVL(TAX,'0') TAX,EMAIL FROM BRANCH_MASTER WHERE BRANCH_CODE\=?
GET_POLICY_INFO=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, NVL(OPENCOVER_POLICY_NUMBER, 0), CUSTOMER_ID, CUSTOMER_NAME, ADDRESS1, ADDRESS2, PO_BOX, COUNTRY, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT,TOTAL_SUM_INSURED, TO_CHAR(POLICY_START_DATE,'dd/MM/yyyy'), TO_CHAR(SAILING_DATE,'dd/MM/yyyy'), VESSEL_NAME, LC_NUMBER, ISSUING_BANK, TO_CHAR(LC_DATE,'dd/MM/yyyy'), PARTIAL_SHIPMENT, BL_AWB_NUMBER, TO_CHAR(BL_AWB_DATE,'dd/MM/yyyy'), QUOTE_NO, PREMIUM, POLICY_NO, REMARKS, STATUS, ENDORSEMENT, CLAUSES, WARRANTIES, EXCLUSION, TO_CHAR(RECEIVED_DATE,'dd/mm/yyyy'), RESPONSE_TIME, POLICY_FILE_PATH, APPLICATION_NO, COVERAGES, SEA_COVERAGES, WSRCC, PRODUCT_ID, TOLERANCE,PDF_PRE_SHOW_STATUS,PDF_BANKER_STATUS,PDF_GENERATE_STATUS,PDF_BANKER_ASSURED_STATUS,PDF_CURRENCY_STATUS, EMAIL, CLIENT_CUSTOMER_ID,ORIGIN_CITY_NAME,DEST_CITY_NAME,NOTE_TYPE, PAYMENT_MODE, BASIS_VAL, PACKAGE_TYPE, PDF_STAMP_STATUS,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, ISSUER, LOGIN_ID,CUST_TITLE,CUST_CORE_APP_CODE,SETTLING_AGENT_NAME,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,AC_EXECUTIVE_ID,ADMIN_REFERRAL_YN,ADMIN_REFERRAL_REMARKS,VESSEL_ID,CUST_AR_NO,CERT_CLAUSES_YN,NVL(ADDITIONAL_PREMIUM,0),DEBIT_CUST_ID,ENDT_PREM_YN,ENDT_CLAUSES_YN,PDF_EXCESS_STATUS,PROMOTIONAL_CODE,PROMOTIONAL_DISCOUNT, BRANCH_CODE,CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME, core_customer_name,CHANNEL_TYPE,EXCHANGE_RATE,ISSUER ,VAT_REG_NO,CUST_VAT_YN,VAT_APPLICABLE,SHIPMENT_TRANSIT FROM WEBSERVICE_MARINE_QUOTE WHERE REFERENCE_NUMBER=?
GET_BROKER_INFO=SELECT A.LOGIN_ID,B.BRANCH_CODE,A.COMPANY_ID FROM LOGIN_MASTER A, BROKER_COMPANY_MASTER B WHERE A.AGENCY_CODE=? AND B.AGENCY_CODE=A.AGENCY_CODE
GET_COMM_INFO=SELECT A.COMMODITY_ID, B.COMMODITY_DESCRIPTION, B.SUMINSURED, A.COMMODITY_TYPE_ID, A.COMMODITY_EXCESS_PREMIUM, B.FRAGILE,B.SUPPLIER_NAME,B.PACKAGE_DESCRIPTION,B.INVOICE_NUMBER,A.COMMODITY_RATE,B.WSRCC_RATE,B.ENDORSEMENT FROM COMMODITYMASTER A, WEBSERVICE_MARINE_COMMODITY B WHERE B.REFERENCE_NUMBER=? AND A.COMMODITY_ID=B.COMMODITY_CODE AND A.BRANCH_CODE=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=A.COMMODITY_ID AND BRANCH_CODE=A.BRANCH_CODE) ORDER BY COMMODITY_ID
GET_LOGIN_ID=SELECT LOGIN_ID FROM POSITION_MASTER A WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
GET_AMEND_ID=SELECT NVL(MAX(AMEND_ID),0) FROM POSITION_MASTER WHERE APPLICATION_NO=?
GET_POL_COM=SELECT DISCOUNT_PREMIUM FROM POSITION_MASTER A WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
GET_BANK_NAME=SELECT BANK_NAME FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=?
#GET_PORTFOLIO_ISSUER=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE\=?)) AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.POLICY_NO LIKE UPPER(?) AND ORIGINAL_POLICY_NO IS NULL ORDER BY SUBSTR (A.POLICY_NO, 9, 16) DESC
GET_PORTFOLIO_SEARCH_ISSUER=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= A.LOGIN_ID)) BROKER_NAME, TO_CHAR(MD.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, (SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO \= A.OPEN_COVER_NO AND OCPM.PROPOSAL_NO \= OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \= OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO \= OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY'))) OC_CUST_ID FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE \= ?)) AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.OPEN_COVER_NO \= NVL(?,'0') AND A.POLICY_NO LIKE UPPER (?) AND ORIGINAL_POLICY_NO IS NULL AND MD.APPLICATION_NO \= A.APPLICATION_NO 
GET_PORTFOLIO_ISSUER=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= A.LOGIN_ID)) BROKER_NAME, TO_CHAR(MD.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, (SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO \= A.OPEN_COVER_NO AND OCPM.PROPOSAL_NO \= OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \= OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO \= OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY'))) OC_CUST_ID FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE \= ?)) AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.POLICY_NO LIKE UPPER (?) AND ORIGINAL_POLICY_NO IS NULL AND MD.APPLICATION_NO \= A.APPLICATION_NO 
#GET_PORTFOLIO_OC=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE {0} A.STATUS \= ''P'' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,''1'')   AND A.OPEN_COVER_NO LIKE ? AND ORIGINAL_POLICY_NO IS NULL
GET_PORTFOLIO_OC=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE {0} A.STATUS in (''P'',''D'') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND decode(?,''1'',''1'','''',''1'',a.application_id) \= NVL(?,''1'')   AND A.OPEN_COVER_NO LIKE ? AND ORIGINAL_POLICY_NO IS NULL
GET_OC_CUST_ID=SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO = ? AND OCPM.PROPOSAL_NO = OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO = OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO = OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <= TO_DATE (SYSDATE, 'dd-MM-YYYY'))
CNT_OC_DEPOSIT=SELECT COUNT(1) FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO=? AND A.DEPOSIT_PREMIUM_YN='Y'
GET_ENDT_INFO=SELECT A.APPLICATION_NO, A.QUOTE_NO, (CASE WHEN A.STATUS = 'R' THEN 'RR' WHEN ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') OR (A.REMARKS IN ('Admin','Normal','Referal','NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'Y') AND A.STATUS = 'E')  THEN 'RU'  WHEN (    A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'N' AND A.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,A.STATUS,A.ENDT_STATUS FROM   POSITION_MASTER A, MARINE_DATA MD WHERE MD.APPLICATION_NO = A.APPLICATION_NO AND A.LOGIN_ID = ? AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID = ? AND A.ORIGINAL_POLICY_NO = ? AND A.QUOTE_NO=(select max(QUOTE_NO) from POSITION_MASTER where  LOGIN_ID=a.LOGIN_ID AND NVL (OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') and PRODUCT_ID=A.PRODUCT_ID and ORIGINAL_POLICY_NO=A.ORIGINAL_POLICY_NO)

UPD_WS_QUOTE_APPNO=UPDATE WEBSERVICE_MARINE_QUOTE SET APPLICATION_NO=? WHERE REFERENCE_NUMBER=?
UPD_WS_COMM_APPNO=UPDATE WEBSERVICE_MARINE_COMMODITY SET APPLICATION_NO=? WHERE REFERENCE_NUMBER=?
UPD_WS_QUOTE_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET APPLICATION_NO=?, QUOTE_NO=?, PREMIUM=(SELECT PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)), REMARKS=?, CUSTOMER_ID=?, STATUS=?, QUOTATION_DATE=(SELECT ENTRY_DATE FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)),ADDITIONAL_PREMIUM=(SELECT EXCESS_PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)) WHERE REFERENCE_NUMBER=?
UPD_WS_POLICY_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET POLICY_NO=?, POLICY_FILE_PATH=?, STATUS=? WHERE REFERENCE_NUMBER=?
UPD_WS_PRE_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET PREMIUM=?,ADDITIONAL_PREMIUM=?,WAR_PREMIUM=?,ISSUANCE_FEE=? WHERE APPLICATION_NO=?
UPD_WS_DRAFT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET DRAFT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_QUOTE_SCH_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET QUOTE_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_DEBIT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET DEBIT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_CREDIT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET CREDIT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_ADMIN_REF_INFO=UPDATE MARINE_DATA SET ADMIN_REFERRAL_STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
UPD_POL_REMARKS=UPDATE POSITION_MASTER SET REMARKS='Normal' WHERE APPLICATION_NO=?
UPD_POLICY_DOC_INFO=UPDATE POSITION_MASTER SET PDF_PRE_SHOW_STATUS=?, PDF_BANKER_STATUS=?, PDF_GENERATE_STATUS=?, PDF_BANKER_ASSURED_STATUS=?, PDF_CURRENCY_STATUS=?,PDF_STAMP_STATUS=?,CERT_CLAUSES_YN=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=?,BASIS_VAL=? WHERE APPLICATION_NO=?
UPD_PM_APPR_STS=UPDATE POSITION_MASTER SET ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_MD_APPR_STS=UPDATE POSITION_MASTER SET ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_MRD_COMM_INFO=UPDATE MARINE_RESULT_DETAILS SET SUPPLIER_NAME=?,PACKAGE_DESCRIPTION=?,INVOICE_NUMBER=? WHERE APPLICATION_NO=? AND COMMODITY_ID=?
UPD_WS_ADMIN_REFERRAL=UPDATE WEBSERVICE_MARINE_QUOTE SET ADMIN_REFERRAL_YN=?, ADMIN_REFERRAL_REMARKS=? WHERE APPLICATION_NO=?
UPD_PM_ADMIN_APPR=UPDATE POSITION_MASTER SET STATUS=?, ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_PM_ADMIN_REM=UPDATE POSITION_MASTER SET STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
UPD_PM_ADMIN_REJ=UPDATE POSITION_MASTER SET ADMIN_REMARKS=?,STATUS='R',ENTRY_DATE=(SELECT SYSDATE FROM DUAL),APPROVED_BY=? WHERE APPLICATION_NO=?
##UPDATE POSITION_MASTER SET ADMIN_REMARKS=?,STATUS='R',ENTRY_DATE=(SELECT SYSDATE FROM DUAL) WHERE APPLICATION_NO=?
UPD_MD_ADMIN_STS=UPDATE MARINE_DATA SET ADMIN_REFERRAL_STATUS=? WHERE APPLICATION_NO=?
CNT_QUOTE_REFERRAL=SELECT COUNT(1) FROM MARINE_DATA WHERE APPLICATION_NO=? AND REMARKS LIKE '%Referal'
CAL_PROC_UPD_COMM_RATE=CALL UPDATE_COMMODITY_RATE(?,?)
CAL_PROC_UPD_PREMIUM=CALL UPDATE_PREMIUM(?)
##GET_DEBITNO_SEQ = SELECT ''MDN''||DEBIT_NUMBER_SEQ_{0}.NEXTVAL FROM DUAL
##GET_CERDITNO_SEQ = SELECT ''MCN''||CREDIT_NUMBER_SEQ_{0}.NEXTVAL FROM DUAL
GET_DEBITNO_SEQ = SELECT ''MDN{1}''||DEBIT_NUMBER_SEQ_{0}.NEXTVAL FROM DUAL
GET_CERDITNO_SEQ = SELECT ''MCN{1}''||CREDIT_NUMBER_SEQ_{0}.NEXTVAL FROM DUAL
GET_DEPOSITPREMIUM_STATUS = Select Count(*) From Open_Cover_Master A, Open_Cover_Position_Master B  Where A.Proposal_No = B.Proposal_No And B.Open_Cover_No = ? And B.Status='P' And A.Deposit_Premium_Yn='Y' AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER A1 WHERE A1.Proposal_No=A.Proposal_No)

#ENDORSEMENT
GET_ENDT_TYPE=SELECT ENDT_TYPE_ID, ENDT_TYPE, ENDT_TYPE_DESC, ENDT_TYPE_CATEGORY_ID, ENDT_TYPE_CATEGORY FROM ENDT_TYPE_MASTER WHERE STATUS='Y' AND PRODUCT_ID=? ORDER BY ENDT_TYPE_ID,ENDT_TYPE_CATEGORY_ID
GET_TRAVEL_END_LIST=SELECT HPM.APPLICATION_NO,HPM.QUOTE_NO, NVL(PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,TO_CHAR(HPM.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE ,HPM.ENDT_PREMIUM+HPM.POLICY_FEE PREMIUM ,HPM.POLICY_NO ,HPM.STATUS,(CASE WHEN hpm.STATUS\='R' THEN 'RR' WHEN ((hpm.REMARKS IN ('Referal') AND hpm.ADMIN_REFERRAL_STATUS \= 'N') OR (hpm.REMARKS IN ('Admin', 'Normal' , 'Referal') AND hpm.ADMIN_REFERRAL_STATUS \= 'Y') AND HPM.STATUS \= 'E') THEN 'RU' WHEN (HPM.REMARKS IN ('ADMIN') AND HPM.ADMIN_REFERRAL_STATUS \= 'N' AND HPM.STATUS \= 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,'Y' ENDT_STATUS,HPM.CUSTOMER_ID,HPM.DEBIT_NOTE_NO,HPM.RECEIPT_NO,HPM.ENDT_TYPE_ID ENDT_TYPE FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE HPM.ORIGINAL_POLICY_NO \= ? AND HPM.PRODUCT_ID \= ? AND HPM.CUSTOMER_ID \= PI.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY HPM.QUOTE_NO DESC
GET_END_LIST=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO,ENDT_TYPE,(CASE WHEN A.STATUS='R' THEN 'Referal Reject' WHEN ((A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') OR (A.REMARKS IN ('Admin', 'Normal' , 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'Y') AND A.STATUS = 'E') THEN 'ReferalUnapproved' WHEN (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'N' AND A.STATUS = 'E') THEN 'ReferalApproved' WHEN A.STATUS = 'P' THEN 'Policy Converted'  WHEN A.STATUS = 'E' THEN 'ExistingQuote' WHEN A.STATUS = 'C' THEN 'Cancelled Policy' ELSE 'N' END) REF_STATUS,A.STATUS,A.APPLICATION_NO,A.ENDT_STATUS,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=A.LOGIN_ID)) BROKER_NAME,DECODE(A.OPEN_COVER_NO,'0','',A.OPEN_COVER_NO) FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE MD.APPLICATION_NO=A.APPLICATION_NO AND A.LOGIN_ID=? AND B.CUSTOMER_ID = A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID = ? AND A.ORIGINAL_POLICY_NO = ? ORDER BY A.INCEPTION_DATE DESC, A.QUOTE_NO DESC
GET_POL_ENDT=SELECT ENDT_TYPE FROM POSITION_MASTER WHERE APPLICATION_NO\=?
GET_ENDT_LIST_ISSUER=SELECT DISTINCT A.POLICY_NO ,A.QUOTE_NO, A.CUSTOMER_ID ,A.PREMIUM, TO_CHAR (A.INCEPTION_DATE,'DD/MM/YYYY') QUOTATION_DATE ,NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME ,B.LAST_NAME ,A.LOGIN_ID ,A.QUOTE_NO ,A.EXCESS_PREMIUM ,B.COMPANY_NAME ,A.INCEPTION_DATE ,NVL (A.OPEN_COVER_NO, '0') ,A.DEBIT_NOTE_NO ,A.CREDIT_NOTE_NO ,A.AMEND_ID ,( SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A ,PERSONAL_INFO B WHERE A.LOGIN_ID= ? AND A.STATUS IN  ('P','E') and A.status = 'P' and A.product_id = a.product_id AND B.CUSTOMER_ID = A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID =? AND A.APPLICATION_ID = NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') LIKE ?||'%' AND A.POLICY_NO = CASE WHEN A.PRODUCT_ID = 3 THEN REGEXP_SUBSTR(A.POLICY_NO,'[^-]+',1,1) ELSE SUBSTR(A.POLICY_NO,1,DECODE(INSTR(A.POLICY_NO,'-',1,3)-1,-1,LENGTH( A.POLICY_NO),INSTR(A.POLICY_NO,'-',1,3)-1)) END AND A.ORIGINAL_POLICY_NO IS NULL
##SELECT DISTINCT C.POLICY_NO ,C.CUSTOMER_ID ,C.PREMIUM, TO_CHAR (C.INCEPTION_DATE,'DD/MM/YYYY') QUOTATION_DATE ,NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME ,B.LAST_NAME ,C.LOGIN_ID ,C.QUOTE_NO ,C.EXCESS_PREMIUM ,B.COMPANY_NAME ,C.INCEPTION_DATE ,NVL (C.OPEN_COVER_NO, '0') ,C.DEBIT_NOTE_NO ,C.CREDIT_NOTE_NO ,C.AMEND_ID ,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=C.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A ,PERSONAL_INFO B ,POSITION_MASTER C WHERE A.LOGIN_ID\= ? AND A.STATUS IN  ('P','E') and c.status \= 'P' and c.product_id \= a.product_id AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') LIKE ?||'%' AND C.POLICY_NO \= CASE WHEN A.PRODUCT_ID \= 3 THEN REGEXP_SUBSTR(A.POLICY_NO,'[^-]+',1,1) ELSE SUBSTR(A.POLICY_NO,1,DECODE(INSTR(A.POLICY_NO,'-',1,3)-1,-1,LENGTH(A.POLICY_NO),INSTR(A.POLICY_NO,'-',1,3)-1)) END AND C.ORIGINAL_POLICY_NO IS NULL 
#GET_ENDT_PRE_INFO=SELECT * FROM (SELECT ORIGINAL_POLICY_NO,QUOTE_NO, PREMIUM, LAG(PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS PREMIUM_PREV, PREMIUM + NVL (POLICY_FEE, 0) -LAG(PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) PREMIUM_DIFF, PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0) MARINE_PREMIUM, LAG(PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS MARINE_PREMIUM_PREV, (PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0))-LAG(PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) MARINE_PREMIUM_DIFF, TOTAL_WAR_CHARGES WAR_PREMIUM, LAG(TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS WAR_PREMIUM_PREV, TOTAL_WAR_CHARGES-LAG(TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) WAR_PREMIUM_DIFF, EXCESS_PREMIUM, LAG(EXCESS_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS EXCESS_PREMIUM_PREV, EXCESS_PREMIUM EXCESS_PREMIUM_DIFF, POLICY_FEE, LAG(POLICY_FEE, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS POLICY_FEE_PREV, POLICY_FEE POLICY_FEE_DIFF FROM MARINE_DATA_ENDT ) WHERE QUOTE_NO = ?
GET_ENDT_PRE_INFO=SELECT * FROM (SELECT ORIGINAL_POLICY_NO,QUOTE_NO, PREMIUM+NVL (EXCESS_PREMIUM, 0) PREMIUM, LAG(PREMIUM + NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS PREMIUM_PREV, (PREMIUM+NVL (EXCESS_PREMIUM, 0))-(LAG(PREMIUM + NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO)) PREMIUM_DIFF, PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0) MARINE_PREMIUM, LAG(PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS MARINE_PREMIUM_PREV, (PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0))-LAG(PREMIUM-NVL(TOTAL_WAR_CHARGES,0)-NVL(POLICY_FEE,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) MARINE_PREMIUM_DIFF, TOTAL_WAR_CHARGES WAR_PREMIUM, LAG(TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS WAR_PREMIUM_PREV, TOTAL_WAR_CHARGES-LAG(TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) WAR_PREMIUM_DIFF, EXCESS_PREMIUM, LAG(EXCESS_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS EXCESS_PREMIUM_PREV, EXCESS_PREMIUM EXCESS_PREMIUM_DIFF, 0 POLICY_FEE, LAG(POLICY_FEE, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS POLICY_FEE_PREV, POLICY_FEE POLICY_FEE_DIFF FROM MARINE_DATA_ENDT ) WHERE QUOTE_NO = ?
GET_COMM_RATE_INFO=SELECT MRD.COMMODITY_ID, MRD.RATE, MRD.WARRATE, MRD.WAREHOUSE_WAREHOUSE, '0', MRD.COMMODITY_EXCESS_PREMIUM FROM MARINE_RESULT_DETAILS MRD WHERE MRD.APPLICATION_NO=(SELECT APPLICATION_NO FROM POSITION_MASTER WHERE PDF_MODIFY_CLAUSE IS NOT NULL AND UPPER(PDF_MODIFY_CLAUSE) != 'NOTHING' AND APPLICATION_NO=?)
GET_ENDT_SI_DIFF_REF=SELECT ? - ( MD2.EQUIVALENT_USD + NVL (MD2.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD2.TOTAL_TOLERANCE_CHARGES, 0)) SUMINSURED_DIFF FROM POSITION_MASTER PM1, POSITION_MASTER PM2, MARINE_DATA MD2 WHERE PM1.QUOTE_NO = ? AND PM1.ORIGINAL_POLICY_NO = NVL (PM2.ORIGINAL_POLICY_NO, PM2.POLICY_NO) AND PM1.AMEND_ID = PM2.AMEND_ID + 1 AND MD2.APPLICATION_NO = PM2.APPLICATION_NO AND PM2.AMEND_ID = MD2.AMEND_ID
GET_ENDT_SI_DIFF=SELECT ( MD1.EQUIVALENT_USD + NVL (MD1.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD1.TOTAL_TOLERANCE_CHARGES, 0)) - ( MD2.EQUIVALENT_USD + NVL (MD2.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD2.TOTAL_TOLERANCE_CHARGES, 0)) SUMINSURED_DIFF FROM POSITION_MASTER PM1, MARINE_DATA MD1, POSITION_MASTER PM2, MARINE_DATA MD2 WHERE PM1.QUOTE_NO = ? AND PM1.ORIGINAL_POLICY_NO = NVL (PM2.ORIGINAL_POLICY_NO, PM2.POLICY_NO) AND PM1.AMEND_ID = PM2.AMEND_ID + 1 AND MD1.APPLICATION_NO = PM1.APPLICATION_NO AND PM1.AMEND_ID = MD1.AMEND_ID AND MD2.APPLICATION_NO = PM2.APPLICATION_NO AND PM2.AMEND_ID = MD2.AMEND_ID
GET_QUOTE_ENDT_TYPE=SELECT RTRIM(XMLAGG(XMLELEMENT(E,ENDT_TYPE || ', ')).EXTRACT('//text()'),', ') ENDT_TYPE FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_ID IN (?)
GET_POL_ENDT_LIST=SELECT ENDT_TYPE FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_ID IN (?)
GET_ORIGINAL_POLNO=SELECT NVL(ORIGINAL_POLICY_NO, OPEN_COVER_NO) FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?
GET_ENDT_POL_INFO=SELECT A.POLICY_NO, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = (SELECT OA_CODE  FROM LOGIN_MASTER  WHERE LOGIN_ID = A.LOGIN_ID)) BROKER_NAME, DECODE (A.OPEN_COVER_NO, '0', '', A.OPEN_COVER_NO) OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE MD.APPLICATION_NO = A.APPLICATION_NO AND A.QUOTE_NO = ? AND B.CUSTOMER_ID = A.CUSTOMER_ID
#GET_ENDT_POL=SELECT BM.BRANCH_CODE, BM.BRANCH_NAME, NVL (BM.ORIGINATION_COUNTRY_ID, 0) ORIGINATION_COUNTRY_ID, BM.CURRENCY_ABBREVIATION, NVL (BM.DECIMAL_PLACES, 0) DECIMAL_PLACES, BM.HEADER_IMG, BM.FOOTER_IMG, BM.SIGN_IMG, BM.STAMP, BM.CURRENCY_NAME, NVL (BM.CURRENCY_ACRONYM, ' ') CURRENCY_ACRONYM, BM.CURRENCY_DECIMAL_NAME, BM.CURRENCY_DECIMAL_DIGIT, BM.ADDRESS1, BM.REMARKS, CR.COVER_NAME, (CASE WHEN PM.PRODUCT_ID = '11' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) WHEN PM.PRODUCT_ID = '3' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN MPD.BANK_NAME ELSE NULL END) ASSURED, PM.ORIGINAL_POLICY_NO, PI.FIRST_NAME CUST_NAME, PM.AMEND_ID ENDT_NO, TO_CHAR (PM.INCEPTION_DATE, 'dd-mm-yyyy') POLICY_DATE, LAG (EMD.EQUIVALENT_USD, 1, 0) OVER (ORDER BY EMD.ORIGINAL_POLICY_NO, EMD.ENDT_NO) PREV_SUMINSURED, EMD.EQUIVALENT_USD SUMINSURED, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE = 'YES' THEN MD.TRANSIT_FROM || ',' || FN_GET_CODE ('CNAME', MD.TRANSIT_FROM_COUNTRY_ID, NULL, NULL) ELSE FN_GET_CODE ('CNAME', MD.TRANSIT_FROM_COUNTRY_ID, NULL, NULL) END) || ' To ' || (CASE WHEN MD.WARE_TO_WARE_FINAL_DEST = 'YES' THEN MD.FINAL_DESTINATION || ',' || FN_GET_CODE ('CNAME', MD.FINAL_DESTINATION_COUNTRY_ID, NULL, NULL) ELSE FN_GET_CODE ('CNAME', MD.FINAL_DESTINATION_COUNTRY_ID, NULL, NULL) END) VOYAGE, CASE WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END BASIS_OF_VAL, CO.CONVDESC CONVEYANCE, CM.CURRENCY_NAME CURRENCY, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('LCNO', MD.OPEN_LC_ID, NULL, NULL) ELSE MPD.LC_NUMBER END) LC_NUMBER, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) ELSE MPD.BANK_NAME END) BANK_NAME, MPD.BL_AWB_NO, (SELECT CASE WHEN UPPER (NVL (SETTLING_AGENT_ID, '0')) = '0' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID = MPD.SETTLING_AGENT_ID AND BELONGING_COUNTRY_ID = BM.ORIGINATION_COUNTRY_ID AND BRANCH_CODE = BM.BRANCH_CODE) SETTLING_AGENT, MD.EXTRA_COVER_ID, TO_CHAR (MRD.WARRATE, '0.999999') WARRATE, TO_CHAR (MRD.RATE, '0.999999') RATE, EMD.PREMIUM, EMD.PREMIUM - NVL (EMD.TOTAL_WAR_CHARGES, 0) - NVL (EMD.POLICY_FEE, 0) MARINE_PREMIUM, EMD.TOTAL_WAR_CHARGES WAR_PREMIUM, EMD.PREMIUM - NVL (EMD.POLICY_FEE, 0) TOTAL, LAG (EMD.PREMIUM - NVL (EMD.POLICY_FEE, 0), 1, 0) OVER (ORDER BY EMD.ORIGINAL_POLICY_NO, EMD.ENDT_NO) LESS_PREMIUM, EMD.PREMIUM - NVL (EMD.POLICY_FEE, 0) - LAG (EMD.PREMIUM - NVL (EMD.POLICY_FEE, 0), 1, 0) OVER (ORDER BY EMD.ORIGINAL_POLICY_NO, EMD.ENDT_NO) FINAL_TOTAL, (CASE WHEN MD.EXTRA_COVER_ID != 0 THEN 'Yes with Rate ' || TO_CHAR (MRD.WARRATE, '0.999999') || '%' ELSE NULL END) WSRCC, EMD.EQUIVALENT_USD + NVL (MRD.SALE_TERM_CHARGES, 0) + NVL (MRD.TOLERANCE_CHARGES, 0) SUM_INSURED, PM.PDF_STAMP_STATUS FROM BRANCH_MASTER BM, POSITION_MASTER PM, MARINE_DATA_ENDT EMD, MARINE_DATA MD, MARINE_POLICY_DETAILS MPD, PERSONAL_INFO PI, ( SELECT APPLICATION_NO, AMEND_ID, SUM (SUMINSUREDLOCAL) SUMINSUREDLOCAL, SUM (PREMIUM) PREMIUM, SUM (WAR_CHARGES) WAR_CHARGES, SUM (RATE) RATE, SUM (WARRATE) WARRATE, SUM (SALE_TERM_CHARGES) SALE_TERM_CHARGES, SUM (TOLERANCE_CHARGES) TOLERANCE_CHARGES FROM MARINE_RESULT_DETAILS GROUP BY APPLICATION_NO, AMEND_ID) MRD, CURRENCY_MASTER CM, CONVEYAN_MASTER CO, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM, COVER_MASTER CR WHERE BM.BRANCH_CODE = ? AND PM.POLICY_NO = ? AND EMD.POLICY_NO = PM.POLICY_NO AND PM.APPLICATION_NO = MD.APPLICATION_NO AND PM.APPLICATION_NO = MRD.APPLICATION_NO AND PM.QUOTE_NO = MPD.QUOTE_NO AND MD.CURRENCY_ID = CM.CURRENCY_ID AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID) AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND CO.SNO = MD.SEA_OPTIONS AND CO.BRANCH_CODE = BM.BRANCH_CODE AND CO.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND SM.SALE_TERM_ID = MD.SALE_TERM_ID AND SM.BRANCH_CODE = BM.BRANCH_CODE AND TM.TOLERANCE_ID = MD.TOLERANCE_ID AND TM.BRANCH_CODE = BM.BRANCH_CODE AND CR.COVER_ID = MD.COVER_ID AND CR.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID = CR.COVER_ID AND BRANCH_CODE = CR.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <= TO_DATE (SYSDATE, 'DD-MM-YY')) AND TO_DATE (CR.EFFECTIVE_DATE, 'DD-MM-YY') <= TO_DATE (SYSDATE, 'DD-MM-YY') AND CR.BRANCH_CODE = BM.BRANCH_CODE AND CR.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT
#GET_ENDT_POL=SELECT PM.CUSTOMER_ID,UPPER(PI.TITLE||' '||PI.FIRST_NAME) CUST_FIRST_NAME,PI.POBOX CUST_POBOX,UPPER(PI.COMPANY_NAME) CUST_COMPANY,UPPER(PI.LAST_NAME) CUST_LAST_NAME, UPPER(PI.ADDRESS1) CUST_ADDR1,UPPER(PI.ADDRESS2) CUST_ADDR2,PI.TELEPHONE CUST_TEL,UPPER(PI.COUNTRY) CUST_COUNTRY,UPPER(NVL(PI.CITY,PI.EMIRATE)) CUST_CITY, BM.BRANCH_CODE, BM.BRANCH_NAME, NVL (BM.ORIGINATION_COUNTRY_ID, 0) ORIGINATION_COUNTRY_ID, BM.CURRENCY_ABBREVIATION, NVL (BM.DECIMAL_PLACES, 0) DECIMAL_PLACES, BM.HEADER_IMG, BM.FOOTER_IMG, BM.SIGN_IMG, BM.STAMP, BM.CURRENCY_NAME, NVL (BM.CURRENCY_ACRONYM, ' ') CURRENCY_ACRONYM, BM.CURRENCY_DECIMAL_NAME, BM.CURRENCY_DECIMAL_DIGIT, BM.ADDRESS1, BM.REMARKS, CR.COVER_NAME, (CASE WHEN PM.PRODUCT_ID = '11' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) WHEN PM.PRODUCT_ID = '3' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN MPD.BANK_NAME ELSE NULL END) ASSURED, PM.ORIGINAL_POLICY_NO, PI.FIRST_NAME CUST_NAME, PM.AMEND_ID ENDT_NO, TO_CHAR (PM.INCEPTION_DATE, 'dd-mm-yyyy') POLICY_DATE, EMD.PREV_SUMINSURED, EMD.SUMINSURED, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE = 'YES' THEN to_char(MD.TRANSIT_FROM) || ',' || FN_GET_CODE ('CNAME', to_char(MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL) ELSE FN_GET_CODE ('CNAME', to_char(MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL) END) || ' To ' || (CASE WHEN MD.WARE_TO_WARE_FINAL_DEST = 'YES' THEN to_char(MD.FINAL_DESTINATION) || ',' || FN_GET_CODE ('CNAME', to_char(MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL) ELSE FN_GET_CODE ('CNAME', to_char(MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL) END) VOYAGE, CASE WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END BASIS_OF_VAL, CO.CONVDESC CONVEYANCE, CM.CURRENCY_NAME CURRENCY, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('LCNO', MD.OPEN_LC_ID, NULL, NULL) ELSE to_char(MPD.LC_NUMBER) END) LC_NUMBER, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) ELSE MPD.BANK_NAME END) BANK_NAME, MPD.BL_AWB_NO, DECODE (NVL (SAM.SETTLING_AGENT_ID, 0), 0, MPD.SETTLING_AGENT_NAME, SAM.SETTLING_AGENT_NAME) SETTLING_AGENT, MD.EXTRA_COVER_ID, TO_CHAR (MRD.WARRATE, '0.999999') WARRATE, TO_CHAR (MRD.RATE, '0.999999') RATE, EMD.TOTAL_PREMIUM PREMIUM, EMD.MARINE_PREMIUM, EMD.WAR_PREMIUM, EMD.TOTAL_MARINE_WAR TOTAL, EMD.PREV_MARINE_WAR_PREMIUM LESS_PREMIUM, EMD.FINAL_TOTAL_MARINE_WAR FINAL_TOTAL, EMD.EXCESS_PREMIUM, EMD.POLICY_FEE, EMD.NET_PREMIUM, (CASE WHEN MD.EXTRA_COVER_ID != 0 THEN 'Yes with Rate ' || TO_CHAR (MRD.WARRATE, '0.999999') || '%' ELSE NULL END) WSRCC, PM.PDF_STAMP_STATUS, PM.PRODUCT_ID,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN FROM POSITION_MASTER PM JOIN BRANCH_MASTER BM ON BM.BRANCH_CODE = ? JOIN (SELECT QUOTE_NO, POLICY_NO, APPLICATION_NO, EQUIVALENT_USD + NVL (TOTAL_SALE_TERM_CHARGES, 0) + NVL (TOTAL_TOLERANCE_CHARGES, 0) SUMINSURED, LAG ( EQUIVALENT_USD + NVL (TOTAL_SALE_TERM_CHARGES, 0) + NVL (TOTAL_TOLERANCE_CHARGES, 0), 1, 0 ) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_SUMINSURED, PREMIUM - NVL (TOTAL_WAR_CHARGES, 0) - NVL (POLICY_FEE, 0) MARINE_PREMIUM, NVL (TOTAL_WAR_CHARGES, 0) WAR_PREMIUM, NVL (EXCESS_PREMIUM, 0) EXCESS_PREMIUM, NVL (POLICY_FEE, 0) POLICY_FEE, PREMIUM - NVL (POLICY_FEE, 0) TOTAL_MARINE_WAR, PREMIUM + NVL (EXCESS_PREMIUM, 0) TOTAL_PREMIUM, LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_MARINE_WAR_PREMIUM, (PREMIUM - NVL (POLICY_FEE, 0)) - LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) FINAL_TOTAL_MARINE_WAR, (PREMIUM - NVL (POLICY_FEE, 0)) - LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) + NVL (EXCESS_PREMIUM, 0) + NVL (POLICY_FEE, 0) NET_PREMIUM FROM MARINE_DATA_ENDT) EMD ON EMD.POLICY_NO = PM.POLICY_NO JOIN MARINE_DATA MD ON MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MD.AMEND_ID JOIN MARINE_POLICY_DETAILS MPD ON PM.QUOTE_NO = MPD.QUOTE_NO AND PM.AMEND_ID = MPD.AMEND_ID JOIN ( SELECT APPLICATION_NO, AMEND_ID, SUM (RATE) RATE, SUM (WARRATE) WARRATE FROM MARINE_RESULT_DETAILS GROUP BY APPLICATION_NO, AMEND_ID) MRD ON MRD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MRD.AMEND_ID JOIN CURRENCY_MASTER CM ON MD.CURRENCY_ID = CM.CURRENCY_ID JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = PM.CUSTOMER_ID JOIN SALE_TERM_MASTER SM ON SM.SALE_TERM_ID = MD.SALE_TERM_ID AND SM.BRANCH_CODE = BM.BRANCH_CODE JOIN TOLERANCE_MASTER TM ON TM.TOLERANCE_ID = MD.TOLERANCE_ID AND TM.BRANCH_CODE = BM.BRANCH_CODE JOIN COVER_MASTER CR ON CR.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND CR.COVER_ID = MD.COVER_ID AND CR.BRANCH_CODE = BM.BRANCH_CODE AND TRUNC (CR.EFFECTIVE_DATE) <= TRUNC (SYSDATE) LEFT OUTER JOIN CONVEYAN_MASTER CO ON CO.SNO = MD.SEA_OPTIONS AND CO.BRANCH_CODE = BM.BRANCH_CODE AND CO.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT LEFT OUTER JOIN SETTLING_AGENT_MASTER SAM ON SAM.SETTLING_AGENT_ID = MPD.SETTLING_AGENT_ID AND SAM.BELONGING_COUNTRY_ID = BM.ORIGINATION_COUNTRY_ID  WHERE PM.POLICY_NO = ? AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID) AND PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND CR.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID = CR.COVER_ID AND BRANCH_CODE = CR.BRANCH_CODE AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE))
GET_ENDT_POL=SELECT PM.CUSTOMER_ID,UPPER(PI.TITLE||' '||PI.FIRST_NAME) CUST_FIRST_NAME,PI.POBOX CUST_POBOX,UPPER(PI.COMPANY_NAME) CUST_COMPANY,UPPER(PI.LAST_NAME) CUST_LAST_NAME, UPPER(PI.ADDRESS1) CUST_ADDR1,UPPER(PI.ADDRESS2) CUST_ADDR2,PI.TELEPHONE CUST_TEL,UPPER(PI.COUNTRY) CUST_COUNTRY,UPPER(NVL(PI.CITY,PI.EMIRATE)) CUST_CITY, BM.BRANCH_CODE, BM.BRANCH_NAME, NVL (BM.ORIGINATION_COUNTRY_ID, 0) ORIGINATION_COUNTRY_ID, BM.CURRENCY_ABBREVIATION, NVL (BM.DECIMAL_PLACES, 0) DECIMAL_PLACES, BM.HEADER_IMG, BM.FOOTER_IMG, BM.SIGN_IMG, BM.STAMP, BM.CURRENCY_NAME, NVL (BM.CURRENCY_ACRONYM, ' ') CURRENCY_ACRONYM, BM.CURRENCY_DECIMAL_NAME, BM.CURRENCY_DECIMAL_DIGIT, BM.ADDRESS1, BM.REMARKS, CR.COVER_NAME, (CASE WHEN PM.PRODUCT_ID = '11' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) WHEN PM.PRODUCT_ID = '3' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN MPD.BANK_NAME ELSE NULL END) ASSURED, PM.ORIGINAL_POLICY_NO, PI.FIRST_NAME CUST_NAME, PM.AMEND_ID ENDT_NO, TO_CHAR (PM.INCEPTION_DATE, 'dd-mm-yyyy') POLICY_DATE, EMD.PREV_SUMINSURED, EMD.SUMINSURED, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE = 'YES' THEN to_char(MD.TRANSIT_FROM) || ',' || FN_GET_CODE ('CNAME', to_char(MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL) ELSE FN_GET_CODE ('CNAME', to_char(MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL) END) || ' To ' || (CASE WHEN MD.WARE_TO_WARE_FINAL_DEST = 'YES' THEN to_char(MD.FINAL_DESTINATION) || ',' || FN_GET_CODE ('CNAME', to_char(MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL) ELSE FN_GET_CODE ('CNAME', to_char(MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL) END) VOYAGE, CASE WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END BASIS_OF_VAL, CO.CONVDESC CONVEYANCE, CM.CURRENCY_NAME CURRENCY, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('LCNO', MD.OPEN_LC_ID, NULL, NULL) ELSE to_char(MPD.LC_NUMBER) END) LC_NUMBER, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) ELSE MPD.BANK_NAME END) BANK_NAME, MPD.BL_AWB_NO, DECODE (NVL (SAM.SETTLING_AGENT_ID, 0), 0, MPD.SETTLING_AGENT_NAME, SAM.SETTLING_AGENT_NAME) SETTLING_AGENT, MD.EXTRA_COVER_ID, TO_CHAR (MRD.WARRATE, '0.999999') WARRATE, TO_CHAR (MRD.RATE, '0.999999') RATE, EMD.TOTAL_PREMIUM PREMIUM, EMD.MARINE_PREMIUM, EMD.WAR_PREMIUM, EMD.TOTAL_MARINE_WAR TOTAL, EMD.PREV_MARINE_WAR_PREMIUM LESS_PREMIUM, EMD.FINAL_TOTAL_MARINE_WAR FINAL_TOTAL, EMD.EXCESS_PREMIUM, EMD.POLICY_FEE, EMD.NET_PREMIUM, (CASE WHEN MD.EXTRA_COVER_ID != 0 THEN 'Yes with Rate ' || TO_CHAR (MRD.WARRATE, '0.999999') || '%' ELSE NULL END) WSRCC, PM.PDF_STAMP_STATUS, PM.PRODUCT_ID,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN FROM POSITION_MASTER PM JOIN BRANCH_MASTER BM ON BM.BRANCH_CODE = ? JOIN (SELECT QUOTE_NO, POLICY_NO, APPLICATION_NO, EQUIVALENT_USD + NVL (TOTAL_SALE_TERM_CHARGES, 0) + NVL (TOTAL_TOLERANCE_CHARGES, 0) SUMINSURED, LAG ( EQUIVALENT_USD + NVL (TOTAL_SALE_TERM_CHARGES, 0) + NVL (TOTAL_TOLERANCE_CHARGES, 0), 1, 0 ) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_SUMINSURED, PREMIUM - NVL (TOTAL_WAR_CHARGES, 0) - NVL (POLICY_FEE, 0) MARINE_PREMIUM, NVL (TOTAL_WAR_CHARGES, 0) WAR_PREMIUM, NVL (EXCESS_PREMIUM, 0) EXCESS_PREMIUM, NVL (POLICY_FEE, 0) POLICY_FEE, PREMIUM - NVL (POLICY_FEE, 0) TOTAL_MARINE_WAR, PREMIUM + NVL (EXCESS_PREMIUM, 0) TOTAL_PREMIUM, LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_MARINE_WAR_PREMIUM, (PREMIUM - NVL (POLICY_FEE, 0)) - LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) FINAL_TOTAL_MARINE_WAR, (PREMIUM - NVL (POLICY_FEE, 0)) - LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) + NVL (EXCESS_PREMIUM, 0) + NVL (POLICY_FEE, 0) NET_PREMIUM FROM MARINE_DATA_ENDT) EMD ON EMD.POLICY_NO = PM.POLICY_NO JOIN MARINE_DATA MD ON MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MD.AMEND_ID JOIN MARINE_POLICY_DETAILS MPD ON PM.QUOTE_NO = MPD.QUOTE_NO AND PM.AMEND_ID = MPD.AMEND_ID JOIN ( SELECT APPLICATION_NO, AMEND_ID, SUM (RATE) RATE, SUM (WARRATE) WARRATE FROM MARINE_RESULT_DETAILS GROUP BY APPLICATION_NO, AMEND_ID) MRD ON MRD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MRD.AMEND_ID JOIN CURRENCY_MASTER CM ON MD.CURRENCY_ID = CM.CURRENCY_ID JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = PM.CUSTOMER_ID JOIN SALE_TERM_MASTER SM ON SM.SALE_TERM_ID = MD.SALE_TERM_ID AND SM.BRANCH_CODE = BM.BELONGING_BRANCH JOIN TOLERANCE_MASTER TM ON TM.TOLERANCE_ID = MD.TOLERANCE_ID AND TM.BRANCH_CODE = BM.BELONGING_BRANCH JOIN COVER_MASTER CR ON CR.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND CR.COVER_ID = MD.COVER_ID AND CR.BRANCH_CODE = BM.BELONGING_BRANCH AND TRUNC (CR.EFFECTIVE_DATE) <= TRUNC (SYSDATE) LEFT OUTER JOIN CONVEYAN_MASTER CO ON CO.SNO = MD.SEA_OPTIONS AND CO.BRANCH_CODE = BM.BELONGING_BRANCH AND CO.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT LEFT OUTER JOIN SETTLING_AGENT_MASTER SAM ON SAM.SETTLING_AGENT_ID = MPD.SETTLING_AGENT_ID AND SAM.BELONGING_COUNTRY_ID = BM.ORIGINATION_COUNTRY_ID  WHERE PM.POLICY_NO = ? AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID) AND PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND CR.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID = CR.COVER_ID AND BRANCH_CODE = CR.BRANCH_CODE AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE))
GET_POL_DEDUCT=SELECT MRD.COMMODITY_EXCESS_PREMIUM, MRD.DESCRIPTION, (SELECT CURRENCY_NAME FROM OPEN_COVER_DEDUCTIBLE_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE NVL (SUMINSUREDLOCAL, 0) + NVL (SALE_TERM_CHARGES, 0) + NVL (TOLERANCE_CHARGES, 0) BETWEEN A.START_RANGE AND A.END_RANGE AND A.OPEN_COVER_PROPOSAL_NO = B.PROPOSAL_NO AND B.OPEN_COVER_NO = PM.OPEN_COVER_NO AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE OPEN_COVER_PROPOSAL_NO = A.OPEN_COVER_PROPOSAL_NO)) CURRENCY_NAME FROM MARINE_RESULT_DETAILS MRD, POSITION_MASTER PM WHERE MRD. APPLICATION_NO =PM.APPLICATION_NO AND PM.APPLICATION_NO=? AND COMMODITY_EXCESS_PREMIUM > 0
##CNT_POL_ENDT=SELECT COUNT(1) FROM POSITION_MASTER WHERE APPLICATION_NO\=? AND STATUS\='E'
CNT_POL_ENDT=SELECT COUNT(1) FROM POSITION_MASTER WHERE APPLICATION_NO\=? AND ENDT_STATUS\='Y'
CNT_INTG_POL_ENDT=SELECT COUNT(1) FROM POSITION_MASTER WHERE APPLICATION_NO\=? AND ORIGINAL_POLICY_NO is not null
CNT_ENDT_FINANCIAL=SELECT COUNT(*) FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_CATEGORY_ID\=2 AND ENDT_TYPE_ID IN (?)
CNT_ENDT_POL_FEE=SELECT COUNT(*) FROM MARINE_DATA WHERE APPLICATION_NO=? AND NVL(PREMIUM,0)+NVL(EXCESS_PREMIUM,0)!=0
CAL_UPD_ENDT_PRE=CALL ENDT_PREMIUM_CALCULATION(?)
DEL_ENDT_MD=DELETE FROM MARINE_DATA_ENDT WHERE APPLICATION_NO=?
DEL_ENDT_MRD=DELETE FROM MARINE_RESULT_DETAILS_ENDT WHERE APPLICATION_NO\=?
UPD_ENDT_STS=UPDATE POSITION_MASTER A SET A.ENDT_STATUS = 'N', A.POLICY_NO=NULL WHERE A.APPLICATION_NO = ?
UPD_ENDT_STS_REJ=UPDATE POSITION_MASTER A SET A.ENDT_STATUS \= 'Y' WHERE A.POLICY_NO \= ( SELECT PM1.POLICY_NO FROM POSITION_MASTER PM1,POSITION_MASTER PM2 WHERE PM2.APPLICATION_NO \= ? AND NVL(PM2.ORIGINAL_POLICY_NO ,PM2.POLICY_NO) \= NVL(PM1.ORIGINAL_POLICY_NO,PM1.POLICY_NO) AND PM1.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE ENDT_STATUS\='N' AND STATUS\='P' AND NVL(ORIGINAL_POLICY_NO ,POLICY_NO)\=NVL(PM1.ORIGINAL_POLICY_NO ,PM1.POLICY_NO)))
UPD_ENDT_MD_FEE=UPDATE MARINE_DATA_ENDT SET PREMIUM=PREMIUM+?, POLICY_FEE=? WHERE APPLICATION_NO=?
UPD_MD_FEE=UPDATE MARINE_DATA SET PREMIUM=PREMIUM+?, POLICY_FEE=? WHERE APPLICATION_NO=?
UPD_PM_FEE=UPDATE POSITION_MASTER SET PREMIUM\=PREMIUM+? WHERE APPLICATION_NO\=?
GET_QUOTE_ISSUER=SELECT APPLICATION_ID FROM POSITION_MASTER WHERE APPLICATION_NO\=?
GET_OC_INFO=SELECT NVL(A.ORIGINAL_POLICY_NO,A.OPEN_COVER_NO) OPEN_COVER_NO, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=C.BROKER_ID)) BROKER_NAME FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO B, OPEN_COVER_MASTER C WHERE A.OPEN_COVER_NO\=? AND B.CUSTOMER_ID \= C.CUSTOMER_ID AND C.PROPOSAL_NO\=A.PROPOSAL_NO AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=A.PROPOSAL_NO)
GET_COMMODITY_LIST_OC=SELECT COMMODITY_NAME_DESC FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?)
UPD_XL_OPENCOVER_RAW_UPLOAD=UPDATE xl_opencover_raw SET SR_NO\=?, INTEREST \= ?, CONVEYANCE \= (SELECT distinct(TRANSPORT_DESCRIPTION) FROM MODE_OF_TRANSPORT MOT WHERE MODE_TRANSPORT_ID \= ? AND status \= 'Y' AND MOT.BRANCH_CODE\=?), COVER \= (SELECT distinct(COVER_NAME) FROM COVER_MASTER WHERE COVER_ID \= ? AND STATUS \= 'Y' AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= ?)), VOYAGE_FROM \= ?, VOYAGE_TO \= ?, CURRENCY \= ?, INCOTERMS \= (SELECT DISTINCT REGEXP_SUBSTR (Sale_Term_name, '[^+]+', 1, 1) FROM sale_term_master WHERE Branch_code \= ? AND rsacode \= ?), BASIS_OF_VALUATION \=( select SALE_TERM_NAME||TOLERANCE_NAME NAME from (select rownum rn,SALE_TERM_ID,SALE_TERM_NAME from sale_term_master where SALE_TERM_ID\=? and branch_code\=? and status\='Y') left outer join (select rownum rn1,tolerance_id,decode(TOLERANCE_NAME,'NONE','','+'||TOLERANCE_NAME) TOLERANCE_NAME from tolerance_master where tolerance_id\=? and branch_code\=? and status\='Y') on rn\=rn1), PACKAGE_DESCRIPTION \= ?, COMMODITY_DESCRIPTION \= ?, WSRCC\=?, VALIDATION_ERROR\=?, VALIDATION_STATUS\='', PACKING_DETAILS\='' WHERE TRANSACTION_ID\=? AND SNO \=?
UPD_XL_OPENCOVER_ARC_UPLOAD=UPDATE xl_opencover_arc SET SR_NO\=?, INTEREST \= ?, CONVEYANCE \= (SELECT distinct(TRANSPORT_DESCRIPTION) FROM MODE_OF_TRANSPORT MOT WHERE MODE_TRANSPORT_ID \= ? AND status \= 'Y' AND MOT.BRANCH_CODE\=?), COVER \= (SELECT distinct(COVER_NAME) FROM COVER_MASTER WHERE COVER_ID \= ? AND STATUS \= 'Y' AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= ?)), VOYAGE_FROM \= ?, VOYAGE_TO \= ?, CURRENCY \= ?, INCOTERMS \= (SELECT DISTINCT REGEXP_SUBSTR (Sale_Term_name, '[^+]+', 1, 1) FROM sale_term_master WHERE Branch_code \= ? AND rsacode \= ?), BASIS_OF_VALUATION \=( select SALE_TERM_NAME||TOLERANCE_NAME NAME from (select rownum rn,SALE_TERM_ID,SALE_TERM_NAME from sale_term_master where SALE_TERM_ID\=? and branch_code\=? and status\='Y') left outer join (select rownum rn1,tolerance_id,decode(TOLERANCE_NAME,'NONE','','+'||TOLERANCE_NAME) TOLERANCE_NAME from tolerance_master where tolerance_id\=? and branch_code\=? and status\='Y') on rn\=rn1), PACKAGE_DESCRIPTION \= ?, COMMODITY_DESCRIPTION \= ?, WSRCC\=?, VALIDATION_ERROR\=?, VALIDATION_STATUS\='', PACKING_DETAILS\='' WHERE TRANSACTION_ID\=? AND SNO \=?
GET_WARYN_OPENCOVER=select WRSC_YN from OPEN_COVER_MASTER where PROPOSAL_NO=(select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER where OPEN_COVER_NO=?)

#ADMIN BrokerManagement
GET_Broker_List=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,bcm.VAT_REG_NO,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) order by lower(bcm.COMPANY_NAME)
GET_Broker_Info=select lm.VAT_REG_NO, pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,pi.NATIONALITY,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id||country_id in( select max(amend_id)||country_id from country_master group by country_id) and COUNTRY_ID=pi.nationality) nationalityName,to_char(pi.DOB,'dd/mm/yyyy') DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(CASE WHEN to_char(pi.COUNTRY)='Y' then (select COUNTRY_NAME from country_master where (COUNTRY_NAME=pi.COUNTRY or COUNTRY_ID=pi.COUNTRY)) else pi.COUNTRY end) country_name, pi.POBOX,lm.company_name,lm.agency_code,pi.entry_date,lm.status,lm.ADDRESS3,lm.city,lm.BRANCH_CODE,lm.MISSIPPI_ID,lm.APPROVED_PREPARED_BY,lm.rsa_broker_code,log.login_id,lm.AC_EXECUTIVE_ID,PI.CUST_NAME,PI.CUST_AR_NO,log.LOGIN_ID,lm.customer_id,lm.ISSUER_COMMISSION_OPENCOVER, lm.ISSUER_COMMISSION_ONEOFF,LM.IMAGE_PATH from personal_info pi,broker_company_master lm,login_master log where log.agency_code=lm.agency_code and pi.agency_code=lm.agency_code and  pi.agency_code=? and lm.branch_code in(?)
GET_Commission_Data=select distinct(pm.product_name),lud.PRODUCT_ID,lud.COMMISSION,lud.INSURANCE_END_LIMIT,lud.SPECIAL_DISCOUNT,nvl(lm.REFERAL,'N') REFERAL,lud.status,nvl(lud.DISCOUNT_OF_PREMIUM,0) DISCOUNT_PREMIUM,lud.MIN_PREMIUM_AMOUNT,lud.BACK_DATE_ALLOWED,nvl(PRO_COMMISSION,'0'),to_char(PRO_START_DATE,'dd-mm-yyyy'),to_char(PRO_EXPIRY_DATE,'dd-mm-yyyy'),nvl(lud.LOADING_OF_PREMIUM,0) LOADING_PREMIUM,nvl(pay_receipt_status,'N') pay_receipt_status,nvl(receipt_status,'N') receipt_status,nvl(FREIGHT_DEBIT_OPTION,'Y') FREIGHT_DEBIT_OPTION ,nvl(PROVISION_FOR_PREMIUM,'N') PROVISION_FOR_PREMIUM, lm.referal REMARKS from login_master lm,login_user_details lud,product_master pm where lm.agency_code=lud.agency_code and lud.PRODUCT_ID=pm.product_id and  lud.agency_code=?
#GET_Products_Data=select PRODUCT_ID,PRODUCT_NAME,COMPANY_ID from product_master where status='Y' and COMPANY_ID not in (2) and branch_code in(?) order by product_id
GET_Branch_Detail=select BRANCH_CODE,BRANCH_NAME from BRANCH_MASTER where status='Y' and BRANCH_CODE in(?)
GET_Broker_Code=SELECT BROKER_CODE_SEQ.NEXTVAL FROM DUAL
GET_Emirates=select city_id,city_name  from city_master where country_id=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y' order by city_name
GET_Nationalities=select COUNTRY_ID,NATIONALITY_NAME from COUNTRY_MASTER where amend_id||country_id in( select max(amend_id)||country_id from country_master group by country_id) and NATIONALITY_NAME is not null order by NATIONALITY_NAME
#GET_Titles=select TITLE_ID,TITLE_NAME from TITLE_MASTER where branch_code=? and status='Y' order by TITLE_NAME
GET_Titles=select TITLE_ID,TITLE_NAME from TITLE_MASTER where branch_code=(SELECT BELONGING_BRANCH FROM BRANCH_MASTER BM WHERE BRANCH_CODE=? AND BM.STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM BRANCH_MASTER BM1 WHERE BM1.BRANCH_CODE=BM.BRANCH_CODE AND BM1.STATUS=BM.STATUS)) and status='Y' order by TITLE_NAME
GET_Executives=select distinct b.AC_EXECUTIVE_ID, b.AC_EXECUTIVE_NAME from LOGIN_EXECUTIVE_DETAILS b where b.status='Y'  and amend_id =(select max(a.amend_id)  from LOGIN_EXECUTIVE_DETAILS a where  a.AC_EXECUTIVE_ID=b.AC_EXECUTIVE_ID)order by b.AC_EXECUTIVE_NAME
INS_Broker_Det=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,agency_code,oa_code,CUST_NAME,CUST_AR_NO, LOGIN_ID)values(?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?)
GET_Core_Customer=SELECT CIMSNO,(CASE WHEN CUSTCODE IS NULL OR CUSTGRP IS NULL OR CUSTTYPE IS NULL OR CUSTCLAS IS NULL THEN '' ELSE (CUSTCODE ||'-'|| CUSTGRP ||'-'|| CUSTTYPE ||'-'||CUSTCLAS) END) ARACC, CUSTTITL,CUSTNAME,CUSTADD1,CUSTADD2,CUSTADD3,CUSTADD4 FROM C_CUST@ECARGO_PROD WHERE lower(CUSTNAME) LIKE '%'||lower(?)||'%' AND BRCODE=?
UPD_broker_password=UPDATE LOGIN_MASTER SET LPASS10=LPASS9,LPASS9=LPASS8,LPASS8=LPASS7,LPASS7=LPASS6,LPASS6=LPASS5,LPASS5=LPASS4,LPASS4=LPASS3,LPASS3=LPASS2,LPASS2=LPASS1,LPASS1=PASSWORD,PASSWORD=?,PASSDATE=SYSDATE+45,STATUS='Y' where agency_code=?
GET_Tax_Info=select nvl(POLICY_FEE_STATUS,'N') policy_feestatus,nvl(POLICY_FEE,'0') policy_fees,nvl(GOVT_TAX_STATUS,'N') gov_taxstatus,nvl(GOVT_TAX,'0') govt_tax,nvl(EMERGENCY_FUND_STATUS,'N') emergency_fundstatus,nvl(EMERGENCY_FUND,'0')emer_fund,to_char(EFFECTIVE_DATE,'dd/mm/yyyy') effec_date, TAX_APPLICABLE from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y' and AMEND_ID||AGENCY_CODE in(select max(nvl(AMEND_ID,'0'))||AGENCY_CODE from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y' group by AGENCY_CODE)
GET_Customer_Id=select nvl((max(current_no)+1),max(start_no)) from policyno_generate where type_id=3 and status='Y' and BRANCH_CODE=?
UPD_Customer_Id=update policyno_generate set CURRENT_NO=?, REMARKS=? where type_id=3 and status='Y' and BRANCH_CODE=?
INS_BCM_DET=insert into broker_company_master(AGENCY_CODE,COMPANY_NAME,CONTACT_PERSON,ADDRESS1,ADDRESS2,ADDRESS3,CITY,COUNTRY,PHONE,POBOX,FAX,EMIRATE,REMARKS,STATUS,CUSTOMER_ID,BRANCH_CODE,MISSIPPI_ID,APPROVED_PREPARED_BY,rsa_broker_code,AC_EXECUTIVE_ID, ISSUER_COMMISSION_ONEOFF, ISSUER_COMMISSION_OPENCOVER,IMAGE_PATH,VAT_REG_NO,CREATED_LOGIN,CREATED_DATE) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate)
GET_BRO_CODE=SELECT BROKER_CODE_SEQ.NEXTVAL FROM DUAL
GET_MAX_BRO_CODE=update policyno_generate set current_no=?,remarks=? where type_id=3 and status='Y' and BRANCH_CODE=?
GET_CUST_ID=select CUSTOMER_ID from broker_company_master where agency_code=? and branch_code=?
UPD_BROKER_DET=update  broker_company_master set COMPANY_NAME=?,CONTACT_PERSON=?,ADDRESS1=?,ADDRESS2=?,ADDRESS3=?,CITY=?,COUNTRY=?,PHONE=?,POBOX=?,FAX=?,EMIRATE=?,CUSTOMER_ID=?,BRANCH_CODE=?,MISSIPPI_ID=?,APPROVED_PREPARED_BY=?,RSA_BROKER_CODE=?,AC_EXECUTIVE_ID=?, ISSUER_COMMISSION_ONEOFF=?, ISSUER_COMMISSION_OPENCOVER=? ,IMAGE_PATH=? ,VAT_REG_NO=?, LAST_UPDATED_LOGIN = ?, LAST_UPDATED_DATE = SYSDATE where agency_code=? and branch_code=?
UPD_PERSONAL_INFO=update personal_info set title=?,first_name=?,last_name=?,nationality=?,dob=to_date(?,'dd/mm/yyyy'),gender=?,telephone=?,mobile=?,fax=?,email=?,address1=?,address2=?,occupation=?,pobox=?,country=?,emirate=?,status=?,effective_date=to_date(?,'dd/mm/yyyy'),CUST_NAME=?,CUST_AR_NO=?  where application_id=? and agency_code=?
GET_MAXAMEND_ID=select max(AMEND_ID) from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y'
INS_TAX_DET=insert into BROKER_MASTER(AGENCY_CODE,BRANCH_CODE,POLICY_FEE_STATUS,GOVT_TAX_STATUS,EMERGENCY_FUND_STATUS, POLICY_FEE,GOVT_TAX,EMERGENCY_FUND,STATUS,REMARKS,AMEND_ID,TAX_APPLICABLE,ENTRY_DATE,EFFECTIVE_DATE)values(?,?,?,?,?,?,?,?,'Y',?,?,?,sysdate,to_date(?,'dd/mm/yyyy'))
UPD_TAX_DET=update BROKER_MASTER set POLICY_FEE_STATUS=?, GOVT_TAX_STATUS=?, EMERGENCY_FUND_STATUS=?, POLICY_FEE=?, GOVT_TAX=?, EMERGENCY_FUND=?, TAX_APPLICABLE=?, EFFECTIVE_DATE=to_date(?,'dd/mm/yyyy')
#GET_COMMISSION_DET=select lud.PRODUCT_ID productId,DD.PRODUCT_NAME,lud.COMMISSION commission,lud.INSURANCE_END_LIMIT insurance_End_Limit,lm.USER_ID_CREATION,lm.AC_EXECUTIVE_CREATION,lm.REFERAL,lud.status,nvl(lud.DISCOUNT_OF_PREMIUM,0) discountPremium,lud.MIN_PREMIUM_AMOUNT min_Premium_Amount,lud.BACK_DATE_ALLOWED back_Date_Allowed,nvl(PRO_COMMISSION,'0'),to_char(PRO_START_DATE,'dd-mm-yyyy'),to_char(PRO_EXPIRY_DATE,'dd-mm-yyyy'),nvl(lud.LOADING_OF_PREMIUM,0) loadingPremium,nvl(pay_receipt_status,'N'),nvl(FREIGHT_DEBIT_OPTION,'Y') FREIGHT ,nvl(PROVISION_FOR_PREMIUM,'N') PROVISION from PRODUCT_MASTER DD, login_master lm,login_user_details lud where DD.PRODUCT_ID=LUD.PRODUCT_ID AND DD.BRANCH_CODE=? AND lm.agency_code=lud.agency_code and  lud.agency_code=? order by lud.product_id
#GET_PRODUCT_DET=select TRIM(PRODUCT_ID) PRODUCT_ID,PRODUCT_NAME,COMPANY_ID from product_master where status='Y' and branch_code in(?)
GET_PRODUCT_DET=select TRIM(PRODUCT_ID) PRODUCT_ID,PRODUCT_NAME,COMPANY_ID from product_master where status='Y' and branch_code =( select belonging_branch from branch_master bm where branch_code=?  AND STATUS='Y' and amend_id=(select max(amend_id) from branch_master bm1 where bm1.branch_code=bm.branch_code and bm1.status=bm.status))
GET_COMP_DET=select bcm.COMPANY_NAME, pi.FIRST_NAME FROM BROKER_COMPANY_MASTER bcm,PERSONAL_INFO pi where pi.AGENCY_CODE=bcm.AGENCY_CODE and pi.AGENCY_CODE=?
GET_MAXUSER_ID=select max(USER_ID)+1 from LOGIN_USER_DETAILS
INS_PRODUCT_DET=insert into login_user_details(USER_ID,USER_NAME,LOGIN_ID,AGENCY_CODE,OA_CODE, PRODUCT_ID,COMPANY_ID,COMMISSION,INSURANCE_START_LIMIT, INSURANCE_END_LIMIT,DISCOUNT_OF_PREMIUM,RELATIVE_USER_ID,AMEND_ID, INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS, CUSTOMER_ID,MIN_PREMIUM_AMOUNT,BACK_DATE_ALLOWED,Pro_commission, pro_start_date,pro_expiry_date,LOADING_OF_PREMIUM, PROVISION_FOR_PREMIUM,FREIGHT_DEBIT_OPTION,PAY_RECEIPT_STATUS, RECEIPT_STATUS, open_cover_no, SPECIAL_DISCOUNT,SCHEME_ID) values(?,?,(select LOGIN_ID from login_master where AGENCY_CODE=?),?,?,?,?,?,?,?,?,?,?,sysdate,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
UPD_PRODUCT_DET=update login_user_details set COMMISSION=?,INSURANCE_END_LIMIT=?,STATUS=?,DISCOUNT_OF_PREMIUM=?,MIN_PREMIUM_AMOUNT=? ,BACK_DATE_ALLOWED=?,LOADING_OF_PREMIUM=?,pay_receipt_status=?,FREIGHT_DEBIT_OPTION=?,PROVISION_FOR_PREMIUM=?, RECEIPT_STATUS=?, open_cover_no=?, SPECIAL_DISCOUNT=? where AGENCY_CODE=? and product_id=?
UPD_PRODUCT_DET_LM=update login_master set referal=? where AGENCY_CODE=?
INS_LOGIN_DET=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,CORE_LOGIN_ID, APP_ID, PWD_COUNT, USER_MAIL, CREATED_LOGIN, CREATED_DATE) values(?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate+45,?,?,?, '16', '0', ?,?,SYSDATE)
UPD_PERSONAL_LOGIN_ID=update personal_info set LOGIN_ID\=? where AGENCY_CODE\=? 
#GET_BROKER_STATUS = select status from login_master where agency_code=?
UPD_BROKER_STATUS_LM = update login_master set USERNAME=?, status=?, USER_MAIL=?, LAST_UPDATED_LOGIN = ?, LAST_UPDATED_DATE = SYSDATE where agency_code=?
UPD_BROKER_STATUS_BCM = update broker_company_master set status=? where agency_code=?
GET_MAIN_USER_INFO=SELECT lm.LOGIN_ID, lm.USERTYPE, lm.BRANCH_CODE, (select BRANCH_NAME from branch_master where STATUS='Y' and branch_code=lm.branch_code) BRANCH_NAME, lm.COUNTRY_ID, lm.MENU_ID FROM LOGIN_MASTER lm WHERE lm.LOGIN_ID=?
#GET_BROKER_LIST_BY_NAME=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.missippi_id,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND lower(bcm.COMPANY_NAME) like '%'||lower(?)||'%'  order by lower(bcm.COMPANY_NAME)
GET_BROKER_LIST_BY_NAME=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND lower(bcm.COMPANY_NAME) like '%'||lower(?)||'%'  order by lower(bcm.COMPANY_NAME)
#GET_BROKER_LIST_BY_CODE=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.missippi_id,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code\=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID\=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND bcm.missippi_id like '%'||?||'%'  order by lower(bcm.COMPANY_NAME)
GET_BROKER_LIST_BY_CODE=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code\=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID\=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND bcm.RSA_BROKER_CODE like '%'||?||'%'  order by lower(bcm.COMPANY_NAME)
GET_BROKER_LIST_BY_STATUS=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND bcm.STATUS = ?
BRANCH_BCODE_CNT = SELECT COUNT(*) FROM BROKER_COMPANY_MASTER WHERE RSA_BROKER_CODE=? AND BRANCH_CODE=?
BROKER_DELETE_LOGO = UPDATE BROKER_COMPANY_MASTER SET IMAGE_PATH='' WHERE AGENCY_CODE=?

##UnderWriter Management
INS_ISSUER_LOGIN_DET=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,CORE_LOGIN_ID, APP_ID, PWD_COUNT, USER_MAIL,PRODUCT_ID,ENTRY_DATE,FD_CODE,CREATED_DATE,CREATED_LOGIN) values(?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate+45,?,?,?, '16', '0', ?,?,SYSDATE,?,SYSDATE,?)
GET_ISSUER_LIST =select username COMPANY_NAME,USERTYPE,login_id,to_char(ENTRY_DATE,'dd/mm/yyyy') CR_DATE,DECODE (status,'Y','Active','N','DeActive', 'D','Delete','L','Locked') status from login_master where branch_code\=? and usertype\='RSAIssuer' 
#SELECT   NVL (per.first_name || '' || per.last_name, per.company_name) company_name,LOG.usertype,LOG.LOGIN_ID,per.application_id,per.agency_code,per.oa_code,DECODE (per.status,'Y','Active','N','DeActive','D','Delete','L','Locked')status,TO_CHAR (per.ENTRY_DATE, 'DD-MM-YYYY') cr_date,(SELECT DISTINCT (USERNAME)FROM login_master WHERE AGENCY_CODE = LOG.OA_CODE)brokerName FROM personal_info per, login_master LOG WHERE LOG.usertype = ? AND LOG.agency_code = per.agency_code AND LOG.login_id NOT IN ('NONE')AND LOG.branch_code = ?
GET_ISSUER_DETAIL =SELECT   broker_code,login_id,(SELECT   company_name FROM   broker_company_master bcm WHERE   bcm.AGENCY_CODE = broker_code) broker_name,lm.product_id,(select distinct(product_name) from product_master pm where pm.product_id=lm.product_id and branch_code=?) product_name,commission,TO_CHAR (START_DATE, 'DD/MM/YYYY') START_DATE,TO_CHAR (END_DATE, 'DD/MM/YYYY') END_DATE,TO_CHAR (START_DATE, 'dd'),TO_CHAR (START_DATE, 'MM'),TO_CHAR (START_DATE, 'YYYY'),TO_CHAR (END_DATE, 'dd'),TO_CHAR (END_DATE, 'MM'),TO_CHAR (END_DATE, 'YYYY'),status,TO_CHAR (CANCEL_DATE, 'dd'),TO_CHAR (CANCEL_DATE, 'MM'),TO_CHAR (CANCEL_DATE, 'YYYY'),type FROM LOGIN_RSAUSER_DETAILS lm WHERE  login_id = ? AND (amend_id || broker_code || product_id) IN (  SELECT   MAX (amend_id) || broker_code || product_id FROM   LOGIN_RSAUSER_DETAILS WHERE   login_id = ? GROUP BY   broker_code, product_id)ORDER BY   broker_Code, product_id
GET_INCLUDE_BROKER = SELECT broker_code,(select company_name from broker_company_master bcm where bcm.agency_code\=lm.broker_code) broker_name,product_id,(select distinct(product_name)from product_master pm where pm.product_id\=lm.product_id) product_name,TO_CHAR (START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR (END_DATE, 'DD/MM/YYYY') END_DATE,decode(status,'Y','ACTIVE','N','DEACTIVE') status FROM LOGIN_RSAUSER_DETAILS lm 
GET_EXCLUDE_BROKER = SELECT broker_code,(select company_name from broker_company_master bcm where bcm.agency_code=lm.broker_code) broker_name,product_id,(select distinct(product_name)from product_master pm where pm.product_id=lm.product_id) product_name,TO_CHAR (START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR (END_DATE, 'DD/MM/YYYY') END_DATE,decode(status,'Y','ACTIVE','N','DEACTIVE') status FROM LOGIN_RSAUSER_DETAILS lm WHERE TYPE=?
UPDATE_INCLUDE_BROKER =update LOGIN_RSAUSER_DETAILS set type=?,STATUS=? where BROKER_CODE =? and product_id =?
issuer.branch=select BRANCH_CODE CODE,BRANCH_NAME CODEDESC from rsa_branch_details  where branch_code in  (SELECT distinct(REGEXP_SUBSTR(RSA_BRANCH_CODE,'[^,]+',1,LEVEL)) lc_login FROM (select RSA_BRANCH_CODE from login_master where login_id\=?) B  CONNECT BY LEVEL <\= LENGTH(RSA_BRANCH_CODE) - LENGTH(REPLACE(RSA_BRANCH_CODE,',',''))+1) 
issuer.broker=select bcm.AGENCY_CODE CODE, bcm.COMPANY_NAME CODEDESC from broker_company_master bcm,login_master lm  where bcm.agency_code=lm.agency_code and upper(lm.usertype)=upper('Broker') and lm.branch_code=? and bcm.agency_code not in (select broker_code  from login_rsauser_details where login_id=? and branch_code=? and product_id=?)


#USER MANAGEMENT
GET_USER_LIST = select nvl(per.first_name||''||per.last_name,per.company_name)company_name,log.usertype,log.LOGIN_ID,per.application_id,per.agency_code,DECODE(per.status,'Y','Active','N','DeActive','D','DeActive','L','Locked') status,to_char(per.ENTRY_DATE,'DD-MM-YYYY') cr_date, (select company_name from broker_company_master where agency_code=log.OA_CODE) brokerName from personal_info per,login_master log where log.usertype\=? and log.agency_code\=per.agency_code and log.login_id not in('NONE')
GET_USER_INFO= SELECT LOGIN_ID,PASSWORD,USERTYPE, STATUS, PWD_COUNT FROM LOGIN_MASTER WHERE  LOGIN_ID \= ? AND PASSWORD \= ? AND APP_ID \= ? AND STATUS in ('T','Y')
GET_BROKER_USER_DETAILS=select pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id||country_id in( select max(amend_id)||country_id from country_master group by country_id) and COUNTRY_ID=pi.nationality) nationality_name, pi.NATIONALITY, to_char(pi.DOB,'dd/mm/yyyy') DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(select COUNTRY_NAME from country_master where COUNTRY_ID=pi.COUNTRY and AMEND_ID=(SELECT max(AMEND_ID) FROM country_master WHERE COUNTRY_ID=pi.COUNTRY)) country_name,pi.POBOX,lm.agency_code,pi.entry_date,pi.status,pi.city,lm.BRANCH_CODE,lm.login_id,(select COMPANY_NAME from broker_company_master where AGENCY_CODE=lm.OA_CODE) bname, lm.usertype, PI.CUST_NAME,PI.CUST_AR_NO,pi.customer_id, (select distinct(USERNAME) from login_master where  AGENCY_CODE=lm.OA_CODE)borganization, lm.OA_CODE from personal_info pi, login_master lm where pi.agency_code=lm.agency_code and pi.LOGIN_ID=lm.LOGIN_ID and  pi.agency_code=?
#GET_OPENCOVER_CERTIFICAE=select distinct(ocpm.open_cover_no),ocpm.proposal_no,ocm.MISSIPPI_OPENCOVER_NO,ocpm.Customer_Schedule,ocpm.Customer_Debit,ocpm.Customer_CustomerDebit,nvl(pi.company_name,pi.first_name) name from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in(select distinct LOGIN_ID from login_user_details where agency_code=?) and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no  group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
GET_OPENCOVER_CERTIFICAE=select NVL (ocpm.ORIGINAL_POLICY_NO, ocpm.OPEN_COVER_NO) OPEN_COVER_NO,ocpm.proposal_no,ocm.MISSIPPI_OPENCOVER_NO,ocpm.Customer_Schedule,ocpm.Customer_Debit,ocpm.Customer_CustomerDebit,nvl(pi.company_name,pi.first_name) name from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in(select distinct LOGIN_ID from login_user_details where agency_code=?) and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no AND ocpm.amend_id = (SELECT   Max (amend_id) FROM   open_cover_position_master oc WHERE NVL (oc.ORIGINAL_POLICY_NO, oc.OPEN_COVER_NO) = NVL (ocpm.ORIGINAL_POLICY_NO, ocpm.OPEN_COVER_NO) and oc.status = 'P') and pi.customer_id=ocm.customer_id and pi.status='Y' and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no  group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
GET_USER_AGENCYCODE=select detail_name from constant_detail where CATEGORY_ID=37 and CATEGORY_DETAIL_ID=1 and status='Y' and branch_code=?
INS_USER_PERSONAL_INFO=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,login_id,AGENCY_CODE,OA_CODE,city,fd_code)values(?,?,?,?,?,?,?, to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?)
#INS_USER_LOGIN_MASTER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,ACCESSTYPE,RIGHTS,LPASS1,LPASS2,LPASS3,PASSDATE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,REFERAL, APP_ID, PWD_COUNT, USER_MAIL) values(?,?,?,?,?,?,?,?,?,?,?,?,sysdate+45,?,?,?,?,?,?,'16','0',?)
INS_USER_LOGIN_MASTER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,ACCESSTYPE,RIGHTS,LPASS1,LPASS2,LPASS3,PASSDATE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,REFERAL, APP_ID, PWD_COUNT, USER_MAIL, branch_code, COUNTRY_ID,CREATED_LOGIN,CREATED_DATE) values(?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?,?,'16','0',?,?,?,?,SYSDATE)
UPD_USER_PERSONAL_INFO=update personal_info set title=?, first_name=?, last_name=?, nationality=?, dob=to_date(?,'dd/mm/yyyy'), gender=?, telephone=?, mobile=?, fax=?, email=?, address1=?, address2=?, occupation=?, pobox=?, country=?, emirate=?, status=?, city=? where agency_code=?
UPD_USER_LOGIN_MASTER=update login_master set USERNAME=?, STATUS=?, USER_MAIL=?, LAST_UPDATED_LOGIN = ?, LAST_UPDATED_DATE = SYSDATE where AGENCY_CODE=?
UPD_USER_AGENCYCODE=update constant_detail set detail_name=? where CATEGORY_ID=37 and CATEGORY_DETAIL_ID=1 and status='Y' and branch_code=?
#GET_USER_COMMISSION=select pm.product_name uproductName, pm.product_id uproductId, lud.SPECIAL_DISCOUNT specialDis, lud.FREIGHT_DEBIT_OPTION freight, lud.INSURANCE_END_LIMIT insEndLimit, lud.pay_receipt_status receipt, lud.open_cover_no, decode(lud.login_id,null,'N','Y') product from PRODUCT_MASTER pm left outer join LOGIN_USER_DETAILS lud on PM.PRODUCT_ID = LUD.PRODUCT_ID and LUD.AGENCY_CODE = ? and LUD.OA_CODE = ? where PM.BRANCH_CODE = ?
GET_USER_COMMISSION=select pm.product_name uproductName, pm.product_id uproductId, lud.SPECIAL_DISCOUNT specialDis, lud.FREIGHT_DEBIT_OPTION freight, lud.INSURANCE_END_LIMIT insEndLimit, lud.pay_receipt_status receipt, lud.open_cover_no, decode(lud.login_id,null,'N',lud.status) product from PRODUCT_MASTER pm left outer join LOGIN_USER_DETAILS lud on PM.PRODUCT_ID = LUD.PRODUCT_ID and LUD.AGENCY_CODE = ? and LUD.OA_CODE = ? where PM.BRANCH_CODE = (SELECT BELONGING_BRANCH FROM BRANCH_MASTER WHERE BRANCH_CODE=?)
GET_EXIST_PRODUCT_COUNT=select count(*) from LOGIN_USER_DETAILS where PRODUCT_ID\=? and AGENCY_CODE\=?

#CUSTOMER MANAGEMENT
#GET_CUSTOMER_LIST=SELECT (FIRST_NAME || company_name) company_name, NVL (CUSTOMER_LOGIN_ID, ''), (select distinct(COMPANY_NAME) from BROKER_COMPANY_MASTER where agency_code=oa_code) broker_name, NVL (TO_CHAR (ENTRY_DATE, 'DD-MM-YYYY'), ' ') ENTRY_DATE,  NVL (agency_code, '0'), NVL (fd_code, '0') EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME, EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, CUST_AR_NO, REPLACE ('P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE, ' '), 'select', '') ADDRESS FROM PERSONAL_INFO WHERE APPLICATION_ID = '1' AND LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE
GET_CUSTOMER_LIST=SELECT (FIRST_NAME || company_name) company_name, NVL (CUSTOMER_LOGIN_ID, ''), (select distinct(COMPANY_NAME) from BROKER_COMPANY_MASTER where agency_code=oa_code) broker_name, NVL (TO_CHAR (ENTRY_DATE, 'DD-MM-YYYY'), ' ') ENTRY_DATE,  NVL (agency_code, '0'), NVL (fd_code, '0') EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME, EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, CUST_AR_NO, REPLACE ('P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE, ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI WHERE APPLICATION_ID = '1' AND LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE
GET_CUSTOMER_INFO=select * from personal_info where customer_id=?
GET_OPEN_COVER_LIST_CUSTOMER=select distinct(a.proposal_no),nvl(a.open_cover_no,'0') open_cover_no, DECODE(a.STATUS,'Y','Quote','P','Policy') STATUS, nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD-MM-YYYY'),' ') pol_start_date,nvl(to_char(b.policy_end_date,'DD-MM-YYYY'),' ') pol_expire_date,nvl(first_name,company_name) name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status\='Y' and a.original_policy_no is null and a.proposal_no \= b.proposal_no and b.amend_id \= (select max(amend_id) from open_cover_master b where b.proposal_no \= a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id\=(select distinct LOGIN_ID from login_user_details where agency_code\=?)) and c.customer_id \=b.customer_id and b.customer_id\=?

#Open Cover
GET_OPENCOVER_LIST=select distinct(a.proposal_no),nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD-MM-YYYY'),' '),nvl(to_char(b.policy_end_date,'DD-MM-YYYY'),' '),nvl(first_name,company_name) name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status\='Y' and a.original_policy_no is null and a.proposal_no \= b.proposal_no and b.amend_id \= (select max(amend_id) from open_cover_master b where b.proposal_no \= a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id\=(select distinct LOGIN_ID from login_user_details where agency_code\=?)) and c.customer_id \=b.customer_id order by a.proposal_no desc

#Referal Cases
GET_OCLIST_PENDING=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date from position_master a,marine_data b, personal_info c where c.CUSTOMER_ID=a.CUSTOMER_ID and ((a.REMARKS in ('Referal') and b.ADMIN_REFERRAL_STATUS='N') or (a.REMARKS in ('Admin','Normal','NORMAL_EXCESS_PRICE') and b.ADMIN_REFERRAL_STATUS='Y')) and a.status in ('Y','E') and a.product_id in(?) and  a.application_no=b.application_no and a.FREIGHT_STATUS is null and trunc(a.entry_date) between trunc(sysdate-60) and trunc(sysdate) and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_PENDING=SELECT TO_CHAR(A.ENTRY_DATE,'YYYY-MM-DD') ENTERY_DATE,COUNT(A.ENTRY_DATE) COUNT_ENTERY_DATE FROM HOME_POSITION_MASTER A WHERE A.REMARKS\= 'Referal' AND A.STATUS IN ('Y','E') AND A.PRODUCT_ID\=? AND A.LOGIN_ID IN(SELECT LOGIN_ID FROM LOGIN_MASTER WHERE  
GET_OCLIST_APPROVED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date,sum(nvl(b.premium,'0')+nvl(b.excess_premium,'0')) premium from position_master a,marine_data b, personal_info c where c.CUSTOMER_ID=a.CUSTOMER_ID and a.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and a.application_no=b.application_no and b.ADMIN_REFERRAL_STATUS='N' and a.product_id in (?) and a.status  in('Y','E')  and a.FREIGHT_STATUS is null and trunc(a.entry_date) between trunc(sysdate-60) and trunc(sysdate) and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_APPROVED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date,sum(a.OVERALL_PREMIUM) PREMIUM  from home_position_master a where a.REMARKS='Admin' and a.status in('Y','E')  and a.product_id =? and a.login_id in(select login_id from login_master where
GET_OCLIST_REJECTED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date from position_master a, personal_info c where c.CUSTOMER_ID\=a.CUSTOMER_ID and a.status \= 'R' and a.product_id \=? and a.FREIGHT_STATUS is null and trunc(a.entry_date) between trunc(sysdate-60) and trunc(sysdate) and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_REJECTED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.EFFECTIVE_DATE) count_entery_date from home_position_master a where ADMIN_REFERRAL_STATUS='N' and a.status='R'  and a.product_id=?  and a.login_id in(select login_id from login_master where
GET_POLICIES_LIST=select pm.application_no,(select nvl(a.first_name,b.COMPANY_NAME) from personal_info a,broker_company_master b,login_master c where (a.login_id in(select login_id from login_master where oa_code in(select oa_code from login_master where login_id\=pm.login_id) and usertype\='Broker') or a.customer_login_id in(select login_id from login_master where oa_code in(select oa_code from login_master where login_id\=pm.login_id) and usertype\='Broker'))  and b.agency_code\=c.agency_code and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))) broker_name,(select nvl(first_name,COMPANY_NAME) from personal_info where customer_id\=(select customer_id from position_master where application_no\=pm.application_no)) customer_name, pm.login_id,pm.quote_no,md.remarks,pm.application_id,PM.STATUS from position_master pm,marine_data md where to_char(pm.entry_date,'DD-MM-YYYY')\=? and pm.application_no\=md.application_no and pm.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and md.ADMIN_REFERRAL_STATUS\='N' and pm.product_id\=? and pm.status in('Y','E') and pm.FREIGHT_STATUS is null and pm.login_id in(select login_id from login_master where
GET_POLICIES_PENDING=select decode(pm.application_id,'1',pm.login_id,pm.application_id) quote_Created,pm.application_no,pm.login_id,pm.quote_no,b.remarks,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID, c.CUST_NAME,d.COMPANY_NAME brokername from position_master pm,marine_data b, personal_info c, broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and to_char(pm.entry_date,'YYYY-MM-DD')=? and ((pm.REMARKS in ('Referal') and b.ADMIN_REFERRAL_STATUS='N') or (pm.REMARKS in ('Admin','Normal','NORMAL_EXCESS_PRICE') and b.ADMIN_REFERRAL_STATUS='Y')) and pm.status in ('Y','E') and pm.product_id in(?) and  pm.application_no=b.application_no and pm.FREIGHT_STATUS is null AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_PENDING=select distinct pm.application_no,pm.login_id,pm.quote_no,pm.remarks,pm.REFERRAL_DESCRIPTION,nvl(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status,c.CUSTOMER_ID, nvl(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID  from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.product_id=? and pm.REMARKS='Referal'  and pm.status in('Y','E') and pm.login_id in(select login_id from login_master where
GET_POLICIES_APPROVED=select decode(pm.application_id,'1',pm.login_id,pm.application_id) quote_Created,pm.application_no,pm.login_id,pm.quote_no,md.remarks,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID, c.CUST_NAME, d.COMPANY_NAME brokername from position_master pm,marine_data md, personal_info c,broker_company_master d  where c.CUSTOMER_ID=pm.CUSTOMER_ID and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.application_no=md.application_no and pm.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and md.ADMIN_REFERRAL_STATUS='N' and pm.product_id=? and pm.status in('Y','E') and pm.FREIGHT_STATUS is null AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_APPROVED=select distinct pm.application_no,pm.login_id,pm.quote_no,pm.remarks,pm.REFERRAL_DESCRIPTION,nvl(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status,c.CUSTOMER_ID, nvl(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.product_id=? and pm.REMARKS='Admin' and pm.status in ('Y','E') and pm.login_id in(select login_id from login_master where
GET_POLICIES_REJECTED=select decode(pm.application_id,'1',pm.login_id,pm.application_id) quote_Created,pm.application_no,pm.login_id,pm.quote_no,md.remarks,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID,c.CUST_NAME, d.COMPANY_NAME brokername from position_master pm,marine_data md, personal_info c,broker_company_master d  where c.CUSTOMER_ID=pm.CUSTOMER_ID and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.application_no=md.application_no  and pm.product_id=? and pm.status='R' AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_REJECTED=select distinct pm.application_no,pm.login_id,pm.quote_no,PM.remarks,pm.REFERRAL_DESCRIPTION,nvl(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID,nvl(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID  from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.product_id=? and pm.ADMIN_REFERRAL_STATUS='N' and pm.status='R' and pm.login_id in(select login_id from login_master where

#Open Cover
GET_QUOTE_REGISTER_LIST=select distinct(a.proposal_no),nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD/MM/YYYY'),' ') start_date,nvl(to_char(b.policy_end_date,'DD/MM/YYYY'),' ') end_date,nvl(first_name,company_name) cust_name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status='Y' and a.original_policy_no is null and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id=?) and c.customer_id =b.customer_id order by a.proposal_no desc
GET_PORTFOLIO_LIST=select to_char(a.entry_date,'MM/DD/YYYY')ENTRY_DATE,count(a.entry_date)as COU from position_master a,marine_data b,personal_info c where  a.entry_date between to_date(?,'MM/DD/YYYY') and to_date(?,'MM/DD/YYYY') and a.remarks in (?) and (b.ADMIN_REFERRAL_STATUS in(?) or b.ADMIN_REFERRAL_STATUS is null) and a.customer_id\=c.customer_id and a.application_no\=b.application_no  and  a.product_id in (11,3) and lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))  group by to_char(a.entry_date,'MM/DD/YYYY') order by to_char(a.entry_date,'MM/DD/YYYY') desc
GET_LCDETAIL_LIST=select A.OPEN_COVER_NO, A.BANK_ID,(SELECT DISTINCT(BANK_NAME) FROM OPEN_COVER_BANK_MASTER WHERE A.BANK_ID=BANK_ID AND STATUS='Y') bank_name, A.LC_NUMBER, TO_CHAR(A.LC_DATE,'DD/MM/YYYY') LC_DATE, A.LC_AMOUNT, TO_CHAR(A.ENTRY_DATE,'DD/MM/YYYY') ENTRY_DATE, TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE, TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE, A.AMEND_ID, A.REMARKS, A.STATUS, A.LC_ID, A.LC_CURRENCY_ID, (select currency_name from currency_master where currency_id=A.LC_CURRENCY_ID and status='Y' and amend_id=(select max(amend_id) from currency_master where currency_id=A.LC_CURRENCY_ID and COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y')) currency_name from OPEN_COVER_LC_MASTER A where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
GET_UNDERWRITER_LIST=select login_id, username from login_master where usertype = 'RSAIssuer' and status = 'Y' and branch_code=?

#REPORTS
GET_COMMODITY_LIST=select commodity_name, commodity_id  from commoditymaster cm where cm.status in ('Y','R') and cm.branch_code=? and cm.amend_id||'-'||cm.commodity_id in(select max(amend_id)||'-'||commodity_id from commoditymaster where to_date(effective_date,'dd/mm/yyyy') <=to_date(SYSDATE,'dd/mm/yyyy') and status in ('Y','R') and branch_code=? group by commodity_id) order by cm.commodity_id
GET_TRANSPORT_MODE_LIST=select transport_description, mode_transport_id from mode_of_transport where status = 'Y' and branch_code=?
GET_COVER_LIST=select cover_id,cover_name,mode_transport_id from cover_master where status = 'Y' and branch_code=? and mode_transport_id in(select mode_transport_id from mode_of_transport where status = 'Y' and branch_code=?)

#LC Master
#GET_LCNUMBER_OC_COUNT=select * from (select count(oclm.LC_NUMBER) lc_number_count,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and oclm.LC_NUMBER!='NONE' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by pi.login_id) a right outer join (select count(distinct(ocpm.open_cover_no)) open_cover_count, bcm.company_name,pi.login_id login_id_1 from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by bcm.company_name,pi.login_id ) b on a.login_id=b.login_id_1
#GET_LCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') inception_date, TO_CHAR (ocpm.expiry_date, 'dd/MM/YYYY') expiry_date, NVL (pi.COMPANY_NAME, pi.first_name)||ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, NVL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and oclm.LC_NUMBER!='NONE' and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code =? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id || '-' || ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) || '-' || ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no)
#GET_OCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), oclm.LC_NUMBER, ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') inception_date, TO_CHAR (ocpm.expiry_date, 'dd/MM/YYYY') expiry_date, NVL (pi.COMPANY_NAME, pi.first_name)||ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, NVL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code = ? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id || '-' || ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) || '-' || ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no)
#GET_LCOC_DETAILS_LIST=select A.OPEN_COVER_NO,((SELECT EXCHANGE_RATE  FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND amend_id = (SELECT MAX (amend_id) FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID))*A.LC_AMOUNT)-A.LC_BALANCE_AMOUNT used_amt, ((SELECT EXCHANGE_RATE  FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND amend_id = (SELECT MAX (amend_id) FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID))*A.LC_AMOUNT) ACTUAL_AMT, A.BANK_ID,(SELECT DISTINCT (BANK_NAME) FROM   OPEN_COVER_BANK_MASTER WHERE   A.BANK_ID = BANK_ID AND STATUS = 'Y') bank_name,A.LC_NUMBER,to_char(A.LC_DATE,'dd/mm/yyyy') LC_DATE,A.LC_AMOUNT,A.ENTRY_DATE,to_char(A.EXPIRY_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.EFFECTIVE_DATE,A.AMEND_ID,A.REMARKS,A.STATUS,A.LC_ID,A.LC_CURRENCY_ID, A.LC_BALANCE_AMOUNT, (SELECT currency_name FROM currency_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y'  AND amend_id = (SELECT MAX (amend_id) FROM currency_master WHERE currency_id = A.LC_CURRENCY_ID AND COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER WHERE   BRANCH_CODE =?) AND status = 'Y'))currency_name from OPEN_COVER_LC_MASTER A  where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
#GET_LCOC_DETAILS_LIST=SELECT   A.OPEN_COVER_NO, ( (SELECT   EXCHANGE_RATE FROM   exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER WHERE   BRANCH_CODE =?) AND amend_id = (SELECT   MAX (amend_id) FROM   exchange_master WHERE   currency_id = A.LC_CURRENCY_ID )) * A.LC_AMOUNT) - A.LC_BALANCE_AMOUNT used_amt, ((SELECT EXCHANGE_RATE FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER WHERE   BRANCH_CODE = ?) AND amend_id = (SELECT   MAX (amend_id) FROM   exchange_master WHERE   currency_id = A.LC_CURRENCY_ID)) * A.LC_AMOUNT) ACTUAL_AMT, A.BANK_ID, (SELECT   DISTINCT (BANK_NAME) FROM   OPEN_COVER_BANK_MASTER WHERE   A.BANK_ID = BANK_ID AND STATUS = 'Y') bank_name, A.LC_NUMBER, TO_CHAR (A.LC_DATE, 'dd/mm/yyyy') LC_DATE, A.LC_AMOUNT, A.ENTRY_DATE, TO_CHAR (A.EXPIRY_DATE, 'dd/mm/yyyy') EXPIRY_DATE, A.EFFECTIVE_DATE, A.AMEND_ID, A.REMARKS, A.STATUS, A.LC_ID, A.LC_CURRENCY_ID, A.LC_BALANCE_AMOUNT, (SELECT   currency_name FROM   currency_master WHERE   currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND COUNTRY_ID =(SELECT   ORIGINATION_COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE = ?) AND amend_id = (SELECT   MAX (amend_id) FROM   currency_master WHERE   currency_id = A.LC_CURRENCY_ID)) currency_name FROM OPEN_COVER_LC_MASTER A WHERE A.OPEN_COVER_NO=? AND A.LC_NUMBER NOT IN ('None', 'NONE')
#GET_Bank_List=select bank_id,bank_name,amend_id from open_cover_bank_master where amend_id||'-'||bank_id in (select max(amend_id)||'-'||bank_id from open_cover_bank_master where to_date(effective_date,'dd-mm-yyyy')<=to_date(SYSDATE,'dd-mm-yyyy') and status in('N','Y') and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) group by bank_id) and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y' and bank_id not in ('99999') order by bank_name
#GET_SALE_LIST=select sale_term_id, sale_term_name from sale_term_master where status='Y' and BRANCH_CODE=? order by sale_term_name
#GET_CURRENCY_LIST=select distinct(b.currency_id),b.currency_name,a.amend_id,a.effective_date,a.exchange_rate from exchange_master a, currency_master b where a.COUNTRY_ID=b.COUNTRY_ID and b.COUNTRY_ID='1' and a.currency_id=b.currency_id and a.amend_id||a.exchange_id||a.currency_id in(select max(amend_id)||exchange_id||currency_id from exchange_master where effective_date <=SYSDATE and status='Y' and COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) group by exchange_id,currency_id)  and a.effective_date <=SYSDATE and a.status='Y' and b.status='Y' and b.status='Y' and a.status='Y'
#INS_LCNEW_VALUE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE,EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS,open_cover_no,lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),SYSDATE,SYSDATE,TO_DATE(?,'dd/mm/yyyy'),?,?,?,(select nvl(max(lc_id),'0')+1 lc_id from open_cover_lc_master where open_cover_No=?),?,?,?,?)
#UPD_LCNEW_VALUE= update open_cover_lc_master set lc_amount=?,bank_id=?,AMEND_ID=?,LC_DATE=TO_DATE(?,'dd-mm-yyyy hh24:mi:ss'),EXPIRY_DATE=TO_DATE(?,'dd-mm-yyyy hh24:mi:ss'),EFFECTIVE_DATE=SYSDATE,ENTRY_DATE=SYSDATE,lc_currency_id=?,status=?,LC_BALANCE_AMOUNT=?,LC_ACTUAL_AMOUNT=?,LC_SALE_TERM_ID=? where open_cover_NO=? and lc_number=? and lc_id=?
#GET_SALETERM_VALUE=select sale_term_value from sale_term_master where sale_term_id=? and branch_code=? and status='Y'
#GET_EXCHANGE_RATE=select nvl(exchange_rate,'0') from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=? and amend_id=(select max(amend_id) from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=?)
#GET_COUNTRY_ID=select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?
#GET_LCINFO_LIST=select lc_number,lc_amount,bank_id, to_char(LC_DATE,'dd/mm/yyyy') LC_DATE, to_char(Expiry_DATE,'dd/mm/yyyy') Expiry_DATE, lc_id, lc_currency_id, LC_SALE_TERM_ID, status from open_cover_lc_master where open_cover_No=? and lc_id=? and lc_number=?
#DEL_LC_NUMBER=delete from OPEN_COVER_LC_MASTER where OPEN_COVER_NO\=? and lc_number\=? and LC_ID\=?

#LC Master New 
GET_LCNUMBER_OC_COUNT=select * from (select count(oclm.LC_NUMBER) lc_number_count,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and oclm.LC_NUMBER!='NONE' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by pi.login_id) a right outer join (select count(distinct(ocpm.open_cover_no)) open_cover_count, bcm.company_name,pi.login_id login_id_1 from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by bcm.company_name,pi.login_id ) b on a.login_id=b.login_id_1
GET_LCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') inception_date, TO_CHAR (ocpm.expiry_date, 'dd/MM/YYYY') expiry_date, NVL (pi.COMPANY_NAME, pi.first_name)||ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, NVL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and oclm.LC_NUMBER!='NONE' and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code =? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id || '-' || ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) || '-' || ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no)
#GET_OCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), oclm.LC_NUMBER, ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') inception_date, TO_CHAR (ocpm.expiry_date, 'dd/MM/YYYY') expiry_date, NVL (pi.COMPANY_NAME, pi.first_name)||ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, NVL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code = ? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id || '-' || ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) || '-' || ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no)
GET_OCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') inception_date, TO_CHAR (ocpm.expiry_date, 'dd/MM/YYYY') expiry_date, NVL (pi.COMPANY_NAME, pi.first_name)||ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, NVL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code = ? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id || '-' || ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) || '-' || ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no) order by inception_date desc
#GET_LCOC_DETAILS_LIST=select A.OPEN_COVER_NO,((SELECT EXCHANGE_RATE  FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND amend_id = (SELECT MAX (amend_id) FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID))*A.LC_AMOUNT)-A.LC_BALANCE_AMOUNT used_amt, ((SELECT EXCHANGE_RATE  FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND amend_id = (SELECT MAX (amend_id) FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID))*A.LC_AMOUNT) ACTUAL_AMT, A.BANK_ID,(SELECT DISTINCT (BANK_NAME) FROM   OPEN_COVER_BANK_MASTER WHERE   A.BANK_ID = BANK_ID AND STATUS = 'Y') bank_name,A.LC_NUMBER,to_char(A.LC_DATE,'dd/mm/yyyy') LC_DATE,A.LC_AMOUNT,A.ENTRY_DATE,to_char(A.EXPIRY_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.EFFECTIVE_DATE,A.AMEND_ID,A.REMARKS,A.STATUS,A.LC_ID,A.LC_CURRENCY_ID, A.LC_BALANCE_AMOUNT, (SELECT currency_name FROM currency_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y'  AND amend_id = (SELECT MAX (amend_id) FROM currency_master WHERE currency_id = A.LC_CURRENCY_ID AND COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER WHERE   BRANCH_CODE =?) AND status = 'Y'))currency_name from OPEN_COVER_LC_MASTER A  where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
GET_LCOC_DETAILS_LIST=select A.OPEN_COVER_NO,round(((SELECT EXCHANGE_RATE  FROM exchange_master em WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND em.country_id = (select country_id from branch_master where branch_code=?) AND amend_id = (SELECT MAX (amend_id) FROM exchange_master em1 WHERE currency_id = A.LC_CURRENCY_ID and em1.country_id=em.country_id))*A.LC_AMOUNT)-A.LC_BALANCE_AMOUNT) used_amt,round(((SELECT EXCHANGE_RATE  FROM exchange_master em WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND em.country_id = (select country_id from branch_master where branch_code=?) AND amend_id = (SELECT MAX (amend_id) FROM exchange_master em1 WHERE currency_id = A.LC_CURRENCY_ID and em1.country_id=em.country_id))*A.LC_AMOUNT)) ACTUAL_AMT, A.BANK_ID,(SELECT DISTINCT (BANK_NAME) FROM   OPEN_COVER_BANK_MASTER WHERE   A.BANK_ID = BANK_ID AND STATUS = 'Y') bank_name,A.LC_NUMBER,to_char(A.LC_DATE,'dd/mm/yyyy') LC_DATE,A.LC_AMOUNT,A.ENTRY_DATE,to_char(A.EXPIRY_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.EFFECTIVE_DATE,A.AMEND_ID,A.REMARKS,A.STATUS,A.LC_ID,A.LC_CURRENCY_ID, A.LC_BALANCE_AMOUNT, (SELECT currency_name FROM currency_master cm WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER WHERE   BRANCH_CODE =?)  AND amend_id = (SELECT MAX (amend_id) FROM currency_master cm1 WHERE currency_id = A.LC_CURRENCY_ID AND cm1.COUNTRY_ID =cm.COUNTRY_ID AND status = 'Y'))currency_name from OPEN_COVER_LC_MASTER A  where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
GET_Bank_List=select bank_id,bank_name,amend_id from open_cover_bank_master where amend_id||'-'||bank_id in (select max(amend_id)||'-'||bank_id from open_cover_bank_master where to_date(effective_date,'dd-mm-yyyy')<=to_date(SYSDATE,'dd-mm-yyyy') and status in('N','Y') and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) group by bank_id) and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y' and bank_id not in ('99999') order by bank_name
GET_SALE_LIST=select sale_term_id, sale_term_name from sale_term_master where status='Y' and BRANCH_CODE=? order by sale_term_name
#GET_CURRENCY_LIST=select distinct(b.currency_id),b.currency_name,a.amend_id,a.effective_date,a.exchange_rate from exchange_master a, currency_master b where a.COUNTRY_ID=b.COUNTRY_ID and b.COUNTRY_ID='1' and a.currency_id=b.currency_id and a.amend_id||a.exchange_id||a.currency_id in(select max(amend_id)||exchange_id||currency_id from exchange_master where effective_date <=SYSDATE and status='Y' and COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) group by exchange_id,currency_id)  and a.effective_date <=SYSDATE and a.status='Y' and b.status='Y' and b.status='Y' and a.status='Y'
GET_CURRENCY_LIST=select distinct(b.currency_id),b.currency_name,a.amend_id,a.effective_date,a.exchange_rate from exchange_master a, currency_master b where a.COUNTRY_ID=b.COUNTRY_ID and b.COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and a.currency_id=b.currency_id and a.amend_id||a.exchange_id||a.currency_id in(select max(amend_id)||exchange_id||currency_id from exchange_master where effective_date <=SYSDATE and status='Y' and COUNTRY_ID=b.COUNTRY_ID group by exchange_id,currency_id)  and a.effective_date <=SYSDATE and a.status='Y' and b.status='Y' and b.status='Y' and a.status='Y' order by currency_name
#INS_LCNEW_VALUE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE,EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS,open_cover_no,lc_id,lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,TO_DATE(?,'mm/dd/yyyy'),SYSDATE,SYSDATE,TO_DATE(?,'mm/dd/yyyy'),?,?,?,(select nvl(max(lc_id),'0')+1 lc_id from open_cover_lc_master where open_cover_No=?),?,?,?,?)
INS_LCNEW_VALUE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE,EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS,open_cover_no,lc_id,lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,TO_DATE(?,'mm/dd/yyyy'),SYSDATE,SYSDATE,TO_DATE(?,'mm/dd/yyyy'),?,?,?,(select nvl(max(lc_id),'0')+1 lc_id from open_cover_lc_master where open_cover_No=? and LC_ID!='99999'),?,?,?,?)
UPD_LCNEW_VALUE= update open_cover_lc_master set lc_amount=?,bank_id=?,AMEND_ID=?,LC_DATE=TO_DATE(?,'mm/dd/yyyy'),EXPIRY_DATE=TO_DATE(?,'mm/dd/yyyy'),EFFECTIVE_DATE=SYSDATE,ENTRY_DATE=SYSDATE,lc_currency_id=?,status=?,LC_BALANCE_AMOUNT=?,LC_ACTUAL_AMOUNT=?,LC_SALE_TERM_ID=? where open_cover_NO=? and lc_number=? and lc_id=?
GET_EXCHANGE_RATE=select nvl(exchange_rate,'0') from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=? and amend_id=(select max(amend_id) from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=?)
GET_COUNTRY_ID=select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?
GET_LCINFO_LIST=select lc_number,lc_amount,bank_id, to_char(LC_DATE,'mm/dd/yyyy') LC_DATE, to_char(Expiry_DATE,'mm/dd/yyyy') Expiry_DATE, lc_id, lc_currency_id, LC_SALE_TERM_ID, status,LC_ACTUAL_AMOUNT from open_cover_lc_master where open_cover_No=? and lc_id=? and lc_number=?
DEL_LC_NUMBER=delete from OPEN_COVER_LC_MASTER where OPEN_COVER_NO\=? and lc_number\=? and LC_ID\=?
 

##Admin Management
GET_MENU_LIST=select A.CATEGORY_DETAIL_ID, A.DETAIL_NAME, A.REMARKS, A.STATUS, DECODE(STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS1, (select DETAIL_NAME from CONSTANT_DETAIL where A.PARENT_MENU= to_char(CATEGORY_DETAIL_ID) AND CATEGORY_ID='41' and BRANCH_CODE=A.BRANCH_CODE) PARENT_MENU_NAME, PARENT_MENU from CONSTANT_DETAIL A where CATEGORY_ID='41' and BRANCH_CODE=?
#GET_MENU_LIST=select A.menu_id CATEGORY_DETAIL_ID, A.menu_name DETAIL_NAME, A.menu_url REMARKS, A.STATUS, DECODE(STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS1, (select menu_name from menu_master where A.PARENT_MENU=menu_id and BRANCH_CODE=A.BRANCH_CODE) PARENT_MENU_NAME, PARENT_MENU from menu_master A where BRANCH_CODE=?
GET_UTYPE_LIST=select category_detail_id,detail_name from constant_detail where category_id=40 and status='Y' and branch_code=? and remarks=?
#GET_ADMIN_LIST=select a.LOGIN_ID, a.USERNAME, a.USERID,(select detail_name from constant_detail where category_id=40 and status='Y' and branch_code=a.branch_code and remarks=? and category_detail_id=a.USERID) userType, a.BRANCH_CODE, (select BRANCH_NAME from branch_master where a.BRANCH_CODE=BRANCH_CODE) branch_name , STATUS, DECODE(STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS1, TRIM(A.PRODUCT_ID) PRODUCT_ID, a.MENU_ID, a.BROKER_CODES, a.USER_MAIL from LOGIN_MASTER a where a.USERID in('2','4') and a.BRANCH_CODE=?
GET_ADMIN_LIST=select a.LOGIN_ID, a.USERNAME, a.USERID,userType, a.BRANCH_CODE, (select BRANCH_NAME from branch_master where a.BRANCH_CODE=BRANCH_CODE) branch_name , STATUS, DECODE(STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS1, TRIM(A.PRODUCT_ID) PRODUCT_ID, a.MENU_ID, a.BROKER_CODES, a.USER_MAIL from LOGIN_MASTER a where a.USERID in('2','4') and a.BRANCH_CODE=?
##INS_NEW_MENU=INSERT INTO CONSTANT_DETAIL(CATEGORY_ID, CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS, STATUS, RSACODE, BRANCH_CODE, PARENT_MENU) VALUES ('41',(select max(CATEGORY_DETAIL_ID)+1 from CONSTANT_DETAIL where CATEGORY_ID='41' and BRANCH_CODE=?), ?, ?, ?, (select max(CATEGORY_DETAIL_ID)+1 from CONSTANT_DETAIL where CATEGORY_ID='41' and BRANCH_CODE=?), ?, ?)
INS_NEW_MENU=INSERT INTO menu_master(menu_id, menu_NAME, menu_url, STATUS, RSACODE, BRANCH_CODE, PARENT_MENU) VALUES ((select max(menu_id)+1 from menu_master where BRANCH_CODE=?), ?, ?, ?, (select max(menu_ID)+1 from menu_master where BRANCH_CODE=?), ?, ?)
#UPD_EXIST_MENU=UPDATE CONSTANT_DETAIL SET DETAIL_NAME=?, REMARKS=?, STATUS=?, PARENT_MENU=? WHERE CATEGORY_ID='41' AND CATEGORY_DETAIL_ID=? AND BRANCH_CODE=?
UPD_EXIST_MENU=UPDATE menu_master SET menu_NAME=?, menu_url=?, STATUS=?, PARENT_MENU=? WHERE menu_ID=? AND BRANCH_CODE=?

#INS_NEW_ADMIN_USER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION, ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,MENU_ID,PRODUCT_ID,broker_codes, APP_ID, PWD_COUNT, USER_MAIL) values (?,?,(select detail_name from constant_detail where category_id=40 and status='Y' and branch_code=? and remarks=? and category_detail_id=?),?,?,?,?,?,?,?,?,?,?,sysdate+25,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),?,?,?,'16','0',?)
INS_NEW_ADMIN_USER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION, ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,MENU_ID,PRODUCT_ID,broker_codes, APP_ID, PWD_COUNT, USER_MAIL,CREATED_LOGIN, CREATED_DATE) values (?,?,?,?,'2',?,?,?,?,?,?,?,?,sysdate+45,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),?,?,?,'16','0',?,?,SYSDATE)
UPD_EXIST_ADMIN_USER=update login_master set USERNAME=?, USERTYPE=(select detail_name from constant_detail where category_id=40 and status='Y' and branch_code=? and remarks=? and category_detail_id=?), USERID=?, STATUS=?, PASSDATE=SYSDATE+25, MENU_ID=?, PRODUCT_ID=?, USER_MAIL=?, broker_codes=?, LAST_UPDATED_LOGIN = ?, LAST_UPDATED_DATE = SYSDATE where LOGIN_ID=?
UPD_EXIST_ADMIN_USER_PWD=update login_master set USERNAME=?, PASSWORD=?, USERTYPE=(select detail_name from constant_detail where category_id=40 and status='Y' and branch_code=? and remarks=? and category_detail_id=?), USERID=?, STATUS=?, PASSDATE=SYSDATE+25, MENU_ID=?, PRODUCT_ID=?, USER_MAIL=?, broker_codes=?, LAST_UPDATED_LOGIN = ?, LAST_UPDATED_DATE = SYSDATE where LOGIN_ID=?

GET_BRANCH_NAME=SELECT DISTINCT(BRANCH_NAME) FROM BRANCH_MASTER WHERE BRANCH_CODE\=?

#RatingEngine
Check_mode_of_transport=select distinct(RSACODE) from mode_of_transport where RSACODE=? and BRANCH_CODE=?
GET_TRANSPORT_MODE=select transport_description,RSACODE,DISPLAY_ORDER,MODE_TRANSPORT_ID,STATUS from mode_of_transport where branch_code=? and MODE_TRANSPORT_ID=?
UPDATE_MODE_OF_TRANSPORT=update MODE_OF_TRANSPORT set transport_description=?,DISPLAY_ORDER=?,RSACODE=?,STATUS=? where MODE_TRANSPORT_ID=? and BRANCH_CODE=?
#INS_MODE_OF_TRANSPORT=insert into MODE_OF_TRANSPORT values((select MAX(SNO__)+1 from MODE_OF_TRANSPORT),(SELECT MAX(MODE_TRANSPORT_ID)+1 from MODE_OF_TRANSPORT where BRANCH_CODE=?),?,?,'',?,?,?)
INS_MODE_OF_TRANSPORT=insert into MODE_OF_TRANSPORT (SNO__,MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,STATUS,DISPLAY_ORDER,BRANCH_CODE) values((select NVL(MAX(SNO__),0)+1 from MODE_OF_TRANSPORT),(SELECT NVL(MAX(MODE_TRANSPORT_ID),0)+1 from MODE_OF_TRANSPORT where BRANCH_CODE=?),?,?,?,?,?)
#INS_ERROR_MASTER=insert into ERROR_MASTER values((select MAX(ERROR_ID)+1 from ERROR_MASTER),?,(select STAGE_ID from STAGE_MASTER where STAGE_DESC=? and PRODUCT_ID=(select PRODUCT_ID from PRODUCT_MASTER where PRODUCT_NAME=? and BRANCH_CODE=? and STATUS='Y')),(select PRODUCT_ID from PRODUCT_MASTER where PRODUCT_NAME=? and BRANCH_CODE=? and STATUS='Y'),?,?)
INS_ERROR_MASTER=insert into ERROR_MASTER values((select MAX(ERROR_ID)+1 from ERROR_MASTER),?,?,?,?,?)
GET_STATE_LIST=select STAGE_ID,STAGE_DESC from STAGE_MASTER where PRODUCT=?
INS_CONVEYAN_MASTER=INSERT INTO CONVEYAN_MASTER (SNO,CONV_MEAN,CONVCD,CONVDESC,CONV_RATE, MODE_TRANSPORT_ID,EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE,CORE_APP_ID,REMARKS,STATUS) VALUES ((select MAX(SNO)+1 from CONVEYAN_MASTER),(select MAX(CONV_MEAN)+1 from CONVEYAN_MASTER where BRANCH_CODE=?),(select SUBSTR((select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT where MODE_TRANSPORT_ID=? and BRANCH_CODE=?),1,1) from dual),?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?)
GET_CONVEYAN_MASTER=select  CONV_MEAN,CONVDESC from CONVEYAN_MASTER where AMEND_ID||CONV_MEAN  in (select max(AMEND_ID)||CONV_MEAN from CONVEYAN_MASTER where branch_code = ?  group by CONV_MEAN ) AND branch_code = ? order by CONVDESC
#EDIT_CONVEYAN_MASTER=select CONVDESC,MODE_TRANSPORT_ID,CONV_RATE,REMARKS,CORE_APP_ID,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from CONVEYAN_MASTER where BRANCH_CODE=? and CONV_MEAN=? and MODE_TRANSPORT_ID=?
EDIT_CONVEYAN_MASTER=SELECT SNO,CONVDESC,MODE_TRANSPORT_ID,CONV_RATE,REMARKS,CORE_APP_ID,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS FROM CONVEYAN_MASTER CM WHERE BRANCH_CODE=? AND CONV_MEAN=? AND MODE_TRANSPORT_ID=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER C WHERE   C.BRANCH_CODE=CM.BRANCH_CODE AND C.CONV_MEAN=CM.CONV_MEAN AND C.MODE_TRANSPORT_ID=CM.MODE_TRANSPORT_ID)
#UPDATE_CONVEYAN_MASTER=INSERT INTO CONVEYAN_MASTER VALUES ((select MAX(SNO)+1 from CONVEYAN_MASTER),?,(select SUBSTR((select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT where MODE_TRANSPORT_ID=? and BRANCH_CODE=?),1,1) from dual),?,?,?,TO_DATE(?,'MM/DD/YYYY'),(select MAX(AMEND_ID)+1 from CONVEYAN_MASTER where BRANCH_CODE=? and MODE_TRANSPORT_ID=? and CONVDESC=?),?,?,?,?)
UPDATE_CONVEYAN_MASTER=INSERT INTO CONVEYAN_MASTER (SNO, CONV_MEAN, CONVCD,CONVDESC, CONV_RATE, MODE_TRANSPORT_ID,EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID, REMARKS, STATUS) VALUES ((select MAX(SNO)+1 from CONVEYAN_MASTER),?,(select SUBSTR((select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT where MODE_TRANSPORT_ID=? and BRANCH_CODE=?),1,1) from dual),?,?,?,TO_DATE(?,'MM/DD/YYYY'),(select (MAX(AMEND_ID)+1)from CONVEYAN_MASTER where BRANCH_CODE=? and SNO=?),?,?,?,?)
#INS_COUNTRY_MASTER=insert into country_master values((select MAX(SNO__)+1 from country_master),(select MAX(COUNTRY_ID)+1 from country_master),?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?)
INS_COUNTRY_MASTER=insert into country_master(SNO__,COUNTRY_ID,COUNTRY_NAME,COUNTRY_SHORT_NAME,STATUS,RSACODE,NATIONALITY_NAME,AMEND_ID,EFFECTIVE_DATE,GEO_RATE,REMARKS)values((select MAX(SNO__)+1 from country_master),(select MAX(COUNTRY_ID)+1 from country_master),?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?)
#EDIT_COUNTRY_MASTER=select COUNTRY_NAME,COUNTRY_SHORT_NAME,NATIONALITY_NAME,GEO_RATE,REMARKS,RSACODE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from COUNTRY_MASTER where COUNTRY_ID=?
EDIT_COUNTRY_MASTER=select E.COUNTRY_NAME,E.COUNTRY_SHORT_NAME,E.NATIONALITY_NAME,E.GEO_RATE,E.REMARKS,E.RSACODE,E.AMEND_ID,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,E.STATUS from COUNTRY_MASTER E where E.COUNTRY_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=E.COUNTRY_ID)
#UPDATE_COUNTRY_MASTER=insert into country_master values((select MAX(SNO__)+1 from country_master),?,?,?,?,?,?,(select MAX(AMEND_ID)+1 from COUNTRY_MASTER where COUNTRY_NAME=?),TO_DATE(?,'MM/DD/YYYY'),?,?)
UPDATE_COUNTRY_MASTER=insert into country_master (SNO__, COUNTRY_ID , COUNTRY_NAME , COUNTRY_SHORT_NAME,STATUS, RSACODE, NATIONALITY_NAME, AMEND_ID , EFFECTIVE_DATE, GEO_RATE, REMARKS, INT_PORT_CODE) values((select MAX(SNO__)+1 from country_master),?,?,?,?,?,?,(select MAX(AMEND_ID)+1 from COUNTRY_MASTER where COUNTRY_ID=?),TO_DATE(?,'MM/DD/YYYY'),?,?,(select distinct(INT_PORT_CODE) from COUNTRY_MASTER cm where COUNTRY_ID=? and cm.amend_id=((select MAX(AMEND_ID) from COUNTRY_MASTER c where cm.COUNTRY_ID=c.country_id))))
#INS_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values((select MAX(BANK_ID)+1 from OPEN_COVER_BANK_MASTER),?,'','',TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?)
#INS_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values((select MAX(to_number(BANK_ID))+1 from OPEN_COVER_BANK_MASTER),?,'','',TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?)
INS_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values((SELECT   MAX (to_number(BANK_ID)) + 1 FROM OPEN_COVER_BANK_MASTER Where Bank_id !='99999'),?,'','',TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?,'')
GET_BANK=SELECT BANK_ID,BANK_NAME FROM OPEN_COVER_BANK_MASTER 
Check_name_Bank=select count(BANK_NAME) from OPEN_COVER_BANK_MASTER where upper(BANK_NAME)=upper(?) and BELONGING_COUNTRY_ID=?
#EDIT_BANK_MASTER=select BANK_NAME,BELONGING_COUNTRY_ID,REMARKS,RSACODE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from OPEN_COVER_BANK_MASTER where BANK_ID=?
EDIT_BANK_MASTER=select BANK_NAME,BELONGING_COUNTRY_ID,REMARKS,RSACODE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from OPEN_COVER_BANK_MASTER E where BANK_ID=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=E.BANK_ID) AND BELONGING_COUNTRY_ID=(SELECT BELONGING_BRANCH  from branch_master where branch_code=?)
#UPDATE_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values(?,?,'','',TO_DATE(?,'MM/DD/YYYY'),(select MAX(AMEND_ID)+1 from OPEN_COVER_BANK_MASTER where BANK_NAME=?),?,?,?,?)
UPDATE_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values(?,?,'','',TO_DATE(?,'MM/DD/YYYY'),(select MAX(AMEND_ID)+1 from OPEN_COVER_BANK_MASTER where BANK_ID=?),?,?,?,?)
GET_BRANCH=select branch_code,BRANCH_NAME from branch_master where status='Y' order by BRANCH_NAME
GET_MATERIAL=SELECT MM.MATERIAL_ID,MM.MM.MATERIAL_DESC FROM MATERIAL_TYPE_MASTER MM WHERE BRANCH_CODE = ? AND MM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_DESC=MM.MATERIAL_DESC)
INS_MATERIAL_TYPE_MASTER=insert into MATERIAL_TYPE_MASTER values((select MAX(SNO)+1 from MATERIAL_TYPE_MASTER),(select MAX(MATERIAL_ID)+1 from MATERIAL_TYPE_MASTER where BRANCH_CODE=?),?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?)
#EDIT_MATERIAL_TYPE_MASTER=SELECT   MM.MATERIAL_DESC,MM.MATERIAL_RATE,MM.MATERIAL_ID,MM.REMARKS,MM.CORE_APP_ID,TO_CHAR (MM.EFFECTIVE_DATE, 'MM/DD/YYYY') EFFECTIVE_DATE, MM.STATUS FROM   MATERIAL_TYPE_MASTER MM WHERE   MM.BRANCH_CODE \= ? AND MATERIAL_ID \= ? AND MM.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   MATERIAL_TYPE_MASTER WHERE   BRANCH_CODE \= MM.BRANCH_CODE AND MATERIAL_ID \= MM.MATERIAL_ID)
EDIT_MATERIAL_TYPE_MASTER=SELECT   MM.MATERIAL_DESC, MM.MATERIAL_RATE, MM.MATERIAL_ID, MM.REMARKS, MM.CORE_APP_ID, TO_CHAR (MM.EFFECTIVE_DATE, 'MM/DD/YYYY') EFFECTIVE_DATE, MM.STATUS FROM   MATERIAL_TYPE_MASTER MM WHERE   MM.BRANCH_CODE \=? AND MATERIAL_ID \=? and mm.cover_id\=? AND MM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MATERIAL_TYPE_MASTER WHERE   BRANCH_CODE \= MM.BRANCH_CODE AND MATERIAL_ID \= MM.MATERIAL_ID AND COVER_ID\=MM.COVER_ID) 
#UPDATE_MATERIAL_TYPE_MASTER=insert into MATERIAL_TYPE_MASTER values((select MAX(SNO)+1 from MATERIAL_TYPE_MASTER),?,?,?,TO_DATE(?,'MM/DD/YYYY'),(select MAX(AMEND_ID)+1 from MATERIAL_TYPE_MASTER where MATERIAL_DESC=?),?,?,?,?)
UPDATE_MATERIAL_TYPE_MASTER=insert into MATERIAL_TYPE_MASTER (  SNO,MATERIAL_ID ,COVER_ID, MATERIAL_DESC,MATERIAL_RATE,EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE,CORE_APP_ID,STATUS, REMARKS ) values( ( select MAX(SNO)+1 from  MATERIAL_TYPE_MASTER where BRANCH_CODE=? ),?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),(select max(AMEND_ID)+1 from MATERIAL_TYPE_MASTER where BRANCH_CODE=? and MATERIAL_ID=? ),?,?,?,?)
#INS_WAR_RATE_MASTER=insert into WAR_RATE_MASTER values((select MAX(SNO)+1 from WAR_RATE_MASTER),(select MAX(WAR_ID)+1 from WAR_RATE_MASTER where BRANCH_CODE=?),?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?)
INS_WAR_RATE_MASTER=insert into WAR_RATE_MASTER (SNO, WAR_ID, WAR_DESC, WAR_RATE, MODE_TRANSPORT_ID, EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID,STATUS, REMARKS) values((select NVL(MAX(SNO),0)+1 from WAR_RATE_MASTER),( select NVL(MAX(WAR_ID),0)+1  from WAR_RATE_MASTER  where BRANCH_CODE=?),?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?)
GET_WAR_RATE=select WAR_ID,WAR_DESC from WAR_RATE_MASTER MM WHERE BRANCH_CODE = ? AND AMEND_ID =  (SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER MTM WHERE BRANCH_CODE = ? AND MTM.WAR_ID = MM.WAR_ID)
#EDIT_WAR_RATE_MASTER=select MODE_TRANSPORT_ID,WAR_DESC,WAR_RATE,REMARKS,CORE_APP_ID,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from WAR_RATE_MASTER where BRANCH_CODE=? and WAR_ID=?
EDIT_WAR_RATE_MASTER=select MODE_TRANSPORT_ID,WAR_DESC,WAR_RATE,REMARKS,CORE_APP_ID,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from WAR_RATE_MASTER  WW where BRANCH_CODE=? and WAR_ID=? AND AMEND_ID= ( SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER WR WHERE  WR.BRANCH_CODE=WW.BRANCH_CODE AND WR.WAR_ID=WW.WAR_ID)
#UPDATE_WAR_RATE_MASTER=update WAR_RATE_MASTER w set WAR_RATE=?,REMARKS=?,EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),STATUS=? where branch_code=? and WAR_ID=? and amend_id=(select max(amend_id) from war_rate_master where war_id=w.war_id)
UPDATE_WAR_RATE_MASTER=update WAR_RATE_MASTER w set WAR_DESC=?,MODE_TRANSPORT_ID=?,WAR_RATE=?,REMARKS=?,EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),CORE_APP_ID=?,STATUS=? where branch_code=? and WAR_ID=? and amend_id=(select max(amend_id) from war_rate_master where war_id=w.war_id)
GET_EXECUTIVE_MASTER = Select AC_EXECUTIVE_ID,Ac_Executive_Name,Lef.Oa_Code,Lef.Product_Id, Pm.Product_Name,To_Char(Lef.Effective_Date, 'MM/DD/YYYY')Effective_Date, Decode(Lef.Status,'Y','Active','N','DeActive')Status From Login_Executive_Details Lef,Product_Master Pm Where Lef.Product_Id=Pm.Product_Id
EDIT_EXECUTIVE_MASTER=select AC_EXECUTIVE_NAME, OA_CODE, PRODUCT_ID, To_Char(Effective_Date, 'MM/DD/YYYY')EFFECTIVE_DATE, ENTRY_DATE,STATUS, REMARKS,COMMISSION,OPENCOVER_COMMISSION from LOGIN_EXECUTIVE_DETAILS LED where AC_EXECUTIVE_ID=?
COUNT_OTHERPARTYMASTER=select count(*)  from login_executive_details where OA_CODE\=?
UPDATE_INTO_EXECUTIVE_MASTER = update LOGIN_EXECUTIVE_DETAILS set AC_EXECUTIVE_NAME\=?,OA_CODE\=?,EFFECTIVE_DATE\=TO_DATE(?, 'MM/DD/YYYY'),STATUS\=?,REMARKS\=?,COMMISSION\=?,OPENCOVER_COMMISSION\=? where AC_EXECUTIVE_ID\=?
INSERT_INTO_EXECUTIVE_MASTER=Insert into LOGIN_EXECUTIVE_DETAILS(AC_EXECUTIVE_ID, AC_EXECUTIVE_NAME,OA_CODE, PRODUCT_ID, AMEND_ID,EFFECTIVE_DATE, ENTRY_DATE,STATUS, REMARKS, COMPANY_ID,COMMISSION,OPENCOVER_COMMISSION) Values((select max(AC_EXECUTIVE_ID)+1 from LOGIN_EXECUTIVE_DETAILS), ?, ?,3,0,TO_DATE(?,'MM/DD/YYYY'),Sysdate,?,?,'213',?,?)


GET_SALE_TERM=select stm.sale_term_id,stm.sale_term_name from sale_term_master stm where stm.branch_code=?
GET_TRANSPORT_LIST=select MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive') STATUS from MODE_OF_TRANSPORT where BRANCH_CODE=?
GET_TRANSPORT_LIST_BY_NAME=select MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from MODE_OF_TRANSPORT where BRANCH_CODE\=? and lower(TRANSPORT_DESCRIPTION) like lower(('%'||?||'%')) order by lower(TRANSPORT_DESCRIPTION)
GET_CONVEYAN_MASTER_LIST=select E.MODE_TRANSPORT_ID,MT.TRANSPORT_DESCRIPTION,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS from CONVEYAN_MASTER E,mode_of_transport MT where E.BRANCH_CODE\=? and MT.BRANCH_CODE\= E.BRANCH_CODE and E.MODE_TRANSPORT_ID\=MT.MODE_TRANSPORT_ID AND E.branch_code\=MT.branch_code AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN\=E.CONV_MEAN and BRANCH_CODE\=E.BRANCH_CODE) 
GET_CONVEYAN_LIST_BY_NAME=select E.MODE_TRANSPORT_ID,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from CONVEYAN_MASTER E where BRANCH_CODE\=? AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONVDESC\=E.CONVDESC )and lower(E.CONVDESC) like lower(('%'||?||'%')) 
GET_CONVEYAN_MODE_LIST=select E.MODE_TRANSPORT_ID,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS,AMEND_ID from CONVEYAN_MASTER E where BRANCH_CODE=? AND E.MODE_TRANSPORT_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONVDESC=E.CONVDESC)
Check_convey=select count(CORE_APP_ID) from CONVEYAN_MASTER where CORE_APP_ID=? and BRANCH_CODE=? and MODE_TRANSPORT_ID=?
GET_Country_List=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) order by COUNTRY_NAME
GET_COUNTRY_LIST=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID\=E.COUNTRY_ID) 
GET_COUNTRYLIST=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME)
GET_COUNTRY_LIST_BY_NAME=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) and lower(E.COUNTRY_NAME) like lower(('%'||?||'%')) order by E.COUNTRY_NAME
Check_name_Country=select count(COUNTRY_NAME) from COUNTRY_MASTER where upper(COUNTRY_NAME)=upper(?)
Check_Country= select distinct(RSACODE) from COUNTRY_MASTER where RSACODE\=? 
GET_BANK_LIST=select E.BANK_ID,E.BANK_NAME,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME=E.BANK_NAME) order by BANK_NAME
GET_BANKLIST=select E.BANK_ID,E.BANK_NAME,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=E.BANK_ID)
GET_BANK_LIST_BY_NAME=select E.BANK_ID,E.BANK_NAME,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME=E.BANK_NAME) and lower(E.BANK_NAME) like lower(('%'||?||'%')) order by E.BANK_NAME
Check_Bank= select distinct(RSACODE) from OPEN_COVER_BANK_MASTER where RSACODE=?
GET_MATERIAL_LIST_BY_NAME=SELECT E.MATERIAL_ID,E.MATERIAL_DESC,E.MATERIAL_RATE,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS FROM material_type_master E WHERE E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM material_type_master WHERE MATERIAL_DESC=E.MATERIAL_DESC )and  lower(E.material_desc) like lower('%'||?||'%') order by E.material_desc
#GET_MATERIAL_MASTER_LIST=SELECT E.MATERIAL_ID,E.MATERIAL_DESC,E.MATERIAL_RATE,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS FROM material_type_master E WHERE E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM material_type_master WHERE MATERIAL_ID=E.MATERIAL_ID AND BRANCH_CODE=E.BRANCH_CODE)
GET_MATERIAL_MASTER_LIST=SELECT   E.MATERIAL_ID, E.MATERIAL_DESC, E.MATERIAL_RATE, E.COVER_ID, (SELECT CM.COVER_NAME FROM COVER_MASTER CM WHERE CM.COVER_ID=E.COVER_ID AND CM.BRANCH_CODE=E.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER CM1 WHERE CM1.COVER_ID=CM.COVER_ID AND CM1.BRANCH_CODE=CM.BRANCH_CODE ) )COVER_NAME, TO_CHAR (E.EFFECTIVE_DATE, 'MM/DD/YYYY') EFFECTIVE_DATE, DECODE (E.STATUS, 'Y', 'Active', 'N', 'DeActive') STATUS FROM   material_type_master E WHERE   E.BRANCH_CODE = ? AND E.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   material_type_master WHERE   MATERIAL_ID = E.MATERIAL_ID AND BRANCH_CODE = E.BRANCH_CODE and COVER_ID=E.COVER_ID)
Check_name_material=select count(MATERIAL_DESC) from MATERIAL_TYPE_MASTER where upper(MATERIAL_DESC)\=upper(?) and BRANCH_CODE\=?
Check_material=select count(CORE_APP_ID) from MATERIAL_TYPE_MASTER where CORE_APP_ID=? and BRANCH_CODE=?
#GET_WARRATE_LIST=select w.war_id,w.war_desc,w.war_rate,to_char(w.effective_date,'MM/DD/YYYY')effective_date,decode(w.status,'Y','Active','N','DeActive')status,m.transport_description from WAR_RATE_MASTER w,MODE_OF_TRANSPORT m where m.mode_transport_id=w.mode_transport_id and m.branch_code=? and W.BRANCH_CODE=? and amend_id=(select max(amend_id) from war_rate_master where war_id=w.war_id)
GET_WARRATE_LIST=select w.branch_code,w.amend_id,w.war_id,w.war_desc,w.war_rate,to_char(w.effective_date,'MM/DD/YYYY') effective_date,decode(w.status,'Y','Active','N','DeActive')status, m.transport_description from WAR_RATE_MASTER w,MODE_OF_TRANSPORT m where m.mode_transport_id=w.mode_transport_id and m.branch_code=? and W.BRANCH_CODE=? and W.BRANCH_CODE=m.branch_code and amend_id=( select max(amend_id) from war_rate_master wr where  wr.mode_transport_id=w.mode_transport_id  and wr.branch_code=w.branch_code)
GET_WAR_LIST_BY_NAME=SELECT   E.WAR_ID,E.WAR_DESC,E.WAR_RATE,TO_CHAR (E.EFFECTIVE_DATE, 'MM/DD/YYYY') EFFECTIVE_DATE,DECODE (E.STATUS,'Y','ACTIVE','N','DeActive')STATUS,M.TRANSPORT_DESCRIPTION FROM WAR_RATE_MASTER E, MODE_OF_TRANSPORT M  WHERE E.mode_transport_id=M.mode_transport_id and E.BRANCH_CODE = ? AND M.BRANCH_CODE=? AND E.AMEND_ID = (SELECT MAX (AMEND_ID) FROM WAR_RATE_MASTER WHERE WAR_DESC = E.WAR_DESC AND BRANCH_CODE=?) AND LOWER (E.WAR_DESC) LIKE LOWER ('%' || ? || '%') ORDER BY E.WAR_ID
GET_WAR_LIST_BY_DESC=SELECT   E.WAR_ID,E.WAR_DESC,E.WAR_RATE,TO_CHAR (E.EFFECTIVE_DATE, 'MM/DD/YYYY') EFFECTIVE_DATE,DECODE (E.STATUS,'Y','ACTIVE','N','DeActive')STATUS,M.TRANSPORT_DESCRIPTION FROM WAR_RATE_MASTER E, MODE_OF_TRANSPORT M  WHERE E.mode_transport_id=M.mode_transport_id and E.BRANCH_CODE = ? AND M.BRANCH_CODE=? AND E.AMEND_ID = (SELECT MAX (AMEND_ID) FROM WAR_RATE_MASTER WHERE WAR_DESC = E.WAR_DESC AND BRANCH_CODE=?) AND LOWER (M.TRANSPORT_DESCRIPTION) LIKE LOWER ('%' || ? || '%') ORDER BY M.TRANSPORT_DESCRIPTION
Check_War= select distinct(CORE_APP_ID) from WAR_RATE_MASTER where CORE_APP_ID=? and branch_code=?
Check_Sale=select distinct(RSACODE) from SALE_TERM_MASTER where RSACODE=?
GET_SALETERM_LIST=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from SALE_TERM_MASTER where BRANCH_CODE=?
GET_SALETERM_LIST_BY_NAME=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from SALE_TERM_MASTER where BRANCH_CODE=? and lower(SALE_TERM_NAME) like lower(('%'||?||'%')) order by lower(SALE_TERM_NAME)
#INS_SALETERM=insert into SALE_TERM_MASTER values((select MAX(SNO__)+1 from SALE_TERM_MASTER),(select MAX(SALE_TERM_ID)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?)
INS_SALETERM=insert into SALE_TERM_MASTER (SNO__,SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,RSACODE,REMARKS,STATUS,DISPLAY_ORDER,BRANCH_CODE,INT_CODE)values((select NVL( MAX(SNO__),0)+1 from SALE_TERM_MASTER),(select NVL(MAX(SALE_TERM_ID),0)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?,(select NVL(MAX(SALE_TERM_ID),0)+1 from SALE_TERM_MASTER where BRANCH_CODE=?))
EDIT_SALETERM_MASTER=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,RSACODE,REMARKS,STATUS from SALE_TERM_MASTER where BRANCH_CODE=? and SALE_TERM_ID=?
UPDATE_SALETERM_MASTER=update SALE_TERM_MASTER set SALE_TERM_NAME=?,SALE_TERM_VALUE=?,RSACODE=?,STATUS=?,REMARKS=?,INT_CODE=? where BRANCH_CODE=? and SALE_TERM_ID=?
#INS_TOLERANCE_MASTER=insert into TOLERANCE_MASTER values((select MAX(SNO__)+1 from TOLERANCE_MASTER),(select MAX(TOLERANCE_ID)+1 from TOLERANCE_MASTER where BRANCH_CODE=?),?,?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from TOLERANCE_MASTER where BRANCH_CODE=?))
INS_TOLERANCE_MASTER=insert into TOLERANCE_MASTER (SNO__,TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER) values((select MAX(SNO__)+1 from TOLERANCE_MASTER),(select MAX(TOLERANCE_ID)+1 from TOLERANCE_MASTER where BRANCH_CODE=?),?,?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from TOLERANCE_MASTER where BRANCH_CODE=?))
EDIT_TOLERANCE_MASTER=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,STATUS,REMARKS from TOLERANCE_MASTER where BRANCH_CODE=? and TOLERANCE_ID=?
Check_tole=select distinct(RSACODE) from TOLERANCE_MASTER where BRANCH_CODE=? and RSACODE=?
GET_TOLERANCE_LIST_BY_NAME=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from TOLERANCE_MASTER where BRANCH_CODE=? and lower(TOLERANCE_NAME) like lower(('%'||?||'%'))order by lower(TOLERANCE_NAME)
GET_TOLERANCE_MASTER_LIST=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from TOLERANCE_MASTER where BRANCH_CODE\=? 
Check_name_tole=select count(TOLERANCE_NAME) from TOLERANCE_MASTER where branch_code=? and upper(TOLERANCE_NAME)=upper(?)
UPDATE_TOLERANCE_MASTER=update TOLERANCE_MASTER set TOLERANCE_NAME=?,TOLERANCE_VALUE=?,RSACODE=?,REMARKS=?,STATUS=? where BRANCH_CODE=? and TOLERANCE_ID=?
GET_COMEX_LIST=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where AMEND_ID||SNO  in (select max(AMEND_ID)||(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code \= ?  group by SNO ) AND branch_code \= ? order by SNO
GET_COMEXLIST=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where AMEND_ID||SNO  in (select max(AMEND_ID)||(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code \= ?  group by SNO ) AND branch_code \= ? 
GET_COMEX_LIST_BY_NAME=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE=? and lower(START_SUM_INSURED) like lower(('%'||?||'%'))order by lower(START_SUM_INSURED)
GET_COMEX_LIST_BY_VALUE=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE\=? and lower(END_SUM_INSURED) like lower(('%'||?||'%'))order by lower(END_SUM_INSURED) 
#Check_comEx=select distinct(RSACODE) from COMMODITY_EXCESS_PREMIUM where branch_code=? and RSACODE=?
Check_comEx=select distinct(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code=? and SNO=?
#INS_COMEX=insert into COMMODITY_EXCESS_PREMIUM values((select MAX(SNO)+1 from COMMODITY_EXCESS_PREMIUM),?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?)
INS_COMEX=insert into COMMODITY_EXCESS_PREMIUM (SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,AMEND_ID,EFFECTIVE_DATE,BRANCH_CODE,STATUS) values((select MAX(SNO)+1 from COMMODITY_EXCESS_PREMIUM  WHERE BRANCH_CODE=?),?,?,?,?,0,TO_DATE(?,'MM/DD/YYYY'),?,?)
#UPDATE_COMEX=update COMMODITY_EXCESS_PREMIUM set DEDUCTIBLE=?,RATE=?,STATUS=?,EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),RSACODE=? where SNO=?
UPDATE_COMEX=update COMMODITY_EXCESS_PREMIUM set DEDUCTIBLE=?,RATE=?,STATUS=?,EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY')  where SNO=? and AMEND_ID =(select max(AMEND_ID) from COMMODITY_EXCESS_PREMIUM where SNO=? and BRANCH_CODE=?) and BRANCH_CODE=?
#EDIT_COMEX=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE\=? and SNO\=?
EDIT_COMEX=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,STATUS from COMMODITY_EXCESS_PREMIUM a where a.BRANCH_CODE\=? and a.SNO\=? and AMEND_ID \=(select max(AMEND_ID) from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE\=A.BRANCH_CODE and SNO\=a.sno ) 
Check_name_mode_of_transport=select count(TRANSPORT_DESCRIPTION) from MODE_OF_TRANSPORT where upper(TRANSPORT_DESCRIPTION)=upper(?) and branch_code=?
Check_name_convey=select count(CONVDESC) from CONVEYAN_MASTER where upper(CONVDESC)=upper(?) and BRANCH_CODE=?
Check_name_War=select count(MODE_TRANSPORT_ID) from WAR_RATE_MASTER where mode_transport_id=? and branch_code=?
#GET_EXTRA_COVER_LIST=select E.EXTRA_COVER_NAME,E.EXTRA_COVER_ID,E.REMARKS,to_char(E.effective_date,'MM/DD/YYYY') EFFECTIVE_DATE,E.RSACODE,decode(E.status,'Y','Active','D','DeActive') STATUS ,m.transport_description from EXTRA_COVER_MASTER E,MODE_OF_TRANSPORT m where m.mode_transport_id=E.mode_transport_id and m.branch_code=? and E.BRANCH_CODE=?
GET_EXTRA_COVER_LIST=SELECT E.EXTRA_COVER_NAME,E.EXTRA_COVER_ID,E.REMARKS,E.RSACODE,DECODE(E.STATUS,'Y','Active','N','DeActive') STATUS ,M.TRANSPORT_DESCRIPTION FROM EXTRA_COVER_MASTER E,MODE_OF_TRANSPORT M WHERE M.MODE_TRANSPORT_ID=E.MODE_TRANSPORT_ID AND M.BRANCH_CODE=? AND E.BRANCH_CODE=?
GET_EXTRACOVER_LIST_BY_NAME=select E.EXTRA_COVER_NAME,EXTRA_COVER_ID,E.REMARKS,E.RSACODE,to_char(E.effective_date,'MM/DD/YYYY') EFFECTIVE_DATE,decode(E.status,'Y','Active','D','DeActive') STATUS ,m.transport_description from EXTRA_COVER_MASTER E,MODE_OF_TRANSPORT m where m.mode_transport_id=E.mode_transport_id and m.branch_code=? and E.BRANCH_CODE=? and lower(E.extra_cover_name) like lower(('%'||?||'%'))
Check_extraCover=select distinct(RSACODE) from Extra_cover_master where branch_code=? and RSACODE=?
INS_EXTRA_MASTER=insert into extra_cover_master(SNO__,BRANCH_CODE,MODE_TRANSPORT_ID,EXTRA_COVER_NAME,RSACODE,EXTRA_COVER_ID,REMARKS,STATUS) values((select max(SNO__)+1 from extra_cover_master),?,?,?,?,(select max(extra_cover_id)+1 from extra_cover_master where branch_code=?),?,?)
EDIT_EXTRA_COVER_MASTER=select EXTRA_COVER_NAME,EXTRA_COVER_ID,MODE_TRANSPORT_ID,REMARKS,RSACODE,STATUS from EXTRA_COVER_MASTER where BRANCH_CODE=? and EXTRA_COVER_ID=?
UPDATE_EXTRA_COVER_MASTER=update extra_cover_master set EXTRA_COVER_NAME=?,MODE_TRANSPORT_ID=?, REMARKS=?, RSACODE=? ,STATUS=? where BRANCH_CODE=? and EXTRA_COVER_ID=?
#GET_CITY_LIST=SELECT CI.CITY_NAME,CI.CITY_ID,CI.COUNTRY_ID,CI.RSACODE,CI.REMARKS,decode(CI.status,'Y','Active','N','DeActive') STATUS,CO.COUNTRY_NAME FROM CITY_MASTER CI,COUNTRY_MASTER CO WHERE CI.COUNTRY_ID=CO.COUNTRY_ID
GET_CITY_LIST=SELECT CI.CITY_NAME,CI.CITY_ID,CI.COUNTRY_ID,CI.RSACODE,CI.REMARKS,decode(CI.status,'Y','Active','N','DeActive') STATUS,CO.COUNTRY_NAME FROM CITY_MASTER CI,COUNTRY_MASTER CO WHERE CI.COUNTRY_ID=CO.COUNTRY_ID  And CO.amend_id=(select max(amend_id) from country_master cm where co.country_id=cm.country_id)
GET_CITY_LIST_BY_NAME=SELECT CI.CITY_NAME,CI.CITY_ID,CI.COUNTRY_ID,CI.RSACODE,CI.REMARKS,decode(CI.status,'Y','Active','D','DeActive') STATUS,CO.COUNTRY_NAME FROM CITY_MASTER CI,COUNTRY_MASTER CO WHERE CI.COUNTRY_ID\=CO.COUNTRY_ID AND lower(CITY_NAME) like lower(('%'||?||'%'))  
Check_city=select distinct(rsacode) from city_master where rsacode=? and country_id=?
Check_city_name=select count(city_name) from city_master where country_id=? and upper(city_name)=upper(?)
INS_CITI_MASTER=insert into city_master(SNO__,CITY_ID,CITY_NAME,COUNTRY_ID,RSACODE,REMARKS,STATUS) values((select max(sno__)+1 from city_master),(select max(city_id)+1 from city_master),?,?,?,?,?)
EDIT_CITY_MASTER=select city_name,country_id,remarks,status,rsacode,city_id from city_master where city_id=?
GET_VESSEL_LIST=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,DECODE(STATUS,'Y','Active','N','DeActive','R','Referral')STATUS from VESSEL_MASTER  
GET_VESSEL_LIST_BY_NAME=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from VESSEL_MASTER where lower(VESSEL_NAME) like lower('%'||?||'%') ORDER BY VESSEL_NAME
Check_name_Sale=select count(SALE_TERM_NAME) from SALE_TERM_MASTER where upper(SALE_TERM_NAME)=upper(?) and BRANCH_CODE=?
EDIT_VESSEL=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,RSACODE,STATUS,VESSEL_TYPE,REMARKS,VESSEL_RATE from vessel_master where VESSEL_ID=?
INS_VESSEL=insert into vessel_master values((select MAX(SNO__)+1 from vessel_master),(select MAX(vessel_id)+1 from vessel_master),?,?,'','','','','','','','',?,?,?,'Y',(select MAX(DISPLAY_ORDER)+1 from vessel_master),1,?,?,?)
Check_name_vessel=select count(VESSEL_NAME) from vessel_master where lower(VESSEL_NAME)=lower(?)
Check_vessel=select distinct(RSACODE) from vessel_master where RSACODE=?
UPDATE_VESSEL=update VESSEL_MASTER set vessel_name=?,vessel_type=?,MANUFACTURE_YEAR=?,vessel_class=?,RSACODE=?,STATUS=?,remarks=?,VESSEL_RATE=? where VESSEL_ID=?
GET_WARRANTY_LIST=select WARRANTY_ID,WARRANTY_DESCRIPTION,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from WARRANTY_MASTER where BRANCH_CODE\=? 
GET_WARRANTY_LIST_NAME=select WARRANTY_ID,WARRANTY_DESCRIPTION,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from WARRANTY_MASTER where BRANCH_CODE=? and lower(WARRANTY_DESCRIPTION) like lower('%'||?||'%')
Check_Warranty=select count(RSACODE) from WARRANTY_MASTER where RSACODE=? and BRANCH_CODE=?
Check_name_warranty=select count(WARRANTY_DESCRIPTION) from WARRANTY_MASTER where upper(WARRANTY_DESCRIPTION)=upper(?) and BRANCH_CODE=?
#INS_WARRANTY=insert into WARRANTY_MASTER values((select MAX(SNO__)+1 from WARRANTY_MASTER),(select MAX(WARRANTY_ID)+1 from WARRANTY_MASTER where BRANCH_CODE=?),?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from WARRANTY_MASTER where branch_code=?))
INS_WARRANTY=INSERT INTO WARRANTY_MASTER (SNO__,WARRANTY_ID,WARRANTY_DESCRIPTION,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER,INT_CODE) VALUES((SELECT NVL(MAX(SNO__),0)+1 FROM WARRANTY_MASTER),(SELECT NVL(MAX(WARRANTY_ID),0)+1 FROM WARRANTY_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,(SELECT MAX(DISPLAY_ORDER)+1 FROM WARRANTY_MASTER WHERE BRANCH_CODE=?),'W'||?)
UPDATE_WARRANTY=update WARRANTY_MASTER set WARRANTY_DESCRIPTION=?,RSACODE=?,REMARKS=?,STATUS=?,INT_CODE='W'||? where WARRANTY_ID=? and BRANCH_CODE=?
EDIT_WARRANTY=select WARRANTY_ID,WARRANTY_DESCRIPTION,RSACODE,REMARKS,STATUS from WARRANTY_MASTER where BRANCH_CODE=? and WARRANTY_ID=?
GET_CONTANTMASTER_LIST = SELECT CATEGORY_ID,CATEGORY_NAME,DECODE(STATUS,'Y','Active','N','DeActive',STATUS)STATUS,RSACODE FROM CONSTANT_MASTER WHERE BRANCH_CODE=?
#GET_CONSTANT_LIST=select CATEGORY_ID,CATEGORY_DETAIL_ID,DECODE(STATUS,'Y','Active','N','DeActive')STATUS,DETAIL_NAME from CONSTANT_DETAIL where BRANCH_CODE=?
GET_CONSTANT_LIST=select CATEGORY_ID,CATEGORY_DETAIL_ID,DECODE(STATUS,'Y','Active','N','DeActive')STATUS,DETAIL_NAME from CONSTANT_DETAIL where BRANCH_CODE=? and CATEGORY_ID=?
GET_CONSTANT_LIST_NAME=select CATEGORY_ID,CATEGORY_DETAIL_ID,DECODE(STATUS,'Y','Active','N','DeActive')STATUS,DETAIL_NAME from CONSTANT_DETAIL where BRANCH_CODE=? and CATEGORY_ID=?
GET_CATEGORY=select CATEGORY_ID,CATEGORY_NAME from CONSTANT_MASTER where status='Y' and branch_code in(?) order by CATEGORY_NAME
#INS_CONSTANT=Insert into ADNICLOCAL.CONSTANT_DETAIL(CATEGORY_ID, CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS, STATUS,RSACODE, PERCENT, BRANCH_CODE, PARENT_MENU) Values((select MAX(CATEGORY_ID)+1 from CONSTANT_DETAIL where branch_code=?), ?, ?, ?, ?, ?, ?, ?, '')
INS_CONSTANT=Insert into CONSTANT_DETAIL(CATEGORY_ID, CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS, STATUS,RSACODE, PERCENT, BRANCH_CODE, PARENT_MENU) Values(?, (SELECT   MAX (CATEGORY_DETAIL_ID) + 1  FROM   CONSTANT_DETAIL WHERE  CATEGORY_ID=? and branch_code = ?), ?, ?, ?, ?, ?, ?, '')
Check_constant=select count(RSACODE) from CONSTANT_DETAIL where branch_code=? and RSACODE=?
Check_constant_name=select count(DETAIL_NAME) from CONSTANT_DETAIL where branch_code=? and upper(DETAIL_NAME)=upper(?)
EDIT_CONSTANT=select DETAIL_NAME,PERCENT,REMARKS,RSACODE,STATUS,CATEGORY_ID,CATEGORY_DETAIL_ID from CONSTANT_DETAIL where CATEGORY_ID=? and CATEGORY_DETAIL_ID=? and BRANCH_CODE=?
UPDATE_CONSTANT=update CONSTANT_DETAIL set DETAIL_NAME=?,PERCENT=?,REMARKS=?,RSACODE=?,STATUS=? where CATEGORY_DETAIL_ID=? and CATEGORY_ID=? and branch_code=?
Check_extra_name=select count(extra_cover_name) from EXTRA_COVER_MASTER where mode_transport_id=? and branch_code=? and lower(extra_cover_name)=lower(?)
UPDATE_CITY_MASTER=update city_master set city_name=?,country_id=?,rsacode=?,remarks=?,status=? where city_id=?
GET_COUNTRY_DETAIL=SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,DECODE (C.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COUNTRY_MASTER_DETAIL C WHERE C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_NAME\=C.COUNTRY_NAME and BELONGING_COUNTRY_ID\=C.BELONGING_COUNTRY_ID)  AND C.BELONGING_COUNTRY_ID\=?
GET_COUNTRY_DETAIL_NAME=SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,DECODE (C.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COUNTRY_MASTER_DETAIL C WHERE C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_NAME=C.COUNTRY_NAME and BELONGING_COUNTRY_ID=C.BELONGING_COUNTRY_ID) AND C.BELONGING_COUNTRY_ID=? AND lower(C.COUNTRY_NAME) like lower(('%'||?||'%'))
GET_Countries=select E.COUNTRY_ID,E.COUNTRY_NAME from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) and country_id=(select origination_country_id from branch_master where branch_code=?)
Check_countryDet_name=select count(COUNTRY_NAME) from COUNTRY_MASTER_DETAIL where upper(COUNTRY_NAME)=upper(?)
Check_countryDet=select count(RSACODE) from COUNTRY_MASTER_DETAIL where RSACODE=?
INS_COUNTRYDET=insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID,CROSS_VOYAGE_YN,CROSS_VOYAGE_ORG_COUNTRY,CROSS_VOYAGE_DEST_COUNTRY) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?,(select COUNTRY_NAME from COUNTRY_MASTER where COUNTRY_ID=?), ?, ?,?, ?, ?, ?, ?,?, ?, ?, TO_DATE(?, 'MM/DD/YYYY'), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),?,?,?)
EDIT_COUNTRY_DET=select SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,DECODE(STARTING_PLACE,'Any Port','1','Warehouse','2','Disabled','3')STARTING_PLACE, SP_WARRANTIES_CONDITIONS,DECODE(ENDING_PLACE,'Any Port','1','Warehouse','2','Disabled','3')ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS, RSACODE, NATIONALITY_NAME, TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE, REMARKS,CROSS_VOYAGE_YN,CROSS_VOYAGE_ORG_COUNTRY,CROSS_VOYAGE_DEST_COUNTRY from COUNTRY_MASTER_DETAIL where COUNTRY_ID\=? and SNO__\=?
UPDATE_COUNTRYDET=insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID,CROSS_VOYAGE_YN,CROSS_VOYAGE_ORG_COUNTRY,CROSS_VOYAGE_DEST_COUNTRY) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?, ?, ?, ?,?, ?, ?, ?, ?,?, ?, (select MAX(amend_id)+1 from COUNTRY_MASTER_DETAIL where SNO__\=?), TO_DATE(?, 'MM/DD/YYYY'), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?),?,?,?)
GET_BASERATE_COVERAGE=SELECT CM.COVER_ID,CM.COVER_NAME FROM COVER_MASTER CM WHERE mode_transport_id = ? and CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE mode_transport_id = ? and COVER_ID=CM.COVER_ID AND BRANCH_CODE= ?) AND CM.BRANCH_CODE= ? order by CM.COVER_NAME
GET_BASERATE_CONVEY=SELECT CONV_MEAN,CONVDESC FROM CONVEYAN_MASTER CM WHERE MODE_TRANSPORT_ID=? AND BRANCH_CODE= ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CM.CONV_MEAN=CONV_MEAN AND BRANCH_CODE= ? AND MODE_TRANSPORT_ID= ?) ORDER BY CONVDESC
GET_BASERATE_COUNTRY=SELECT CM.COUNTRY_ID,CM.COUNTRY_NAME FROM COUNTRY_MASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=CM.COUNTRY_ID)ORDER BY COUNTRY_NAME
GET_BASERATE_COMMODITY=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME FROM COMMODITYMASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=CM.COMMODITY_ID AND BRANCH_CODE=?)AND CM.BRANCH_CODE=? ORDER BY CM.COMMODITY_NAME
GET_AGENT_LIST= SELECT DISTINCT(SM.SETTLING_AGENT_NAME),SM.SETTLING_AGENT_ID,SM.RSACODE,CM.COUNTRY_NAME,DECODE(SM.STATUS,'Y','Active','N','DeActive') STATUS FROM SETTLING_AGENT_MASTER SM,CITY_MASTER CI,COUNTRY_MASTER CM WHERE CM.COUNTRY_ID=SM.COUNTRY_ID AND BRANCH_CODE=?
GET_AGENT_BY_NAME=SELECT SM.SETTLING_AGENT_NAME,SM.SETTLING_AGENT_ID,SM.RSACODE,CM.COUNTRY_NAME,CI.CITY_NAME,DECODE(SM.STATUS,'Y','Active','N','DeActive') STATUS FROM SETTLING_AGENT_MASTER SM,CITY_MASTER CI,COUNTRY_MASTER CM WHERE CI.CITY_ID\=SM.CITY_ID AND CM.COUNTRY_ID\=SM.COUNTRY_ID AND BRANCH_CODE\=? AND lower(SM.SETTLING_AGENT_NAME) like lower('%'||?||'%') order by COUNTRY_NAME
GET_CITY_BY_COUNTRY=SELECT CITY_NAME,CITY_ID FROM CITY_MASTER WHERE COUNTRY_ID=?
Check_Agent=select distinct(RSACODE) from SETTLING_AGENT_MASTER where  (branch_code=? or branch_code='01') and RSACODE=?
#INS_AGENT_MASTER=insert into SETTLING_AGENT_MASTER values((select max(SNO__)+1 from SETTLING_AGENT_MASTER ),(select max(SETTLING_AGENT_ID)+1 from SETTLING_AGENT_MASTER where branch_code=?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where branch_code=?),?)
#INS_AGENT_MASTER=insert into SETTLING_AGENT_MASTER values((select max(SNO__)+1 from SETTLING_AGENT_MASTER WHERE branch_code = ? ),(select max(SETTLING_AGENT_ID)+1 from SETTLING_AGENT_MASTER where branch_code=?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where branch_code=?),?)
INS_AGENT_MASTER=insert into SETTLING_AGENT_MASTER(SNO__,SETTLING_AGENT_ID,SETTLING_AGENT_NAME,COUNTRY_ID,CITY_ID,SHORT_NAME,ADDRESS1,ADDRESS2,ADDRESS3,ZIP_CODE,TELEPHONE_NO,FAX_NO,MOBILE_NO,EMAIL,RSACODE,REMARKS,STATUS,BRANCH_CODE,BELONGING_COUNTRY_ID,CITY_NAME) values((select max(SNO__)+1 from SETTLING_AGENT_MASTER WHERE branch_code = ? ),(select max(SETTLING_AGENT_ID)+1 from SETTLING_AGENT_MASTER where branch_code=?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where branch_code=?),?)
EDIT_SETTLING_AGENT_MASTER=select SETTLING_AGENT_ID,SETTLING_AGENT_NAME,COUNTRY_ID,CITY_ID,SHORT_NAME,ADDRESS1,ADDRESS2,ADDRESS3,CITY_NAME,ZIP_CODE,TELEPHONE_NO,FAX_NO,MOBILE_NO,EMAIL,RSACODE,REMARKS,STATUS from SETTLING_AGENT_MASTER where (branch_code=?  or branch_code='01') and SETTLING_AGENT_ID=?
#UPDATE_SETTLING_AGENT_MASTER=update SETTLING_AGENT_MASTER set SETTLING_AGENT_NAME=?,COUNTRY_ID=?,CITY_ID=?,SHORT_NAME=?,ADDRESS1=?,ADDRESS2=?,ADDRESS3=?,CITY_NAME=?,ZIP_CODE=?,TELEPHONE_NO=?,FAX_NO=?,MOBILE_NO=?,EMAIL=?,RSACODE=?,REMARKS=?,STATUS=? where branch_code=? and SETTLING_AGENT_ID=?
UPDATE_SETTLING_AGENT_MASTER=update SETTLING_AGENT_MASTER set SETTLING_AGENT_NAME=?,COUNTRY_ID=?,CITY_ID=?,SHORT_NAME=?,ADDRESS1=?,ADDRESS2=?,ADDRESS3=?,CITY_NAME=?,ZIP_CODE=?,TELEPHONE_NO=?,FAX_NO=?,MOBILE_NO=?,EMAIL=?,RSACODE=?,REMARKS=?,STATUS=? where branch_code=? and SETTLING_AGENT_ID=?
#GET_COMMODITY_DETAIL=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,TO_CHAR(CM.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(CM.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID AND BRANCH_CODE\=?)AND CM.BRANCH_CODE\=?
GET_COMMODITY_DETAIL=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,TO_CHAR(CM.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(CM.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID AND BRANCH_CODE\=?)AND CM.BRANCH_CODE\=?    
GET_COMMODITY_DETAIL_NAME=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,TO_CHAR(CM.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,DECODE(CM.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=CM.COMMODITY_ID AND BRANCH_CODE=?)AND CM.BRANCH_CODE=? AND LOWER(CM.COMMODITY_NAME) LIKE LOWER(('%'||?||'%')) ORDER BY CM.COMMODITY_NAME
GET_COMMODITY_TYPE=select CATEGORY_DETAIL_ID,DETAIL_NAME from CONSTANT_DETAIL where CATEGORY_ID=42 and STATUS='Y' and branch_code=?
#GET_COMMODITY_TYPE=select COMMODITY_TYPEID,DETAIL_NAME from COMMODITY_CATEGORY_MASTER CCM where STATUS='Y' and branch_code=? AND AMEND_ID=(select MAX(AMEND_ID) from COMMODITY_CATEGORY_MASTER CM where CM.STATUS=CCM.STATUS and CM.branch_code=CCM.BRANCH_CODE AND CM.COMMODITY_TYPEID=CCM.COMMODITY_TYPEID)
#INS_COMMODITY_MASTER=Insert into COMMODITYMASTER (SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL, ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_AIR_CARGO_AIR, ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND,ALL_RISKS_PARCEL_POST_AIR,ALL_RISKS_SEA_AND_AIR, ICC_C_NONDELIVERY, ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_FOOD_SEA,ICC_A_FROZEN_MEAT_SEA, ICC_C_FROZEN_MEAT_SEA, FRAGILE, RAG, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, COMMODITY_TYPE_ID, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) Values((select MAX(SNO__)+1 from COMMODITYMASTER),(select MAX(COMMODITY_ID)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?)
INS_COMMODITY_MASTER=Insert into COMMODITYMASTER (SNO__,COMMODITY_ID,GROUP_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_C_NONDELIVERY, ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_MEAT_SEA, ICC_C_FROZEN_FOOD_SEA, ICC_AIR_CARGO_AIR, ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND, ALL_RISKS_PARCEL_POST_AIR, ALL_RISKS_SEA_AND_AIR, FRAGILE, COMMODITY_TYPE_ID, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, RAG, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) Values((select MAX(SNO__)+1 from COMMODITYMASTER),(select MAX(COMMODITY_ID)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?)
##insert into COMMODITYMASTER values((select MAX(SNO__)+1 from COMMODITYMASTER),(select MAX(COMMODITY_ID)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?)
Check_commodity_name=select count(COMMODITY_NAME) from COMMODITYMASTER where UPPER(COMMODITY_NAME)=UPPER(?) and BRANCH_CODE=?
Check_commodity=select count(RSACODE) from COMMODITYMASTER where RSACODE\=? and BRANCH_CODE\=? 
#EDIT_COMMODITY_MASTER=select SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_A_FROZEN_MEAT_SEA, ICC_A_FROZEN_FOOD_SEA,ICC_C_FROZEN_MEAT_SEA, ICC_C_FROZEN_FOOD_SEA, ICC_AIR_CARGO_AIR, ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND,ALL_RISKS_PARCEL_POST_AIR, ALL_RISKS_SEA_AND_AIR, FRAGILE, RAG, EXCLUSION_ID,WARRANTY_ID, REMARKS, STATUS, RSACODE, TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,AMEND_ID, COMMODITY_TYPE_ID, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM, ICC_C_NONDELIVERY from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=? and amend_id=(select max(amend_id) from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=?)
EDIT_COMMODITY_MASTER=select SNO__, COMMODITY_ID,GROUP_ID,COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA,ICC_B_SEA,ICC_C_SEA,ICC_C_NONDELIVERY,ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA,ICC_C_FROZEN_MEAT_SEA,ICC_C_FROZEN_FOOD_SEA,ICC_AIR_CARGO_AIR,ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND,LAND_TRANSIT_LAND,ALL_RISKS_PARCEL_POST_AIR,ALL_RISKS_SEA_AND_AIR,FRAGILE, RAG, EXCLUSION_ID,WARRANTY_ID, REMARKS, STATUS, RSACODE, TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,AMEND_ID, COMMODITY_TYPE_ID, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=? and amend_id=(select max(amend_id) from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=?)
#UPDATE_COMMODITY_MASTER=Insert into COMMODITYMASTER (SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL, ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_AIR_CARGO_AIR, ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND,ALL_RISKS_PARCEL_POST_AIR,ALL_RISKS_SEA_AND_AIR, ICC_C_NONDELIVERY, ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_FOOD_SEA,ICC_A_FROZEN_MEAT_SEA, ICC_C_FROZEN_MEAT_SEA, FRAGILE, RAG, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, COMMODITY_TYPE_ID, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) Values((select MAX(SNO__)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?)
UPDATE_COMMODITY_MASTER=Insert into COMMODITYMASTER (SNO__, GROUP_ID,COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_C_NONDELIVERY, ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_MEAT_SEA, ICC_C_FROZEN_FOOD_SEA, ICC_AIR_CARGO_AIR, ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND, ALL_RISKS_PARCEL_POST_AIR, ALL_RISKS_SEA_AND_AIR,FRAGILE, COMMODITY_TYPE_ID, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, RAG, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) Values((select MAX(SNO__)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?)
#insert into COMMODITYMASTER values((select MAX(SNO__)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?)
Check_Date=select count(CM.EFFECTIVE_DATE) from COMMODITYMASTER CM where CM.EFFECTIVE_DATE<TO_DATE(?,'MM/DD/YYYY') and CM.commodity_name\=? and CM.branch_code\=? and CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID AND BRANCH_CODE\=?)
#GET_CURRENCY_NAME=select CM.CURRENCY_ID,CM.CURRENCY_NAME,DECODE(CM.STATUS,'Y','Active','N','DeActive')STATUS,CM.SHORT_NAME,CM.SUB_CURRENCY from CURRENCY_MASTER CM where CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=CM.CURRENCY_ID)
GET_CURRENCY_NAME=SELECT   CM.CURRENCY_ID, CM.CURRENCY_NAME, DECODE (CM.STATUS, 'Y', 'Active', 'N', 'DeActive') STATUS, CM.SHORT_NAME, CM.SUB_CURRENCY FROM   CURRENCY_MASTER CM WHERE  Cm.COUNTRY_ID =(SELECT DESTINATION_COUNTRY_ID FROM BRANCH_MASTER BM WHERE BM.BRANCH_CODE=?) AND CM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER C WHERE   C.CURRENCY_ID = CM.CURRENCY_ID and CM.COUNTRY_ID=C.COUNTRY_ID)
GET_CURRENCY_NAME_LIST=select CM.CURRENCY_ID,CM.CURRENCY_NAME,DECODE(CM.STATUS,'Y','Active','N','DeActive')STATUS,CM.SHORT_NAME,CM.SUB_CURRENCY from CURRENCY_MASTER CM where CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=CM.CURRENCY_ID) and lower(CURRENCY_NAME) like lower(('%'||?||'%')) 
#INS_CURRENCY_MASTER=insert into CURRENCY_MASTER values((select MAX(CURRENCY_ID)+1 from CURRENCY_MASTER),?,?,'','',TO_DATE(?,'MM/DD/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER),?,?,?)
INS_CURRENCY_MASTER=insert into CURRENCY_MASTER (CURRENCY_ID, CURRENCY_NAME, AMEND_ID, INCEPTION_DATE, EXPIRY_DATE, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, STATUS, RSACODE, SNO__, COUNTRY_ID, DISPLAY_ORDER, SHORT_NAME, RFACTOR, SUB_CURRENCY) values((select MAX(CURRENCY_ID)+1 from CURRENCY_MASTER),?,?,'','',TO_DATE(?,'MM/DD/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER where country_id = (select country_id from branch_master where branch_code=?)),?,?,?)
#UPDATE_CURRENCY_MASTER=insert into CURRENCY_MASTER values(?,?,?,'','',TO_DATE(?,'MM/DD/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER),?,?,?)
UPDATE_CURRENCY_MASTER=insert into CURRENCY_MASTER (CURRENCY_ID, CURRENCY_NAME, AMEND_ID, INCEPTION_DATE, EXPIRY_DATE, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, STATUS, RSACODE, SNO__, COUNTRY_ID, DISPLAY_ORDER, SHORT_NAME, RFACTOR, SUB_CURRENCY) values(?,?,?,'','',TO_DATE(?,'MM/DD/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER where country_id = (select country_id from branch_master where branch_code=?)),?,?,?)
Check_currency_name=select count(CURRENCY_NAME) from CURRENCY_MASTER where upper(CURRENCY_NAME)=upper(?)
Check_currency=select count(RSACODE) from CURRENCY_MASTER where RSACODE=?
#EDIT_CURRENCY_MASTER= select CURRENCY_NAME,AMEND_ID,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,SHORT_NAME,RFACTOR,SUB_CURRENCY,REMARKS,RSACODE,STATUS,CURRENCY_ID from CURRENCY_MASTER where CURRENCY_ID=?
EDIT_CURRENCY_MASTER = SELECT   CURRENCY_NAME, AMEND_ID, TO_CHAR (EFFECTIVE_DATE, 'MM/DD/YYYY') EFFECTIVE_DATE, SHORT_NAME, RFACTOR, SUB_CURRENCY, REMARKS, RSACODE, STATUS, CURRENCY_ID FROM   CURRENCY_MASTER WHERE   CURRENCY_ID =? AND country_id = (SELECT   country_id FROM   branch_master WHERE   branch_code =?)
#GET_EXCHANGE_MASTER=select distinct(E.EXCHANGE_ID),E.EXCHANGE_RATE,CM.CURRENCY_NAME,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from EXCHANGE_MASTER E, CURRENCY_MASTER CM where E.AMEND_ID\=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID\=E.EXCHANGE_ID group by E.EXCHANGE_ID) and CM.CURRENCY_ID\=E.CURRENCY_ID
GET_EXCHANGE_MASTER=SELECT   DISTINCT (E.EXCHANGE_ID), E.EXCHANGE_RATE, CM.CURRENCY_NAME, DECODE (E.STATUS, 'Y', 'Active', 'N', 'DeActive') STATUS FROM   EXCHANGE_MASTER E, CURRENCY_MASTER CM WHERE       E.AMEND_ID \= (  SELECT   MAX (AMEND_ID) FROM   EXCHANGE_MASTER EM WHERE   EXCHANGE_ID \= E.EXCHANGE_ID and EM.country_id\=E.country_id ) AND CM.AMEND_ID \= (  SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER C WHERE   CURRENCY_ID \= CM.CURRENCY_ID and C.country_id\=CM.country_id ) AND CM.CURRENCY_ID \= E.CURRENCY_ID AND CM.COUNTRY_ID \= E.COUNTRY_ID AND cm.country_id \= (SELECT BELONGING_BRANCH FROM   branch_master WHERE   branch_code \=?)  
GET_EXCHANGE_MASTER_NAME=select distinct(E.EXCHANGE_ID),E.EXCHANGE_RATE,CM.CURRENCY_NAME,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from EXCHANGE_MASTER E, CURRENCY_MASTER CM where E.AMEND_ID=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID=E.EXCHANGE_ID group by E.EXCHANGE_ID) and CM.CURRENCY_ID=E.CURRENCY_ID and lower(CM.CURRENCY_NAME) like lower(('%'||?||'%'))  order by E.exchange_id
#GET_EXCHANGES=select CM.CURRENCY_ID, CM.CURRENCY_NAME FROM CURRENCY_MASTER CM where CM.AMEND_ID\=(select MAX(AMEND_ID) from CURRENCY_MASTER where CURRENCY_ID\=CM.CURRENCY_ID) order by currency_name
GET_EXCHANGES=select CM.CURRENCY_ID, CM.CURRENCY_NAME FROM CURRENCY_MASTER CM where CM.AMEND_ID\=(select MAX(AMEND_ID) from CURRENCY_MASTER where CURRENCY_ID\=CM.CURRENCY_ID and COUNTRY_ID\=CM.COUNTRY_ID) and COUNTRY_ID\=(select country_id from branch_master where branch_code\=?) order by currency_name 
#INS_EXCHANGE_MASTER=insert into EXCHANGE_MASTER values((select MAX(EXCHANGE_ID)+1 from EXCHANGE_MASTER),?,?,?,'','',TO_DATE(?,'MM/DD/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from EXCHANGE_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from EXCHANGE_MASTER))
INS_EXCHANGE_MASTER=insert into EXCHANGE_MASTER(EXCHANGE_ID,EXCHANGE_RATE,CURRENCY_ID,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS,RSACODE,SNO__,COUNTRY_ID,DISPLAY_ORDER) values((select MAX(EXCHANGE_ID)+1 from EXCHANGE_MASTER),?,?,?,'','',TO_DATE(?,'MM/DD/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from EXCHANGE_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from EXCHANGE_MASTER))
Check_exchange_name=select count(CURRENCY_ID) from EXCHANGE_MASTER where CURRENCY_ID=?
UPDATE_EXCHANGE_MASTER=insert into EXCHANGE_MASTER values(?,?,?,?,'','',TO_DATE(?,'MM/DD/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from EXCHANGE_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from EXCHANGE_MASTER))
#EDIT_EXCHANGE_MASTER=select E.CURRENCY_ID,E.AMEND_ID,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,E.EXCHANGE_RATE,E.REMARKS,E.RSACODE,E.STATUS,E.EXCHANGE_ID from EXCHANGE_MASTER E where EXCHANGE_ID\=? AND E.AMEND_ID\=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID\=E.EXCHANGE_ID group by E.EXCHANGE_ID)
EDIT_EXCHANGE_MASTER=select E.CURRENCY_ID,E.AMEND_ID,TO_CHAR(E.EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,E.EXCHANGE_RATE,E.REMARKS,E.RSACODE,E.STATUS,E.EXCHANGE_ID from EXCHANGE_MASTER E where E.EXCHANGE_ID\=? AND E.COUNTRY_ID\=(SELECT COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE\=?) AND E.AMEND_ID\=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID\=E.EXCHANGE_ID AND COUNTRY_ID\=E.COUNTRY_ID group by E.EXCHANGE_ID)
Check_exchange=select count(RSACODE) from EXCHANGE_MASTER where RSACODE=?
#GET_COVER_NAME=select C.COVER_NAME,M.TRANSPORT_DESCRIPTION,C.COVER_RATE,DECODE(C.STATUS,'Y','Active','N','DeActive')STATUS,C.COVER_ID from COVER_MASTER C, MODE_OF_TRANSPORT M where C.branch_code=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID) and M.MODE_TRANSPORT_ID=C.MODE_TRANSPORT_ID  AND C.MODE_TRANSPORT_ID = M.MODE_TRANSPORT_ID AND M.BRANCH_CODE=C.BRANCH_CODE AND  C.BRANCH_CODE=?
GET_COVER_NAME=SELECT  C.COVER_NAME,M.TRANSPORT_DESCRIPTION,C.COVER_RATE,DECODE (C.STATUS,'Y', 'Active','N','DeActive') STATUS, C.COVER_ID  FROM   COVER_MASTER C, MODE_OF_TRANSPORT M WHERE  C.branch_code = ? AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   COVER_MASTER CM  WHERE   CM.COVER_ID = C.COVER_ID  AND CM.BRANCH_CODE =C.BRANCH_CODE)  AND M.MODE_TRANSPORT_ID = C.MODE_TRANSPORT_ID   AND C.MODE_TRANSPORT_ID = M.MODE_TRANSPORT_ID AND M.BRANCH_CODE = C.BRANCH_CODE order by C.DISPLAY_ORDER
GET_COVER_NAME_LIST=select C.COVER_NAME,C.COVER_ID from COVER_MASTER C where C.branch_code=? and c.MODE_TRANSPORT_ID=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID)  AND  C.BRANCH_CODE=?
#INS_COVER_MASTER=insert into COVER_MASTER values((select MAX(SNO__)+1 from COVER_MASTER),(select MAX(COVER_ID)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),(select MAX(DISPLAY_ORDER)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,'N','',?,?,'')
#INS_COVER_MASTER=insert into COVER_MASTER (SNO__, COVER_ID, COVER_NAME,MODE_TRANSPORT_ID, DESCRIPTION, RSACODE,AMEND_ID, EFFECTIVE_DATE, DISPLAY_ORDER,BRANCH_CODE, COVER_RATE, REFERAL_STATUS,REFERAL_VALUE, REMARKS, STATUS) values(( select MAX(SNO__)+1 from COVER_MASTER),( select MAX(COVER_ID)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),( select MAX(DISPLAY_ORDER)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,'',?,?)
INS_COVER_MASTER=insert into COVER_MASTER (SNO__, COVER_ID, COVER_NAME,MODE_TRANSPORT_ID, DESCRIPTION, RSACODE,AMEND_ID, EFFECTIVE_DATE, DISPLAY_ORDER,BRANCH_CODE, COVER_RATE, REFERAL_STATUS,REFERAL_VALUE, REMARKS, STATUS) values(( select MAX(SNO__)+1 from COVER_MASTER),( select MAX(COVER_ID)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),( select MAX(DISPLAY_ORDER)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,'',?,?)
#UPDATE_COVER_MASTER=insert into COVER_MASTER values((select MAX(SNO__)+1 from COVER_MASTER),?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,'N','',?,?,'')
UPDATE_COVER_MASTER=UPDATE COVER_MASTER cm SET  COVER_NAME\=?,MODE_TRANSPORT_ID\=?, DESCRIPTION\=?, RSACODE\=?, EFFECTIVE_DATE\=TO_DATE(?,'MM/DD/YYYY'), DISPLAY_ORDER\=?, COVER_RATE\=?, REFERAL_STATUS\=?,REMARKS\=?, STATUS\=? WHERE COVER_ID\=? and cm.branch_code\=? and cm.amend_id\=(select max(amend_id) from COVER_MASTER CC where cc.cover_id\=cm.cover_id and cc.branch_code\=cm.branch_code)
UPDATE_COVER_MASTER_INSERT=insert into COVER_MASTER (   SNO__, COVER_ID, COVER_NAME,MODE_TRANSPORT_ID, DESCRIPTION, RSACODE,AMEND_ID, EFFECTIVE_DATE, DISPLAY_ORDER,BRANCH_CODE, COVER_RATE, REFERAL_STATUS,REFERAL_VALUE, REMARKS, STATUS,COVER_ARABIC) values ((select MAX(SNO__)+1 from COVER_MASTER),?,?,?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),?,?,?,?,?,?,?,?)
#EDIT_COVER_MASTER=select COVER_ID,COVER_NAME,DESCRIPTION,MODE_TRANSPORT_ID,COVER_RATE,STATUS,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,RSACODE,REMARKS,AMEND_ID from COVER_MASTER where COVER_ID=? and BRANCH_CODE=?
EDIT_COVER_MASTER=select COVER_ID,COVER_NAME,DESCRIPTION,MODE_TRANSPORT_ID,COVER_RATE,STATUS,TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,RSACODE,REMARKS,AMEND_ID,REFERAL_STATUS from COVER_MASTER where COVER_ID=? and BRANCH_CODE=?
Check_cover_name=select count(COVER_NAME) from COVER_MASTER where upper(COVER_NAME)=upper(?) and BRANCH_CODE=?
Check_cover=select count(RSACODE) from COVER_MASTER where RSACODE=? and BRANCH_CODE=?
GET_EXCLUSION_LIST=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS,DECODE(STATUS,'Y','Active','N','DeActive')STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=?
GET_EXCLUSION_BY_NAME=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS, DECODE(STATUS,'Y','Active','N','DeActive') STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=? and lower(EXCLUSION_DESCRIPTION) like lower('%'||?||'%')
Check_exclusion_name= select count(EXCLUSION_DESCRIPTION) from exclusion_master where lower(EXCLUSION_DESCRIPTION)=lower(?) and BRANCH_CODE=?
Check_Exclusion=select distinct(rsacode) from exclusion_master where rsacode=? and branch_code=?
INS_EXCLUSION_MASTER=insert into exclusion_master(SNO__,EXCLUSION_ID,EXCLUSION_DESCRIPTION,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER,INT_CODE) values((select max(SNO__)+1 from exclusion_master),(select max(EXCLUSION_ID)+1 from exclusion_master where branch_code=?), ?,?,?,?,?,(select max(EXCLUSION_ID)+1 from exclusion_master where branch_code=?), 'E'||?)
EDIT_EXCLUSION_MASTER=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS,STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=? and exclusion_id=?
UPDATE_EXCLUSION_MASTER=UPDATE EXCLUSION_MASTER SET EXCLUSION_DESCRIPTION=?,REMARKS=?,RSACODE=?,STATUS=?,INT_CODE='E'||? WHERE EXCLUSION_ID=? AND BRANCH_CODE=?
GET_ERROR_MASTER=select EM.ERROR_ID,EM.ERROR_DESC,SM.STAGE_DESC,PM.PRODUCT_NAME,DECODE(EM.STATUS,'Y','Active','N','DeActive')STATUS FROM  ERROR_MASTER EM,STAGE_MASTER SM,PRODUCT_MASTER PM WHERE EM.STAGE_ID=SM.STAGE_ID AND EM.PRODUCT_ID=PM.PRODUCT_ID and SM.PRODUCT_ID=PM.PRODUCT_ID  AND PM.BRANCH_CODE=?
GET_ERROR_LIST_NAME=select EM.ERROR_ID,EM.ERROR_DESC,SM.STAGE_DESC,PM.PRODUCT_NAME,DECODE(EM.STATUS,'Y','Active','N','DeActive')STATUS FROM  ERROR_MASTER EM,STAGE_MASTER SM,PRODUCT_MASTER PM WHERE EM.STAGE_ID=SM.STAGE_ID AND EM.PRODUCT_ID=PM.PRODUCT_ID and SM.PRODUCT_ID=PM.PRODUCT_ID AND PM.BRANCH_CODE=? AND LOWER(ERROR_DESC) LIKE LOWER(('%'||?||'%'))
EDIT_ERROR_MASTER=SELECT PRODUCT_ID,STAGE_ID,ERROR_DESC,REMARKS,STATUS,ERROR_ID from ERROR_MASTER WHERE ERROR_ID=?
UPDATE_ERROR_MASTER=UPDATE ERROR_MASTER SET ERROR_DESC=?,PRODUCT_ID=?,STAGE_ID=?,REMARKS=?,STATUS=? WHERE ERROR_ID=?
GET_ERROR_MASTER_LIST=SELECT ERROR_DESC,PRODUCT_NAME,STAGE_DESC,REMARKS,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from ERROR_MASTER where ERROR_ID=?
Check_name_error=select count(ERROR_DESC) from ERROR_MASTER where PRODUCT_ID=? and STAGE_ID=? and upper(ERROR_DESC)=upper(?)
GET_PRODUCT_NAME_LIST=select PRODUCT_ID,PRODUCT_NAME from PRODUCT_MASTER where BRANCH_CODE=?
GET_VESSEL_TYPE_LIST=SELECT DISTINCT (VESSEL_TYPE) FROM VESSEL_MASTER 
GET_STAGE_NAME_LIST=select STAGE_ID,STAGE_DESC from STAGE_MASTER where PRODUCT_ID=?
GET_CLAUSE_ID_LIST_NAME=SELECT C.CLAUSES_ID, C.CLAUSES_DESCRIPTION, C.DISPLAY_ORDER,DECODE (C.STATUS,'Y','Active','N','DeActive')STATUS,COV.COVER_NAME FROM   CLAUSES_MASTER C, COVER_MASTER COV WHERE C.BRANCH_CODE \= ? AND C.COVER_ID\=COV.COVER_ID AND COV.BRANCH_CODE\=? AND LOWER (C.CLAUSES_DESCRIPTION) LIKE LOWER ( ('%' || ? || '%')) AND COV.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID\=COV.COVER_ID) 
GET_CLAUSE_ID_MASTER=SELECT C.CLAUSES_ID,COV.MODE_TRANSPORT_ID,(select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT mt where COV.MODE_TRANSPORT_ID=mt.MODE_TRANSPORT_ID and branch_code=?)TRANSPORT_DESCRIPTION,C.COVER_ID,COV.COVER_NAME,C.CLAUSES_DESCRIPTION,C.RSACODE,C.DISPLAY_ORDER,C.REMARKS,DECODE (C.STATUS,'Y','Active','N','DeActive')STATUS,COV.COVER_NAME FROM CLAUSES_MASTER C, COVER_MASTER COV WHERE   C.BRANCH_CODE = ? AND C.COVER_ID = COV.COVER_ID AND COV.BRANCH_CODE=? AND C.EXTRA_COVER_ID = 0 AND COV.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=COV.COVER_ID)
GET_WSRCC_LIST=SELECT C.CLAUSES_ID,COV.MODE_TRANSPORT_ID,(select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT mt where COV.MODE_TRANSPORT_ID=mt.MODE_TRANSPORT_ID and branch_code=?)TRANSPORT_DESCRIPTION,C.COVER_ID,COV.COVER_NAME,C.CLAUSES_DESCRIPTION,C.RSACODE,C.DISPLAY_ORDER,C.REMARKS,DECODE (C.STATUS,'Y','Active','N','DeActive')STATUS,COV.COVER_NAME FROM CLAUSES_MASTER C, COVER_MASTER COV WHERE   C.BRANCH_CODE = ? AND C.COVER_ID = COV.COVER_ID AND COV.BRANCH_CODE=? AND C.EXTRA_COVER_ID = 1 AND COV.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=COV.COVER_ID)
#INS_CLAUSE_ID_MASTER=INSERT INTO CLAUSES_MASTER (SNO__,COVER_ID,CLAUSES_ID,CLAUSES_DESCRIPTION,EXTRA_COVER_ID,RSACODE,DISPLAY_ORDER,STATUS,BRANCH_CODE) VALUES ((SELECT MAX(SNO__)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,(SELECT MAX(CLAUSES_ID)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,?)
INS_CLAUSE_ID_MASTER=INSERT INTO CLAUSES_MASTER (SNO__,COVER_ID,CLAUSES_ID,CLAUSES_DESCRIPTION,EXTRA_COVER_ID,RSACODE,DISPLAY_ORDER,REMARKS,STATUS,BRANCH_CODE,PDF_LOCATION,INT_CODE) VALUES ((SELECT MAX(SNO__)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,(SELECT MAX(CLAUSES_ID)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,?,?,?,'C'||?)
Check_display_order=select count(DISPLAY_ORDER) from CLAUSES_MASTER where BRANCH_CODE=? and DISPLAY_ORDER=?
#UPDATE_CLAUSE_ID_MASTER=UPDATE CLAUSES_MASTER SET COVER_ID=?,CLAUSES_DESCRIPTION=?,STATUS=?,RSACODE=?,DISPLAY_ORDER=? WHERE CLAUSES_ID=? AND BRANCH_CODE=? AND EXTRA_COVER_ID=?
UPDATE_CLAUSE_ID_MASTER=UPDATE CLAUSES_MASTER SET CLAUSES_DESCRIPTION=?,STATUS=?,RSACODE=?,DISPLAY_ORDER=?,REMARKS=?,PDF_LOCATION=?,INT_CODE='C'||? WHERE CLAUSES_ID=? AND BRANCH_CODE=? AND EXTRA_COVER_ID=? and COVER_ID=?
EDIT_CLAUSE_ID_MASTER=SELECT CM.CLAUSES_ID,CMT.COVER_ID,CM.CLAUSES_DESCRIPTION,CM.EXTRA_COVER_ID,CM.RSACODE,CM.DISPLAY_ORDER,CM.STATUS,CM.REMARKS,(SELECT CMT.MODE_TRANSPORT_ID FROM MODE_OF_TRANSPORT MT WHERE MT.MODE_TRANSPORT_ID\=CMT.MODE_TRANSPORT_ID AND BRANCH_CODE\=?) MODE_TRANSPORT_ID,CM.PDF_LOCATION FROM CLAUSES_MASTER CM,COVER_MASTER CMT WHERE CM.COVER_ID\=CMT.COVER_ID AND CM.CLAUSES_ID\=? and CM.BRANCH_CODE\=?
Check_vessel_name=SELECT COUNT(VESSEL_NAME) FROM VESSEL_MASTER WHERE upper(VESSEL_NAME)=upper(?)
Check_ClauseID=SELECT DISTINCT(RSACODE) FROM CLAUSES_MASTER where RSACODE=? and BRANCH_CODE=?
#UPDATE_COMMODITY_MASTER_UPDATE=UPDATE COMMODITYMASTER CM SET COMMODITY_NAME \= ?,COMMODITY_RATE \= ?,COVERAGE_REFERAL \=?,ICC_A_SEA \= ?,ICC_B_SEA \= ?,ICC_C_SEA \= ?,ICC_AIR_CARGO_AIR \=?,ALL_RISKS_LAND_TRANSIT_LAND \=?,LAND_TRANSIT_LAND \=?,ALL_RISKS_PARCEL_POST_AIR \=?,ALL_RISKS_SEA_AND_AIR \= ?, ICC_C_NONDELIVERY\=?, ICC_A_FROZEN_FOOD_SEA\=?, ICC_C_FROZEN_FOOD_SEA\=?, ICC_A_FROZEN_MEAT_SEA\=?, ICC_C_FROZEN_MEAT_SEA\=?, REMARKS \= ?,STATUS \= ?,RSACODE \= ?,EFFECTIVE_DATE \= TO_DATE (?, 'MM/DD/YYYY'),COMMODITY_TYPE_ID \= ? WHERE COMMODITY_ID \= ? AND BRANCH_CODE \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID)FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID)
UPDATE_COMMODITY_MASTER_UPDATE=UPDATE COMMODITYMASTER CM SET GROUP_ID \= ?, COMMODITY_NAME \= ?,COMMODITY_RATE \= ?,COVERAGE_REFERAL \=?,ICC_A_SEA \= ?,ICC_B_SEA \= ?,ICC_C_SEA \= ?,ICC_C_NONDELIVERY\=?, ICC_A_FROZEN_MEAT_SEA\=?,ICC_A_FROZEN_FOOD_SEA\=?,  ICC_C_FROZEN_MEAT_SEA\=?,ICC_C_FROZEN_FOOD_SEA\=?,ICC_AIR_CARGO_AIR \=?,ICC_AIR_CARGO_ALL_RISKS\=? ,ALL_RISKS_LAND_TRANSIT_LAND \=?,LAND_TRANSIT_LAND\=?,ALL_RISKS_PARCEL_POST_AIR \=?,ALL_RISKS_SEA_AND_AIR \= ?,REMARKS \= ?,STATUS \= ?,RSACODE \= ?,EFFECTIVE_DATE \= TO_DATE (?, 'MM/DD/YYYY'),RAG \= ? WHERE COMMODITY_ID \= ? AND BRANCH_CODE \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID)FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID)      
Check_Categ=SELECT COUNT(DETAIL_NAME) FROM COMMODITY_CATEGORY_MASTER WHERE upper(DETAIL_NAME)\=upper(?) and BRANCH_CODE\=?      
#Portfolio
GET_PRODUCTS=select PRODUCT_ID,PRODUCT_NAME from PRODUCT_MASTER where BRANCH_CODE=?
GET_PORTFOLIO_BY_DATE=select pm.application_no,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,md.premium,nvl(md.EXCESS_PREMIUM,'0'),pi.COMPANY_NAME,pi.LAST_NAME,pm.quote_no,md.remarks,pm.PDF_MODIFY_CLAUSE,pm.PDF_MODIFY_WARRANTY,pm.PDF_MODIFY_EXCLUSION,pm.PDF_MODIFY_EXTRACLAUSES,pm.PRODUCT_ID,Policy_Cancel_Status,nvl(pm.open_cover_no,'0'),pm.application_id,nvl(md.ADMIN_REFERRAL_STATUS,'N'),to_char(pm.entry_date,'MM/DD/YYYY') from position_master pm,marine_data md,personal_info pi where to_char(pm.entry_date,'MM/DD/YYYY')=? and pm.application_no=md.application_no and pi.customer_id=pm.customer_id and pm.remarks in ('Normal')  and  pm.product_id in (11,3) and lower(pm.status) in('y') and nvl(pm.open_cover_int_status,'0') not in ('LINKED') and (md.ADMIN_REFERRAL_STATUS in('N') or md.ADMIN_REFERRAL_STATUS is null) and pm.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))   order by pm.quote_no desc
GET_BRANCH_REPORT_LIST=select ENTRY_DATE,BRANCH_NAME,LOGIN_ID,APPLICATIONID,QUOTE_NO,APPLICATION_NO,POLICY_NO,INCEPTION_DATE,EFFECTIVE_DATE,PRODUCT_ID,CUSTOMER_NAME,TRANSPORT_DESCRIPTION,COVER_NAME,SALE_TERM_NAME,TOTAL_SLAE_TERM_CHARGES,TOTAL_TOLERANCE_CHARGES,EXTRA_COVER_NAME,SUM_INSURED_LOCAL,CURRENCY_NAME,EXCHANGE_RATE,SUM_INSURED_FOREIGN,BASIC_PREMIUM,TOTAL_WAR_CHARGES,EXCESS_PREMIUM,POLICY_FEE,TOTAL_PREMIUM_LOCAL,FOREIGN_CURRENCY,TOTAL_PREMIUM_FOREIGN,COMMISSION,TRANSIT_FROM_CITY,TRANSIT_FROM_COUNTRY,FINAL_DEST_CITY,FINAL_DESTINATION_COUNTRY,DEBIT_NOTE_NO,REFERRAL,REFERAL_STATUS,STATUS,INTEGRATION_STATUS,INTEGRATION_ERROR from table(AdminReports(?,?,?)) where Product_id=?
GET_BRANCH_NAME_LIST=SELECT BRANCH_NAME,BRANCH_CODE FROM BRANCH_MASTER WHERE BRANCH_CODE=?
GET_EXCHANGE_REPORT_LIST=SELECT A.EXCHANGE_RATE,B.CURRENCY_NAME,A.AMEND_ID,TO_CHAR(A.EFFECTIVE_DATE,'DD-MM-YYYY') EFFECTIVE_DATE,A.CURRENCY_ID FROM EXCHANGE_MASTER A, CURRENCY_MASTER B WHERE A.CURRENCY_ID\=B.CURRENCY_ID AND A.COUNTRY_ID\=B.COUNTRY_ID AND A.COUNTRY_ID\=? AND A.AMEND_ID||A.EXCHANGE_ID||A.CURRENCY_ID IN(SELECT MAX(AMEND_ID)||EXCHANGE_ID||CURRENCY_ID FROM EXCHANGE_MASTER WHERE NVL(TO_DATE(?,'dd-mm-yyyy'),SYSDATE)+ 10 / 24 BETWEEN EFFECTIVE_DATE AND EXPIRY_DATE AND STATUS\='Y' AND COUNTRY_ID\=? GROUP BY EXCHANGE_ID,CURRENCY_ID) AND NVL(TO_DATE(?,'dd-mm-yyyy'),SYSDATE)+ 10 / 24 BETWEEN A.EFFECTIVE_DATE AND A.EXPIRY_DATE AND A.STATUS\='Y' AND B.STATUS\='Y' AND B.STATUS\='Y' AND A.STATUS\='Y' AND  B.AMEND_ID||B.CURRENCY_ID IN(SELECT MAX(AMEND_ID)||CURRENCY_ID FROM CURRENCY_MASTER WHERE EFFECTIVE_DATE <\=SYSDATE+10/24 AND STATUS\='Y' AND COUNTRY_ID\=? GROUP BY CURRENCY_ID) ORDER BY A.DISPLAY_ORDER
branch.wise.country=SELECT ORIGINATION_COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE=?
get.tax.info=SELECT DETAIL_NAME,PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID\='149' AND BRANCH_CODE\=?
update_pm_deposit=update POSITION_MASTER set DEPOSIT_REFERRAL\=? where application_no\=?
GET_PORTFOLIO_BY_DATE1=select rownum SNO,ENTRY_DATE,COU from(select to_char(a.entry_date,'YYYY-MM-DD') ENTRY_DATE ,count(a.entry_date) COU from position_master a,marine_data b,personal_info c where  a.entry_date between to_date(?,'dd/mm/yyyy') and to_date(?,'dd/mm/yyyy')+1 and a.remarks in ('Normal') and (b.ADMIN_REFERRAL_STATUS in('N') or b.ADMIN_REFERRAL_STATUS is null) and a.customer_id\=c.customer_id and a.application_no\=b.application_no  and lower(a.status) in (?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_QUOTE1=select rownum SNO,ENTRY_DATE,COU from(select to_char(a.entry_date,'YYYY-MM-DD') ENTRY_DATE ,count(a.entry_date) COU from position_master a,marine_data b,personal_info c where  a.quote_no =? and a.remarks in ('Normal') and (b.ADMIN_REFERRAL_STATUS in('N') or b.ADMIN_REFERRAL_STATUS is null) and a.customer_id\=c.customer_id and a.application_no\=b.application_no  and lower(a.status) in (?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?) 
GET_PORTFOLIO_BY_DATE_APPEND1=) group by to_char(a.entry_date,'YYYY-MM-DD') order by to_char(a.entry_date,'YYYY-MM-DD') desc)
GET_PORTFOLIO_BY_DATE2=select rownum SNO,ENTRY_DATE,COU from(select to_char(a.inception_date,'YYYY-MM-DD')ENTRY_DATE,count(a.inception_date) COU from position_master a,marine_data b,personal_info c where  a.inception_date between to_date(?,'dd/mm/yyyy') and to_date(?,'dd/mm/yyyy')+1  and   a.customer_id=c.customer_id and a.application_no=b.application_no  and   lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_QUOTE2=select rownum SNO,ENTRY_DATE,COU from(select to_char(a.inception_date,'YYYY-MM-DD')ENTRY_DATE,count(a.inception_date) COU from position_master a,marine_data b,personal_info c where a.quote_no=?  and   a.customer_id=c.customer_id and a.application_no=b.application_no  and   lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_DATE_APPEND2=)  group by to_char(a.inception_date,'YYYY-MM-DD') order by to_char(a.inception_date,'YYYY-MM-DD') desc)
GET_PORTFOLIO_BY_POLICY1=select rownum SNO,ENTRY_DATE,COU from(select to_char(a.inception_date,'YYYY-MM-DD')ENTRY_DATE,count(a.inception_date) COU from position_master a,marine_data b,personal_info c where  (a.policy_no = ? OR a.original_policy_no = ?)  and   a.customer_id=c.customer_id and a.application_no=b.application_no  and   lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_DATE_POLICY2=)  group by to_char(a.inception_date,'YYYY-MM-DD') order by to_char(a.inception_date,'YYYY-MM-DD') desc)
#Date
CHECK_DATE_CONVEYAN=SELECT  COUNT (EFFECTIVE_DATE)FROM CONVEYAN_MASTER WHERE BRANCH_CODE\=? AND CONVDESC \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID)FROM CONVEYAN_MASTER WHERE CONVDESC \= ? AND BRANCH_CODE\=?)AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_COUNTRY=SELECT COUNT (EFFECTIVE_DATE)FROM COUNTRY_MASTER WHERE COUNTRY_ID \= ? and amend_id \= (SELECT MAX (amend_id) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_COUNTRY_DETAIL=SELECT COUNT (EFFECTIVE_DATE)FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID \= ? and amend_id \= (SELECT MAX (amend_id) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_BANK=SELECT COUNT (EFFECTIVE_DATE) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME \= ? and   amend_id \= (SELECT MAX (amend_id) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_MATERIAL=SELECT COUNT(EFFECTIVE_DATE) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_DESC \= ? and BRANCH_CODE\=? and amend_id \= (SELECT   MAX (amend_id) FROM MATERIAL_TYPE_MASTER WHERE BRANCH_CODE\=? and MATERIAL_DESC \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_WAR=SELECT COUNT(EFFECTIVE_DATE) FROM WAR_RATE_MASTER WHERE WAR_DESC \= ? and MODE_TRANSPORT_ID\=? and BRANCH_CODE\=? and amend_id \= (SELECT MAX (amend_id) FROM WAR_RATE_MASTER WHERE WAR_DESC \= ? and MODE_TRANSPORT_ID\=? and BRANCH_CODE\=?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_COMMODITY_EXCESS=SELECT COUNT(EFFECTIVE_DATE)  FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED \= ? and END_SUM_INSURED\=? and BRANCH_CODE\=? and amend_id \= (SELECT MAX(amend_id) FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED \= ? and END_SUM_INSURED\=? and BRANCH_CODE\=?)  AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_EXCHANGE=SELECT COUNT (EFFECTIVE_DATE) FROM EXCHANGE_MASTER WHERE CURRENCY_ID\=?  and amend_id \= (SELECT   MAX (amend_id) FROM  EXCHANGE_MASTER WHERE CURRENCY_ID\=? ) AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)
CHECK_DATE_COVER=SELECT COUNT(EFFECTIVE_DATE) FROM COVER_MASTER WHERE COVER_ID\=? and BRANCH_CODE\=?  and   amend_id \= (SELECT MAX (amend_id)FROM COVER_MASTER WHERE COVER_ID\=? and BRANCH_CODE\=?)  AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'MM/DD/YYYY'), 'MM/DD/YYYY') FROM DUAL)

#Rating Engine

#UPDATE_CONVEYAN_MASTER_UPDATE=UPDATE CONVEYAN_MASTER E SET E.CONVDESC=?,E.CONV_RATE=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.REMARKS=? WHERE E.BRANCH_CODE=? AND E.CONV_MEAN=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN=E.CONV_MEAN)
UPDATE_CONVEYAN_MASTER_UPDATE=UPDATE CONVEYAN_MASTER E SET E.CONVDESC=?,E.CONV_RATE=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.REMARKS=?,E.CORE_APP_ID=? WHERE E.BRANCH_CODE=? AND E.CONV_MEAN=? AND E.MODE_TRANSPORT_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN=E.CONV_MEAN AND BRANCH_CODE=E.BRANCH_CODE AND MODE_TRANSPORT_ID=E.MODE_TRANSPORT_ID)
#UPDATE_COUNTRY_MASTER_UPDATE=UPDATE COUNTRY_MASTER E SET E.COUNTRY_NAME\=?,E.GEO_RATE\=?,E.EFFECTIVE_DATE\= TO_DATE(?,'MM/DD/YYYY'),E.STATUS\=?,COUNTRY_SHORT_NAME\=? WHERE E.COUNTRY_ID\=? AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID\=E.COUNTRY_ID) 
UPDATE_COUNTRY_MASTER_UPDATE=UPDATE COUNTRY_MASTER E SET E.COUNTRY_NAME=?,E.GEO_RATE=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,COUNTRY_SHORT_NAME=?,NATIONALITY_NAME=?,RSACODE=?,REMARKS=? WHERE E.COUNTRY_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID)FROM COUNTRY_MASTER WHERE COUNTRY_ID=E.COUNTRY_ID)
#UPDATE_COUNTRYDET_UPDATE=UPDATE COUNTRY_MASTER_DETAIL E SET E.COUNTRY_NAME=?,E.COUNTRY_SHORT_NAME=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.WAR_RATE=?,E.ENDING_PLACE=?,E.EP_WARRANTIES_CONDITIONS=?,E.NATIONALITY_NAME=?,E.REMARKS=?,E.SP_WARRANTIES_CONDITIONS=?,E.STARTING_PLACE=? WHERE E.COUNTRY_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=E.COUNTRY_ID)
UPDATE_COUNTRYDET_UPDATE=UPDATE COUNTRY_MASTER_DETAIL E SET E.COUNTRY_NAME=?,E.COUNTRY_SHORT_NAME=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.WAR_RATE=?,E.ENDING_PLACE=?,E.EP_WARRANTIES_CONDITIONS=?,E.NATIONALITY_NAME=?,E.REMARKS=?,E.SP_WARRANTIES_CONDITIONS=?,E.STARTING_PLACE=? ,RSACODE=?,CROSS_VOYAGE_YN=?,CROSS_VOYAGE_ORG_COUNTRY=?,CROSS_VOYAGE_DEST_COUNTRY=? WHERE E.COUNTRY_ID=? AND E.BELONGING_COUNTRY_ID=(select BELONGING_BRANCH from branch_master where branch_code=?) AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=E.COUNTRY_ID AND BELONGING_COUNTRY_ID=E.BELONGING_COUNTRY_ID)
#UPDATE_BANK_MASTER_UPDATE=UPDATE OPEN_COVER_BANK_MASTER E SET E.BANK_NAME=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.REMARKS=? WHERE E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE bank_id=E.bank_id) and e.bank_id=?
UPDATE_BANK_MASTER_UPDATE=UPDATE OPEN_COVER_BANK_MASTER E SET E.BANK_NAME=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.RSACODE=?, E.REMARKS=? WHERE E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE bank_id=E.bank_id) and e.bank_id=?
#UPDATE_MATERIAL_TYPE_MASTER_UPDATE=UPDATE MATERIAL_TYPE_MASTER E SET E.MATERIAL_DESC=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.MATERIAL_RATE=?,E.STATUS=?,E.REMARKS=?,E.CORE_APP_ID=? WHERE E.MATERIAL_DESC=? AND E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_DESC=E.MATERIAL_DESC)
UPDATE_MATERIAL_TYPE_MASTER_UPDATE=UPDATE MATERIAL_TYPE_MASTER E SET E.MATERIAL_DESC=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.MATERIAL_RATE=?,E.STATUS=?,E.REMARKS=?,E.CORE_APP_ID=? WHERE E.MATERIAL_ID=? AND E.COVER_ID=? AND E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID=E.MATERIAL_ID AND COVER_ID=E.COVER_ID AND BRANCH_CODE=E.BRANCH_CODE)
#UPDATE_WAR_RATE_MASTER_INSERT=INSERT INTO WAR_RATE_MASTER VALUES((SELECT MAX(SNO)+1 FROM WAR_RATE_MASTER),?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),(SELECT MAX(AMEND_ID)+1 FROM WAR_RATE_MASTER WHERE BRANCH_CODE=? AND WAR_ID=?),?,?,?,?)
UPDATE_WAR_RATE_MASTER_INSERT=INSERT INTO WAR_RATE_MASTER (SNO, WAR_ID, WAR_DESC, WAR_RATE, MODE_TRANSPORT_ID, EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID, STATUS,REMARKS)VALUES((SELECT MAX(SNO)+1 FROM WAR_RATE_MASTER),?,?,?,?,TO_DATE(?,'MM/DD/YYYY'),(SELECT MAX(AMEND_ID)+1 FROM WAR_RATE_MASTER WHERE BRANCH_CODE=? AND WAR_ID=? AND MODE_TRANSPORT_ID=?),?,?,?,?)
#UPDATE_COMEX_INSERT=INSERT INTO COMMODITY_EXCESS_PREMIUM VALUES((SELECT MAX(SNO)+1 FROM COMMODITY_EXCESS_PREMIUM),?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM COMMODITY_EXCESS_PREMIUM WHERE BRANCH_CODE=? AND START_SUM_INSURED=? AND END_SUM_INSURED=? ),TO_DATE(?,'MM/DD/YYYY'),?,?,?)
UPDATE_COMEX_INSERT=INSERT INTO COMMODITY_EXCESS_PREMIUM (SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE , RATE, AMEND_ID, EFFECTIVE_DATE,BRANCH_CODE,STATUS) VALUES(?,?,?,?,?,( SELECT MAX(AMEND_ID)+1 FROM COMMODITY_EXCESS_PREMIUM WHERE BRANCH_CODE=?  AND SNO=? ),TO_DATE(?,'MM/DD/YYYY'),?,?)
UPDATE_EXCHANGE_MASTER_UPDATE=UPDATE EXCHANGE_MASTER E SET E.EXCHANGE_RATE=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.REMARKS=?,E.RSACODE=? WHERE E.EXCHANGE_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EXCHANGE_MASTER WHERE EXCHANGE_ID=E.EXCHANGE_ID)
UPDATE_COVER_MASTER_UPDATE=UPDATE COVER_MASTER E SET E.DESCRIPTION=?,E.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),E.STATUS=?,E.REMARKS=?,E.COVER_RATE=? WHERE E.EXCHANGE_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=E.COVER_ID)
#UPDATE_CURRENCY_MASTER_UPDATE=UPDATE CURRENCY_MASTER C SET C.CURRENCY_NAME=?,C.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),C.REMARKS=?,C.RFACTOR=?,C.RSACODE=?,C.SHORT_NAME=?,C.STATUS=?,C.SUB_CURRENCY=? WHERE C.CURRENCY_ID=? AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=C.CURRENCY_ID)
UPDATE_CURRENCY_MASTER_UPDATE=UPDATE CURRENCY_MASTER C SET C.CURRENCY_NAME=?,C.EFFECTIVE_DATE=TO_DATE(?,'MM/DD/YYYY'),C.REMARKS=?,C.RFACTOR=?,C.RSACODE=?,C.SHORT_NAME=?,C.STATUS=?,C.SUB_CURRENCY=? WHERE C.CURRENCY_ID=? AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=C.CURRENCY_ID and country_id = (select country_id from branch_master where branch_code=?))

##
GET_COUNTRY_NAME_DET=select E.COUNTRY_NAME from COUNTRY_MASTER E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME\=E.COUNTRY_NAME)order by E.COUNTRY_NAME
#GET_COUNTRY_NAME=select E.COUNTRY_NAME,E.COUNTRY_ID from COUNTRY_MASTER_DETAIL E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID\=E.COUNTRY_ID)order by E.COUNTRY_NAME
GET_COUNTRY_NAME=select E.COUNTRY_NAME,E.COUNTRY_ID from COUNTRY_MASTER E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID\=E.COUNTRY_ID)order by E.COUNTRY_NAME
#GET_COUNTRY_NEW_NAME=select distinct(e.country_name),e.country_id from country_master E where not exists (select country_name from country_master_detail cm where e.country_id=cm.country_id) and E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE country_id=E.country_id) order by country_name
GET_COUNTRY_NEW_NAME=select distinct(e.country_name),e.country_id from country_master E where not exists (select country_name from country_master_detail cm where e.country_id\=cm.country_id) and E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE country_id\=E.country_id) and STATUS\='Y' order by country_name 
CHECK_COM_EX_COUNT_START=select count(*) from commodity_excess_premium where branch_code=? and START_SUM_INSURED between ? and (select MAX(START_SUM_INSURED) from commodity_excess_premium)

CHECK_COM_EX_COUNT_END=select count(*) from commodity_excess_premium where branch_code\=? and END_SUM_INSURED between ? and (select MAX(END_SUM_INSURED) from commodity_excess_premium)
CHECK_COVER_NAME=select count(C.COVER_NAME) from COVER_MASTER C, MODE_OF_TRANSPORT M where C.branch_code\=? and c.mode_transport_id\=? and C.AMEND_ID\=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID\=C.COVER_ID) and M.MODE_TRANSPORT_ID\=C.MODE_TRANSPORT_ID  AND C.MODE_TRANSPORT_ID \= M.MODE_TRANSPORT_ID AND M.BRANCH_CODE\=C.BRANCH_CODE AND  C.BRANCH_CODE\=? and cover_name\=(select cover_name from cover_master where cover_id\=? and branch_code\=?)
GET_COVER=select C.COVER_NAME,C.COVER_ID from COVER_MASTER C where C.branch_code=? and c.MODE_TRANSPORT_ID=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID)  AND  C.BRANCH_CODE=?

report.chart.portfolio= SELECT  COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b WHERE {0}  A.effective_Date >= SYSDATE and a.status= ''P'' AND b.customer_id= a.customer_id AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND a.product_id=? and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS = ''Y'' AND ORIGINAL_POLICY_NO IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.chart.portfolio.amount= SELECT nvl(sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)),0) PREMIUM FROM POSITION_MASTER a, personal_info b  WHERE {0}  A.effective_Date >= SYSDATE and a.status= ''P'' AND b.customer_id= a.customer_id AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND a.product_id=? and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS = ''Y'' AND ORIGINAL_POLICY_NO IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.chart.quoteregister.lapsed.amount=SELECT nvl(sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)),0) PREMIUM  FROM POSITION_MASTER a, personal_info PI WHERE {0} A.effective_Date < SYSDATE and A.effective_Date+30 >=SYSDATE AND PI.customer_id = a.customer_id AND a.product_id =? AND a.status=''Y'' and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')   AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
report.chart.existing.amount=SELECT nvl(sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)),0) PREMIUM FROM POSITION_MASTER a,MARINE_DATA m, personal_info b  WHERE {0}  A.effective_Date + 30 >\= SYSDATE  AND a.status \= ''Y''  AND (A.REMARKS NOT IN (''Admin'', ''Referal'', ''NORMAL_EXCESS_PRICE''))  AND b.customer_id \= a.customer_id  AND a.product_id \=? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND  M.APPLICATION_NO  \= A.APPLICATION_NO AND  NVL (M.ADMIN_REFERRAL_STATUS, ''N'') NOT IN (''Y'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.unapproved.amount=SELECT nvl(sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)),0) PREMIUM FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD WHERE {0} A.effective_Date  >\= SYSDATE AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Referal'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''Normal'', ''Referal'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''Y'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)  
report.referral.chart.approved.amount=SELECT nvl(sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)),0) PREMIUM FROM POSITION_MASTER a, personal_info b , MARINE_DATA MD  WHERE {0} A.effective_Date >\= SYSDATE AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Admin'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=?  and a.APPLICATION_ID\=NVL(?,''1'') AND NVL(A.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) 
report.referral.chart.reject.amount=SELECT nvl(sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)),0) PREMIUM FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD  WHERE {0} A.effective_date + 30 >= SYSDATE AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status = ''R'' AND b.customer_id = a.customer_id  AND MD.APPLICATION_NO  = A.APPLICATION_NO  AND a.product_id =?  and a.APPLICATION_ID=? AND NVL(A.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.quoteregister.chart.lapsed=SELECT COUNT(a.quote_no)  FROM POSITION_MASTER a, personal_info PI WHERE {0} A.effective_Date < SYSDATE and A.effective_Date+30 >=SYSDATE AND PI.customer_id = a.customer_id AND a.product_id =? AND a.status=''Y'' and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')    AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
report.quoteregister.chart.existing=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a,MARINE_DATA m, personal_info b  WHERE {0}  A.effective_Date + 30 >\= SYSDATE  AND a.status \= ''Y''  AND (A.REMARKS NOT IN (''Admin'', ''Referal'', ''NORMAL_EXCESS_PRICE''))  AND b.customer_id \= a.customer_id  AND a.product_id \= ? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, ''N'') NOT IN (''Y'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.unapproved=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b , MARINE_DATA MD WHERE {0} A.effective_Date  >\= SYSDATE AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Referal'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''Normal'', ''Referal'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''Y'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.approved=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD  WHERE {0} A.effective_Date >= SYSDATE AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND ( (A.REMARKS IN (''Admin'') AND MD.ADMIN_REFERRAL_STATUS  = ''N'') OR (A.REMARKS IN (''Admin'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  = ''N'')) AND MD.APPLICATION_NO  = A.APPLICATION_NO AND a.product_id =?  and a.APPLICATION_ID=NVL(?,''1'') AND NVL(A.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.referral.chart.reject=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b  WHERE {0} A.effective_date + 30 >\= SYSDATE AND a.status \= ''R'' AND b.customer_id \= a.customer_id  AND a.product_id \=?  and a.APPLICATION_ID\=? AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)

##Login
GET_VALID_USER=select login_id,PWD_COUNT from login_master where login_id=? AND APP_ID=? AND STATUS in ('T','Y')
GET_VALID_PWD_DAY=SELECT ROUND(TRUNC(SYSDATE)-TRUNC(PASSDATE-45)) DAYS FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND APP_ID = ?
GET_VALID_PWD_TIME=SELECT ROUND(SYSDATE- PASSDATE-45) AS HOURS FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID = ?
#GET_USER_BASIC_INFO=SELECT lm.LOGIN_ID, lm.USERTYPE, lm.BRANCH_CODE, lm.USER_MAIL,STATUS,PWD_COUNT, USERNAME,(select BRANCH_NAME from branch_master where STATUS='Y' and branch_code=lm.branch_code) BRANCH_NAME, lm.COUNTRY_ID, lm.MENU_ID FROM LOGIN_MASTER lm WHERE lm.LOGIN_ID=? AND APP_ID = ?
GET_USER_BASIC_INFO=SELECT   lm.LOGIN_ID, lm.USERTYPE, lm.BRANCH_CODE, lm.USER_MAIL, lm.STATUS, PWD_COUNT, USERNAME, bm.BRANCH_NAME, bm.BELONGING_BRANCH, lm.COUNTRY_ID, lm.MENU_ID FROM   LOGIN_MASTER lm, branch_master bm WHERE   lm.LOGIN_ID = ? AND APP_ID = ? AND bm.branch_code = lm.branch_code and bm.STATUS = 'Y'
GET_MAIL_FORGOT_VALID=SELECT LOGIN_ID FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USER_MAIL = ? AND APP_ID = ?
GET_COUNT_PWD=SELECT COUNT(*) num FROM (SELECT REGEXP_SUBSTR(PWD,'[^,]+',1,LEVEL) AS USERPWD FROM (SELECT PASSWORD||','||LPASS1||','||LPASS2||','||LPASS3||','||LPASS4||','||LPASS5||','||LPASS6||','||LPASS7||','||LPASS8||','||LPASS9||','||LPASS10 PWD FROM login_master WHERE LOGIN_ID=? AND STATUS IN ('Y','T') AND APP_ID = ?) CONNECT BY LEVEL <= LENGTH(PWD)-LENGTH(REPLACE(PWD,',',''))+1) WHERE USERPWD=?
UPD_USER_PWD=UPDATE LOGIN_MASTER SET LPASS10=LPASS9,LPASS9=LPASS8,LPASS8=LPASS7,LPASS7=LPASS6,LPASS6=LPASS5,LPASS5=LPASS4,LPASS4=LPASS3,LPASS3=LPASS2,LPASS2=LPASS1,LPASS1=PASSWORD,PASSWORD=?,PASSDATE=SYSDATE+45,STATUS='Y' WHERE LOGIN_ID=? AND APP_ID = ? AND STATUS IN ('Y','T')
UPD_USER_PWD_UW=UPDATE LOGIN_MASTER SET  PWD_COUNT=0,LPASS10=LPASS9,LPASS9=LPASS8,LPASS8=LPASS7,LPASS7=LPASS6,LPASS6=LPASS5,LPASS5=LPASS4,LPASS4=LPASS3,LPASS3=LPASS2,LPASS2=LPASS1,LPASS1=PASSWORD,PASSWORD=?,PASSDATE=SYSDATE+45,STATUS='Y' WHERE LOGIN_ID=? AND APP_ID = ? AND STATUS IN ('Y','T')
UPD_USER_PWD_TEMP=UPDATE LOGIN_MASTER SET LPASS10=LPASS9,LPASS9=LPASS8,LPASS8=LPASS7,LPASS7=LPASS6,LPASS6=LPASS5,LPASS5\=LPASS4,LPASS4\=LPASS3,LPASS3\=LPASS2,LPASS2\=LPASS1,LPASS1\=PASSWORD,PASSWORD\=?,PASSDATE\=SYSDATE+45,STATUS\='T',PWD_COUNT\=0 WHERE LOGIN_ID\=? AND APP_ID \= ? 
GET_MAIL_DETAILS=SELECT MAIL_CC, SMTP_HOST, SMTP_USER, SMTP_PWD, EXP_DATE, EXP_TIME, PWD_CNT, PWD_LEN, HOME_APP,SMTP_PORT ,PAYMENT_LINK_CONTENT ,POLICY_CONTENT  from MAIL_MASTER where APP_ID=?
GET_TEMP_PWD_EXP=SELECT TO_CHAR(SYSDATE+?/24,'DD-MM-YYYY hh:mi:ss AM') expireTime FROM DUAL
UPD_PWD_CNT_RESET=UPDATE LOGIN_MASTER SET PWD_COUNT\=0 WHERE LOGIN_ID\=? AND APP_ID \= ? 
UPD_PWD_CNT=UPDATE LOGIN_MASTER SET PWD_COUNT = NVL(PWD_COUNT,0)+1 WHERE LOGIN_ID= ? AND APP_ID = ?
GET_PWD_CNT_INVALID=SELECT PWD_COUNT FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND APP_ID = ?
UPD_PWD_STATUS=UPDATE LOGIN_MASTER SET STATUS = ? WHERE LOGIN_ID=? AND APP_ID = ?
GET_APP_LIST=select app_id, app_name from app_master
GET_APP_INFO=select app_name from app_master where app_id=?
INS_NEW_USER_WS=INSERT into LOGIN_MASTER(USERNAME, LOGIN_ID, PASSWORD, app_id, STATUS, USER_MAIL, USERTYPE, PASSDATE,STARTDATE,PWD_COUNT) values (?,?,?,?,?,?,?,sysdate+45,sysdate,'0')
INS_NEW_USER=INSERT into LOGIN_MASTER(USERNAME, LOGIN_ID, PASSWORD, app_id, STATUS, USER_MAIL, USERTYPE, PASSDATE,STARTDATE,PWD_COUNT) values (?,?,?,?,?,?,?,sysdate+45,to_date(?,'DD/MM/YYYY'),'0')
UPD_USER_INFO=UPDATE LOGIN_MASTER SET APP_ID=?, STATUS=?, USER_MAIL=?, USERTYPE=?,STARTDATE=to_date(?,'DD/MM/YYYY') WHERE LOGIN_ID=? AND APP_ID=?
UPD_MAIL_MASTER=UPDATE MAIL_MASTER SET MAIL_CC=?, SMTP_HOST=?, SMTP_USER=?, SMTP_PWD=?, EXP_TIME=? where app_id=?
UPD_MAIL_CHANGE_WS=UPDATE LOGIN_MASTER SET USER_MAIL=? WHERE LOGIN_ID=? AND APP_ID = ?
UPD_STATUS_CHANGE_WS=UPDATE LOGIN_MASTER SET STATUS=? WHERE LOGIN_ID=? AND APP_ID = ?
GET_USER_INFO_CHANGE=SELECT LOGIN_ID, USERTYPE, USERNAME, STATUS, USER_MAIL, APP_ID, to_char(STARTDATE,'DD/MM/YYYY') STARTDATE FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID=?
GET_ITEM_VALUES = SELECT ITEM_CODE, ITEM_VALUE FROM LIST_ITEM_VALUES WHERE ITEM_TYPE\=?
INS_SESSION_INFO = INSERT INTO SESSION_MASTER(LOGIN_ID, SESSION_ID, START_TIME, STATUS, SYS_IP_ADDRESS) VALUES(?, ?, SYSDATE, 'Y', ?)
UPD_SESSION_INFO = UPDATE SESSION_MASTER SET END_TIME=SYSDATE WHERE LOGIN_ID=? AND STATUS='Y' AND SESSION_ID=?
GET_LOGINID_COUNT=select count(1) from login_master where login_id=? and APP_ID=?

##OPENCOVER REPORT ADMIN
GET_OPENCOVER_REPORT_LIST=select (select USERNAME from login_master where LOGIN_ID\=broker_id) broker_name,(select FIRST_NAME from personal_info pi where pi.customer_id\=b.customer_id and amend_id\=(select max(amend_id) from personal_info p where p.customer_id\=pi.customer_id)) customer_name,customer_id,open_cover_no,status,premium,commission,PRO_COMMISSION from ( select (select distinct(broker_id) from open_cover_master ocm where ocm.proposal_no in (select proposal_no from open_cover_position_master ocpm where ocpm.open_cover_no\=A.open_cover_no)) broker_id,(select distinct(customer_id) from open_cover_master ocm where ocm.proposal_no in (select proposal_no from open_cover_position_master ocpm where ocpm.open_cover_no\=A.open_cover_no)) customer_id,open_cover_no,status,premium,commission,PRO_COMMISSION from (select open_cover_no,count(status) status,nvl(sum(premium+excess_premium),0) premium,nvl(sum( COMMISSION),0) commission ,nvl(sum(PRO_COMMISSION),0) PRO_COMMISSION  from position_master  where status\='P' and product_id\='11' and open_cover_no is not null and INCEPTION_DATE between to_date(?,'DD/MM/YYYY') and to_date(?,'DD/MM/YYYY')+1 and login_id in( select login_id from login_master  where oa_code in (select distinct oa_code from login_master where
GET_MULTI_OPENCOVER_LIST=select count(VESSEL_NAME) vessel_count,VESSEL_NAME, TRANSACTION_ID,sum(PREMIUM) PREMIUM, sum(TOTAL_SUM_INSURED) TOTAL_SUM_INSURED from ( SELECT WMQ.VESSEL_NAME, WMQ.TRANSACTION_ID, PM.QUOTE_NO, MD.TOTAL_SUM_INSURED,(NVL (MD.PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,( SELECT  CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END  FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID\=MPD.SETTLING_AGENT_ID) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_RESULT_DETAILS MRD,WEBSERVICE_MARINE_QUOTE WMQ, MARINE_POLICY_DETAILS MPD, login_master lm WHERE  MRD.APPLICATION_NO\=PM.APPLICATION_NO  AND WMQ.APPLICATION_NO\=PM.APPLICATION_NO AND PM.OPEN_COVER_INT_STATUS\='LINKED' and lm.login_id\=PM.LOGIN_ID AND PM.ENTRY_DATE between to_date(?,'dd/mm/yyyy') and  to_date(?,'dd/mm/yyyy')+1  and WMQ.branch_code\=?  AND PM.REMARKS IN ('Normal', 'Admin')  AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > (SELECT SYSDATE FROM DUAL) AND PM.APPLICATION_ID \= NVL('','1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND MPD.QUOTE_NO\=PM.QUOTE_NO) group by TRANSACTION_ID, VESSEL_NAME order by TRANSACTION_ID desc

##ADMIN DASHBOARD
GET_DASHBOARD_ADMIN=select * from table(chart_report(?,?,'Admin'))
#GET_DUBAITRADE_STATUS=SELECT DECODE (REMARKS, NULL, 'N', 'Y') DUBAI_TRADE_STATUS FROM CONSTANT_DETAIL WHERE REMARKS = ? AND CATEGORY_ID = 149 AND BRANCH_CODE = ? AND STATUS = 'Y'
GET_DUBAITRADE_STATUS=SELECT DECODE (REMARKS, NULL, 'N', 'Y') DUBAI_TRADE_STATUS FROM CONSTANT_DETAIL WHERE DETAIL_NAME = ? AND CATEGORY_ID = 149 AND BRANCH_CODE = ? AND STATUS = 'Y'

GET_ENDT_QUOTENO=select distinct quote_no from marine_data_endt mde where ORIGINAL_POLICY_NO= (select ORIGINAL_POLICY_NO from marine_data_endt where quote_no=?) and ENDT_NO=(select max(ENDT_NO) from marine_data_endt where ORIGINAL_POLICY_NO=mde.ORIGINAL_POLICY_NO)

BROKER_DELETE_PRODUCT=delete from login_user_details where agency_code\=? and product_id\=?
INS_LC_NEW_VALUE_QUOTE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE, EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS, open_cover_no,LC_ID, lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,TO_DATE(?,'dd/mm/yyyy'), SYSDATE,SYSDATE,SYSDATE+365,?,?, ?,?,?,?,?,(select SALE_TERM_ID from sale_term_master where SALE_TERM_NAME='Declared Value' and BRANCH_CODE=?))
UPD_LC_VALUE_QUOTE=update open_cover_lc_master set lc_amount=?,bank_id=?,AMEND_ID=?,LC_DATE =TO_DATE(?,'dd-mm-yyyy'),EXPIRY_DATE=sysdate+365, lc_currency_id=?,LC_ACTUAL_AMOUNT=?, LC_SALE_TERM_ID=( select SALE_TERM_ID from sale_term_master where SALE_TERM_NAME='Declared Value' and BRANCH_CODE=?), effective_date=sysdate where open_cover_NO=? and lc_number=? and lc_id=?

CHECK_VALID_PROMOTIONAL_CODE=select count(*) from promotional_rate_master prm where prm.PROMOTIONAL_CODE\=? and prm.BRANCH_CODE\=? and status\='Y' and prm.start_date<\=sysdate and prm.end_date>\=sysdate and amend_id\=(select max(amend_id) from promotional_rate_master prmm where prmm.PROMOTIONAL_CODE\=prm.PROMOTIONAL_CODE and prmm.BRANCH_CODE\=prm.BRANCH_CODE and prmm.status\='Y' and prmm.start_date<\=sysdate and prmm.end_date>\=sysdate)
GET_BRANCHS_LIST=select branch_code, branch_name from branch_master where status='Y' order by branch_code

UPD_WS_MARINE_QUOTE=call Webservice_Data(?,?,?)
#Rating Engine Queries
GET_COMM_CATEG_LIST=select COMMODITY_TYPEID,DETAIL_NAME from COMMODITY_CATEGORY_MASTER CCM  where BRANCH_CODE\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITY_CATEGORY_MASTER CM WHERE CM.BRANCH_CODE\=CCM.BRANCH_CODE and cm.COMMODITY_TYPEID\=ccm.COMMODITY_TYPEID)

##Commodity Selection##
SER_COMM_SHOW = SELECT COMMODITY_CODE,SUPPLIER_NAME, (SELECT   DISTINCT (COMMODITY_NAME) FROM   COMMODITYMASTER CM WHERE   Wmc.COMMODITY_CODE = CM.COMMODITY_ID AND branch_code = ? and amend_id=(select max(amend_id) from COMMODITYMASTER C where c.COMMODITY_ID=CM.COMMODITY_ID)) COMMODITY_NAME, COMMODITY_DESCRIPTION, SUMINSURED, INVOICE_NUMBER, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE1, PACKAGE_DESCRIPTION, FRAGILE,  DECODE (FRAGILE, 'on', 'Yes', 'off', 'No') FRAGILE_SELECT FROM WEBSERVICE_MARINE_COMMODITY Wmc WHERE APPLICATION_NO =?
commodity.add=INSERT INTO WEBSERVICE_MARINE_COMMODITY (COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED,SUPPLIER_NAME,PACKAGE_DESCRIPTION,INVOICE_NUMBER,INVOICE_DATE,FRAGILE,REFERENCE_NUMBER,APPLICATION_NO,COMMODITY_GROUP_ID) VALUES (?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),?,?,?,?)
#commodity.delete=DELETE FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO\=?
commodity.delete=DELETE FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO\=? AND COMMODITY_CODE\=?
COMMODITY_EXIST=select count(commodity_description) from webservice_marine_commodity where COMMODITY_CODE\=? and application_no\=?
#quotation.commodity=SELECT NVL (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, NVL (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.SUPPLIER_NAME, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.FRAGILE, B.FRAGILE_SELECTED FROM COMMODITYMASTER A LEFT OUTER JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, SUPPLIER_NAME, PACKAGE_DESCRIPTION, INVOICE_NUMBER, FRAGILE, DECODE(FRAGILE,'on','true','off','false') FRAGILE_SELECTED FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO = ?) B ON (B.COMMODITY_CODE = A.COMMODITY_ID) WHERE A.BRANCH_CODE = ? AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID = A.COMMODITY_ID AND BRANCH_CODE = A.BRANCH_CODE) ORDER BY COMMODITY_NAME
quotation.commodity =  SELECT NVL (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, NVL (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.INVOICE_DATE, B.INVOICE_DATE1, B.supplier_name, B.FRAGILE, B.FRAGILE_SELECTED, A.COMMODITY_TYPE_ID,A.GROUP_ID COMMODITY_GROUP_ID FROM COMMODITYMASTER A JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, PACKAGE_DESCRIPTION, INVOICE_NUMBER, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE1, supplier_name, FRAGILE, DECODE (FRAGILE, 'on', 'true', 'off', 'false') FRAGILE_SELECTED,COMMODITY_GROUP_ID FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO = ? AND COMMODITY_CODE = ?) B ON (B.COMMODITY_CODE = A.COMMODITY_ID) WHERE A.BRANCH_CODE = ? AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID = A.COMMODITY_ID AND BRANCH_CODE = A.BRANCH_CODE) ORDER BY COMMODITY_NAME
#quotation.commodity.oc=SELECT NVL (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, NVL (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME_DESC) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.SUPPLIER_NAME, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.FRAGILE, B.FRAGILE_SELECTED FROM OPEN_COVER_COMMODITY_MASTER A LEFT OUTER JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, SUPPLIER_NAME, PACKAGE_DESCRIPTION, INVOICE_NUMBER, FRAGILE, DECODE (FRAGILE, 'on', 'true', 'off', 'false') FRAGILE_SELECTED FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO = ?) B ON (B.COMMODITY_CODE = A.COMMODITY_ID) WHERE A.PROPOSAL_NO=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?) AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO) ORDER BY COMMODITY_NAME
quotation.commodity.oc=SELECT NVL (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, A.COMMODITY_TYPE_ID, NVL (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME_DESC) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.SUPPLIER_NAME, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.INVOICE_DATE, B.FRAGILE, B.FRAGILE_SELECTED FROM OPEN_COVER_COMMODITY_MASTER A LEFT OUTER JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, SUPPLIER_NAME, PACKAGE_DESCRIPTION, INVOICE_NUMBER,  TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE,FRAGILE, DECODE (FRAGILE, 'on', 'true', 'off', 'false') FRAGILE_SELECTED FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO \= ?) B ON (B.COMMODITY_CODE \= A.COMMODITY_ID) WHERE A.PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND A.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO\=A.PROPOSAL_NO) AND COMMODITY_ID\=? ORDER BY COMMODITY_NAME





#Constant master
INS_CONSTANT_MASTER = insert into CONSTANT_MASTER (CATEGORY_ID,CATEGORY_NAME,RSACODE,STATUS,BRANCH_CODE) values ((select nvl(max(CATEGORY_ID),0)+1 from CONSTANT_MASTER where BRANCH_CODE=?),?,?,?,?)
UPD_CONSTANT_MASTER = UPDATE CONSTANT_MASTER SET CATEGORY_NAME=?,STATUS=?,RSACODE=? WHERE CATEGORY_ID=? AND BRANCH_CODE=?
EDIT_CONSTANT_MASTER =SELECT * FROM CONSTANT_MASTER WHERE CATEGORY_ID\=? AND BRANCH_CODE\=?



##RATING UPLOAD
GET_SEQ_TRANS=SELECT SEQ_NAME FROM XL_UPLOAD_TRANSACTION_SERIES WHERE TYPE_ID=? AND STATUS='Y'
INS_TRANS_DET=INSERT INTO XL_UPLOAD_TRANSACTION_DETAILS (TRAN_ID,TRANSACTION_DATE,USER_NAME,FILE_NAME,PATH,STATUS,TYPE_ID,DOWN_STATUS,EFFECTIVE_DATE, BRANCH_CODE) VALUES(?, SYSDATE, ? , ?, ?, 'Y', ?, 'Y', ?, ?)
GET_DB_COLUMNS=SELECT A.EXCEL_HEADER_NAME, B.FIELD_NAME, A.MOBILE_NO_YN, A.MANDATORY_YN, A.DATA_TYPE, A.FIELD_ID, A.HEADER_TYPE FROM XL_UPLOAD_CONFIG_MASTER A, XL_UPLOAD_FIELD_MASTER B WHERE A.TYPE_ID=? AND A.TYPE_ID=B.TYPE_ID AND B.FIELD_ID=A.FIELD_ID AND A.STATUS='Y'
GET_TYPE_INFO=SELECT RAW_TABLE_NAME, MAIN_TABLE_NAME, ERROR_TABLE_NAME FROM XL_UPLOAD_TYPE_MASTER WHERE TYPE_ID\=?
GET_TRANS_DET=SELECT TRAN_ID, to_char(TRANSACTION_DATE,'dd/mm/yyyy') TRANSACTION_DATE, USER_NAME, FILE_NAME, TOTAL_RECORDS, VALID_RECORDS, ERROR_RECORDS  from XL_UPLOAD_TRANSACTION_DETAILS where TRANSACTION_DATE between to_date(?,'mm/dd/yyyy') and to_date(?,'mm/dd/yyyy')+1 and TYPE_ID=? order by tran_id desc
CHK_EXCHANGE_MASTER_EFF_DATE=select count(*) from exchange_master emm where effective_date > to_date(?,'mm/dd/yyyy') and emm.country_id=(select bm.COUNTRY_ID from branch_master bm, login_master lm where bm.branch_code=lm.branch_code and lm.login_id=?) and amend_id=(select nvl(max(amend_id),0) from exchange_master em where emm.country_id=em.country_id)
CHK_EFF_DATE=select count(sysdate) from dual where to_date(to_char(sysdate,'mm/dd/yyyy'),'mm/dd/yyyy') <\= to_date(?,'mm/dd/yyyy')

### BRANCH MASTER
BR_GET_COUNTRIES=SELECT DISTINCT(COUNTRY_ID), COUNTRY_NAME FROM COUNTRY_MASTER ORDER BY COUNTRY_NAME
BR_GET_CURRENCIES=SELECT  DISTINCT(CURRENCY_ID),CURRENCY_NAME FROM CURRENCY_MASTER ORDER BY CURRENCY_NAME
BR_GET_CITIES=SELECT DISTINCT(CITY_ID),CITY_NAME FROM CITY_MASTER WHERE COUNTRY_ID=? ORDER BY CITY_NAME
BR_SAVE_BRANCH=Insert into BRANCH_MASTER (SNO__, BRANCH_CODE, BRANCH_NAME, STATUS, ADDRESS1,ADDRESS2, ADDRESS3, CITY, COUNTRY, PHONE, FAX, EMAIL, AMEND_ID, EFFECTIVE_DATE, REMARKS,HEADER_IMG, FOOTER_IMG, SIGN_IMG, STAMP, CURRENCY_NAME, CURRENCY_ABBREVIATION, CURRENCY_ACRONYM,ORIGINATION_COUNTRY_ID, DESTINATION_COUNTRY_ID, CURRENCY_DECIMAL_NAME,CURRENCY_DECIMAL_DIGIT, DECIMAL_PLACES, TAX, BRANCH_PREFIX ,LANG_YN,BELONGING_BRANCH) Values ((select nvl(max(SNO__),0)+1 from BRANCH_MASTER),(select '0'||to_char(nvl(max(BRANCH_CODE),0)+1) from BRANCH_MASTER),?, ?, ?,?,?,?,?,?,?,?,?, to_date(?,'mm/dd/yy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select BELONGING_BRANCH from BRANCH_MASTER bm where bm.BRANCH_CODE=? and  AMEND_ID=(select max(AMEND_ID) from BRANCH_MASTER where BRANCH_CODE=bm.BRANCH_CODE)))
BR_LOAD_LIST=Select BRANCH_NAME,BRANCH_CODE,CITY,EMAIL,decode(STATUS,'Y','Active','DeActive') STATUS from branch_Master
BR_GET_SEL_BROKER=SELECT SNO__, BRANCH_CODE, BRANCH_NAME, STATUS, ADDRESS1,ADDRESS2, ADDRESS3, CITY, COUNTRY, PHONE, FAX, EMAIL, AMEND_ID,to_char(EFFECTIVE_DATE,'mm/dd/yy') EFFECTIVE_DATE, REMARKS,HEADER_IMG, FOOTER_IMG, SIGN_IMG, STAMP, CURRENCY_NAME, CURRENCY_ABBREVIATION, CURRENCY_ACRONYM,ORIGINATION_COUNTRY_ID, DESTINATION_COUNTRY_ID, CURRENCY_DECIMAL_NAME,CURRENCY_DECIMAL_DIGIT, DECIMAL_PLACES, TAX,BRANCH_PREFIX,LANG_YN,BELONGING_BRANCH FROM BRANCH_MASTER bm where  bm.BRANCH_CODE\=? and AMEND_ID\=(select max(AMEND_ID) from  BRANCH_MASTER where  BRANCH_CODE\=bm.BRANCH_CODE)
BR_GET_BELONG_BRCH=SELECT BRANCH_CODE,BRANCH_NAME FROM BRANCH_MASTER
BR_UPDATE_BRANCH=UPDATE BRANCH_MASTER SET BRANCH_NAME\=?, STATUS\=?, ADDRESS1\=?,ADDRESS2\=?, ADDRESS3\=?, CITY\=?, COUNTRY\=?, PHONE\=?, FAX\=?, EMAIL\=?, AMEND_ID\=?, EFFECTIVE_DATE\=to_date(?,'mm/dd/yy'), REMARKS\=?,HEADER_IMG\=?, FOOTER_IMG\=?, SIGN_IMG\=?, STAMP\=?, CURRENCY_NAME\=?, CURRENCY_ABBREVIATION\=?, CURRENCY_ACRONYM\=?,ORIGINATION_COUNTRY_ID\=?, DESTINATION_COUNTRY_ID\=?, CURRENCY_DECIMAL_NAME\=?,CURRENCY_DECIMAL_DIGIT\=?, DECIMAL_PLACES\=?, TAX\=?, BRANCH_PREFIX\=? ,LANG_YN\=?,BELONGING_BRANCH\=(select BELONGING_BRANCH from BRANCH_MASTER bm where bm.BRANCH_CODE\=? and  AMEND_ID\=(select max(AMEND_ID) from BRANCH_MASTER where BRANCH_CODE\=bm.BRANCH_CODE)) WHERE  BRANCH_CODE\=?


#GET DEDUCTABLES
GET_DEDUCT=SELECT NVL(DEDUCTIBLE,'0') FROM COMMODITY_EXCESS_PREMIUM CEP WHERE ? BETWEEN START_SUM_INSURED AND END_SUM_INSURED AND STATUS='Y' AND AMEND_ID =   (SELECT MAX (AMEND_ID) FROM COMMODITY_EXCESS_PREMIUM WHERE ? BETWEEN START_SUM_INSURED AND END_SUM_INSURED and STATUS = CEP.STATUS )
#For Commission
GET_COMMISSION_DETAILS=SELECT NVL (lud.COMMISSION, 0) COMMISSION FROM login_user_details lud WHERE lud.agency_code = (Select oa_code from login_master lm where  lm.login_id = (Select login_id from position_master where application_no=?)) AND lud.product_id = ? AND lud.amend_id =(SELECT   MAX (amend_id) FROM  login_user_details ludd WHERE   lud.login_id = ludd.login_id AND ludd.product_id = lud.product_id)
UPD_COMMISSION_DETAILS=UPDATE POSITION_MASTER A SET DISCOUNT_PREMIUM\=? WHERE A.APPLICATION_NO\=? AND A.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO\=A.APPLICATION_NO)

#LC FILE UPLOAD
#GET_LC_UPLOAD_DETAILS =select pi.First_name, pm.policy_no,ocbm.BANK_NAME,mpd.LC_NUMBER from position_master pm, personal_info pi, marine_policy_details mpd, open_cover_bank_master ocbm where pm.policy_no\=? and  pm.customer_id\=pi.customer_id and mpd.QUOTE_NO\=pm.quote_no and mpd.BANK_NAME\=ocbm.BANK_ID and ocbm.amend_id\=(select max(amend_id) from open_cover_bank_master ocbm1 where ocbm1.bank_id\=ocbm.bank_id)
GET_LC_UPLOAD_DETAILS = select pi.First_name, pm.policy_no,pm.quote_no,pm.application_no from position_master pm, personal_info pi where pm.quote_no=? and  pm.customer_id=pi.customer_id
GET_LC_UPLOAD_POLICY_DTLS = select ocbm.bank_name,mpd.lc_number,to_char(mpd.LC_DATE,'dd/mm/yyyy') LC_DATE,mpd.BL_AWB_NO,to_char(mpd.BL_AWB_DATE,'dd/mm/yyyy') BL_AWB_DATE,to_char(mpd.SAILING_DATE,'dd/mm/yyyy') SAILING_DATE  from marine_policy_details mpd, open_cover_bank_master ocbm,position_master pm where pm.quote_no=? and mpd.QUOTE_NO=pm.quote_no and mpd.BANK_NAME=ocbm.BANK_ID and ocbm.amend_id=(select max(amend_id) from open_cover_bank_master ocbm1 where ocbm1.bank_id=ocbm.bank_id)
GET_LC_UPLOAD_POL_DTLS =select mrd.invoice_number, to_char(mrd.invoice_date,'DD/MM/YYYY') invoice_date,mrd.DESCRIPTION from marine_result_details mrd, position_master pm where pm.quote_no\=? and mrd.application_no\=pm.application_no
GET_DOCUMENTS_LIST = select file_name,original_file,remarks from lc_file_upload_dtls where POLICY_NO=? order by upload_id
LC_FILE_INSERT = insert into LC_FILE_UPLOAD_DTLS(POLICY_NO,FILE_NAME,LOGIN_ID,ORIGINAL_FILE,REMARKS,STATUS,UPLOAD_ID) values(?,?,?,?,?,?,?)
GET_LC_FILE_LIST = select UPLOAD_ID,ORIGINAL_FILE,FILE_NAME,remarks from LC_FILE_UPLOAD_DTLS where POLICY_NO=? order by upload_id
LC_FILE_DELETE = delete from LC_FILE_UPLOAD_DTLS where UPLOAD_ID=?

#####Claim Query
GET_CLAIM_APP=Select Application_No,(select BRANCH_CODE from login_master lm where lm.login_id=pm.login_id) Branch_code,TO_CHAR(Trunc(pm.INCEPTION_DATE),'DD/MM/YYYY HH/MM/SS') INCEPTION_DATE  From Position_Master pm Where Regexp_substr(Policy_No,'[^-]+',1,1)=? and amend_id=(Select max(Amend_id) from position_master p Where  Regexp_substr(P.Policy_No,'[^-]+',1,1)=Regexp_substr(pm.Policy_No,'[^-]+',1,1))
GET_CLAIM_SCHEDULE=select * from table(schedule_reports(?,?))
GET_COUNT_POLICYNO=SELECT COUNT(POLICY_NO) FROM POSITION_MASTER WHERE POLICY_NO=?
COUNT_CLAIM_POLICYNO=SELECT COUNT(POLICY_NO) FROM Claim_Intimation  WHERE POLICY_NO\=? and status\=? 
GET_CLAIM_CONDITION=SELECT CODEDESC FROM TABLE(SELECT VIEWCLAUSES(?,?,?) FROM DUAL)
GET_BELONGING_BRANCH=select BELONGING_BRANCH from BRANCH_MASTER bm where bm.BRANCH_CODE=? and  AMEND_ID=(select max(AMEND_ID) from BRANCH_MASTER where BRANCH_CODE=bm.BRANCH_CODE)
SAVE_CLAIM=INSERT INTO CLAIM_INTIMATION (POLICY_NO,LOSS_DATE,LOSS_DESCRIPTION,INTIMATION_DATE,CLAIM_REPORTED_DATE,STATUS,REMARKS,SNO,CUSTOMER_NAME)VALUES(?,?,?,SYSDATE,SYSDATE,?,?,?,?)
GET_CLAIM_INTIMATION=Select Count(Policy_No) POLICY_COUNT,TO_CHAR(Trunc(Ci.Intimation_Date),'DD/MM/YYYY') INTIMATION_DATES From Claim_Intimation Ci WHERE STATUS\=? Group By Trunc(Ci.Intimation_Date) Order By Trunc(Ci.Intimation_Date) Asc 
GET_CLAIM_PENDING=select policy_no,customer_name,TO_CHAR(Trunc(Ci.claim_reported_date),'DD/MM/YYYY') REPORTED_DATE,loss_description from claim_intimation ci where TO_CHAR(Trunc(Ci.Intimation_Date),'DD/MM/YYYY')=? AND STATUS=?
GET_CLAIM_EXTRA_DETAIL=SELECT TO_CHAR(Trunc(Ci.LOSS_DATE),'DD/MM/YYYY') LOSS_DATE,LOSS_DESCRIPTION,TO_CHAR(Trunc(Ci.INTIMATION_DATE),'DD/MM/YYYY') INTIMATION_DATE FROM CLAIM_INTIMATION Ci WHERE POLICY_NO =? and STATUS=?
UPDATE_CLAIM=UPDATE CLAIM_INTIMATION SET REMARKS=?,STATUS=?,REMARKS_DATE=SYSDATE  WHERE POLICY_NO=?

#######MAIL INFORMATION#########
GET_QUOTE_MAILIDS = SELECT DECODE(APPLICATION_ID,'1','',(SELECT USER_MAIL FROM LOGIN_MASTER WHERE LOGIN_ID=PM.APPLICATION_ID)) CC_ADDRESS, (SELECT USER_MAIL FROM LOGIN_MASTER WHERE AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID)) TO_ADDRESS FROM POSITION_MASTER PM WHERE APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE  PM1.APPLICATION_NO=PM.APPLICATION_NO)
GET_QUOTE_USER_MAILIDS = SELECT DECODE(APPLICATION_ID,'1','',(SELECT USER_MAIL FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.APPLICATION_ID)) CC_ADDRESS, (SELECT USER_MAIL FROM LOGIN_MASTER WHERE AGENCY_CODE \= (SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.LOGIN_ID)) TO_ADDRESS FROM POSITION_MASTER PM WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE  PM1.APPLICATION_NO\=PM.APPLICATION_NO)
GET_REFERRAL_REQ_MAILIDS = SELECT EMAIL_TO TO_ADDRESS, EMAIL_CC CC_ADDRESS FROM MAIL_DETAILS WHERE BRANCH_CODE=?
GET_REFERRAL_MAIL_DATAS = SELECT PM.QUOTE_NO,PM.APPLICATION_ID, NVL (md.remarks, 'Normal') REFERRAL_REMARKS, DECODE (PM.APPLICATION_ID, '1', '', (SELECT LM.USERNAME FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID = PM.APPLICATION_ID)) ISSUER_NAME, (PI.TITLE || ' ' || PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME, (SELECT NVL (BCM.company_name, ' ') FROM broker_company_master BCM WHERE BCM.agency_code = (SELECT LM.oa_code FROM login_master LM WHERE LM.login_id = PM.LOGIN_ID)) BROKER_COMPANY_NAME FROM POSITION_MASTER PM, MARINE_DATA MD, PERSONAL_INFO PI WHERE PM.APPLICATION_NO = ? AND MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.APPLICATION_NO = PM.APPLICATION_NO) AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID = PI.CUSTOMER_ID) AND MD.AMEND_ID = (SELECT MAX (AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO = MD.APPLICATION_NO)
GET_REFERRAL_USER_MAIL_DATAS =SELECT PM.QUOTE_NO,PM.APPLICATION_ID, NVL (md.remarks, 'Normal') REFERRAL_REMARKS, DECODE (PM.APPLICATION_ID, '1', '', (SELECT LM.USERNAME FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID \= PM.APPLICATION_ID)) ISSUER_NAME, (PI.TITLE || ' ' || PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME, DECODE (PM.APPLICATION_ID,'1',(SELECT (PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME FROM PERSONAL_INFO UPI WHERE UPI.LOGIN_ID\=PM.LOGIN_ID AND UPI.APPLICATION_ID\='2'),(SELECT NVL (BCM.company_name, ' ') FROM broker_company_master BCM WHERE BCM.agency_code \= (SELECT LM.oa_code FROM login_master LM WHERE LM.login_id \= PM.LOGIN_ID))) BROKER_COMPANY_NAME FROM POSITION_MASTER PM, MARINE_DATA MD, PERSONAL_INFO PI WHERE PM.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.APPLICATION_NO \= PM.APPLICATION_NO) AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID \= PI.CUSTOMER_ID) AND MD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO \= MD.APPLICATION_NO)
GET_COMMON_CCADDRESS =SELECT MAIL_CC FROM MAIL_MASTER WHERE APP_ID\=?
GET_BRANCH_MAILIDS = SELECT EMAIL_TO TO_ADDRESS, EMAIL_CC CC_ADDRESS FROM MAIL_DETAILS WHERE BRANCH_CODE=?
GET_INTG_MAILIDS= SELECT EMAIL_TO TO_ADDRESS, EMAIL_CC CC_ADDRESS FROM MAIL_DETAILS where remarks = ?

################################

######## Branch Report Scheduler############
GET_BRANCHDETAILS_LIST = SELECT BRANCH_CODE,BRANCH_NAME FROM BRANCH_MASTER WHERE STATUS='Y'
GET_BRANCH_REPORT_CNT = SELECT COUNT(*) FROM (SELECT * FROM TABLE(ADMINREPORTS(?,?,?,'3',?)) UNION ALL SELECT * FROM TABLE(ADMINREPORTS(?,?,?,'11',?)))
############################################

## EMIRATE WEB SERVICE INTEGRATION Premia 11 ##
GET_INTG_DETAIL=SELECT * FROM pt_intg_flex_tran where  PIFT_LEVEL \=? AND PIFT_POL_NO \=?  and  PIFT_TRAN_SYS_ID\=(select nvl(max(PIFT_TRAN_SYS_ID),0) from pt_intg_flex_tran where PIFT_POL_NO \=?)
GET_ENDT_INTG_DETAIL=SELECT * FROM pt_intg_flex_tran where  PIFT_LEVEL \=? AND PIFT_POL_NO \=? and PIFT_TRAN_SYS_ID\=?

INTEGRATION_MAIL_STATUS=select POLICY_NO,case INTEGRATION_STATUS when 'Y' THEN  'SUCCESS' WHEN 'F' THEN  'FAILED'  ELSE  'EXCEPTION' END as INTEGRATION_STATUS ,INTEGRATION_ERROR,INTEGRATION_RES ,QUOTE_NO ,(select nvl(TITLE,'') || ' ' || nvl(first_name,'') || ' ' || nvl(Last_name,'') from  personal_info where  CUSTOMER_ID\= pm.CUSTOMER_ID) as  CUSTOMER_NAME , ORIGINAL_POLICY_NO from position_master pm where policy_no \=?  
GET_INTG_REPORT=select  PRODUCT_ID,APPLICATION_NO,QUOTE_NO,to_char(ENTRY_DATE,'dd/mm/yyyy') ENTRY_DATE,to_char(INCEPTION_DATE,'dd/mm/yyyy') INCEPTION_DATE,POLICY_NO,OPEN_COVER_NO,LOGIN_ID,APPLICATION_ID,(case INTEGRATION_STATUS when 'Y' then 'Sucess' when 'F' then 'Failed' else 'Error' end) INTEGRATION_STATUS,INTEGRATION_ERRor,LOGIN_ID,(select FIRST_NAME || '  ' ||LAST_NAME from personal_info where CUSTOMER_ID\=pm.CUSTOMER_ID ) CUS_NAME from position_master pm where (pm.inception_date BETWEEN TO_DATE (?,'dd/mm/yyyy') AND TO_DATE (?,'dd/mm/yyyy')+ 1) and  product_id\=?  and INTEGRATION_STATUS\=? and (select BRANCH_CODE from login_master where login_id\=pm.login_id)\=?
GET_DIV_CODE = select CORE_APP_CODE from branch_master where  BRANCH_CODE=?
GET_INTG_REPORT_POL=select  PRODUCT_ID,APPLICATION_NO,QUOTE_NO,to_char(ENTRY_DATE,'dd/mm/yyyy') ENTRY_DATE,to_char(INCEPTION_DATE,'dd/mm/yyyy') INCEPTION_DATE,POLICY_NO,OPEN_COVER_NO,LOGIN_ID,APPLICATION_ID,(case INTEGRATION_STATUS when 'Y' then 'Sucess' when 'F' then 'Failed' else 'Error' end) INTEGRATION_STATUS,INTEGRATION_ERRor,LOGIN_ID from position_master pm where pm.policy_no=?
## endt delete war --- Added by ahamed ibrahim
GET_ENDT_WARSRCC = select (case when  count(*) > 0 then  'YES'  ELSE 'NO'  END) from marine_data  where  application_no  in (select  application_no  from marine_data_endt  where (original_policy_no,endt_no)=(select original_policy_no,(endt_no)-1 from marine_data_endt where application_no=?)) and  EXTRA_COVER_ID>0


## For vat calculation
GET_VAT_INFO = select to_char(md.INCEPTION_DATE,'dd/mm/yyyy') as POL_START_DATE ,md.VAT_APPLICABLE,md.PREMIUM NET_PREMIUM,nvl(md.Policy_fee,'0') POLICY_FEE, md.FINAL_DESTINATION_COUNTRY_ID,md.TRANSIT_FROM_COUNTRY_ID,(select pos.COMMISSION from position_master pos where  pos.quote_no=pm.quote_no) COMMISSION,(select COUNTRY_NAME from country_master cm where COUNTRY_ID= md.FINAL_DESTINATION_COUNTRY_ID and AMEND_ID = (select max(AMEND_ID) from country_master cm1 where cm1.COUNTRY_ID=cm.COUNTRY_ID ))ORG_COUNTRY,( select COUNTRY_NAME from country_master cm where COUNTRY_ID= md.TRANSIT_FROM_COUNTRY_ID and AMEND_ID = (select max(AMEND_ID) from country_master cm1 where cm1.COUNTRY_ID=cm.COUNTRY_ID )) DEST_COUNTRY,md.AC_EXECUTIVE_ID,bcm.RSA_BROKER_CODE ,bcm.VAT_REG_NO BROKER_VAT_REG_NO,pi.MISSIPPI_CUSTOMER_CODE,pi.VAT_REG_NO CUST_VAT_REG_NO,pi.CUST_VAT_YN, led.RSACODE  BDM_CODE,led.VAT_REG_NO BDM_VAT_REG_NO from marine_data md,personal_info pi,broker_company_master bcm,position_master pm,login_executive_details led where bcm.AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=pm.LOGIN_ID) and pm.application_no=md.application_no  and  pm.CUSTOMER_ID=pi.CUSTOMER_ID and  md.AC_EXECUTIVE_ID=led.AC_EXECUTIVE_ID and pm.quote_no=?
GET_VAT_YN = SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID=158 AND BRANCH_CODE='01' AND CATEGORY_DETAIL_ID=? AND STATUS='Y'
GET_VAT_PERCENT =SELECT nvl(PERCENT,0) VAT_TAX FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 and CATEGORY_ID=159 AND STATUS='Y' and TO_DATE (RSACODE,'dd/mm/yyyy') <= TO_DATE (?,'dd/mm/yyyy')
DEL_VAT_INFO= delete from VAT_INFO where QUOTE_NO=?
INSERT_VAT_INFO=Insert into VAT_INFO(QUOTE_NO, PRODUCT_ID, VAT_CUSTOMER_CODE, VAT_REG_NO, VAT_PERCENTAGE,VAT_AMOUNT, POLICY_TYPE, ORG_COUNTRY, DEST_COUNTRY, VAT_FLAG,VAT_TO) Values  (?, ?, ?, ?,?, ?, ?, ?, ?, ?,?)
UPDATE_VAT_MD=update marine_data set VAT_TAX_PERCENT =?,VAT_TAX_AMT=? ,VAT_COMMISSION=? where application_no =(select  application_no from position_master where quote_no=?)
UPDATE_VAT_PM=update POSITION_MASTER POS set PREMIUM =? where  quote_no=?

GET_VAT_NONE=select nvl(FD_CODE,'N') from login_master  where LOGIN_ID\=?
GET_VAT_SALES=select EXCUTIVE_YN from table (VAT_INVOICE_SCEDULE(?,?,?))
UPD_VAT_PI=update personal_info set VAT_REG_NO=? where  MISSIPPI_CUSTOMER_CODE=?
UPD_VAT_WMQ=update webservice_marine_quote set VAT_REG_NO=? where  CORE_CUSTOMER_NAME=?

GET_OPEN_COVER_EXPIRTY_DATE  = select to_char(ocm.POLICY_END_DATE,'dd/mm/yyyy')  from open_cover_master ocm where PROPOSAL_NO=( select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER a where a.open_cover_no=? and status='P' AND AMEND_ID=(SELECT MAX(AMEND_ID)  FROM OPEN_COVER_POSITION_MASTER WHERE A.OPEN_COVER_NO=OPEN_COVER_NO)) and  ocm.AMEND_ID=(SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = ocm.PROPOSAL_NO)
GET_OPEN_COVER_START_DATE =select to_char(ocm.POLICY_START_DATE,'dd/mm/yyyy')  from open_cover_master ocm where PROPOSAL_NO=( select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER a where a.open_cover_no=? and status='P' AND AMEND_ID=(SELECT MAX(AMEND_ID)  FROM OPEN_COVER_POSITION_MASTER WHERE A.OPEN_COVER_NO=OPEN_COVER_NO)) and  ocm.AMEND_ID=(SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = ocm.PROPOSAL_NO)

GET_COUNT_CRS_ORGIN=select count(*) from country_master_detail cmd where cmd.country_id=? and cmd.status in ('Y','R') and cmd.cross_voyage_yn='Y' and  (CASE WHEN upper(cmd.cross_voyage_org_country) = upper(?) THEN 'A'  when Upper(cmd.cross_voyage_org_country)<>upper(?) and upper(cmd.cross_voyage_org_country)=upper('Warehouse') then 'A' ELSE 'R' END)='A' and cmd.amend_id=(select max(AMEND_ID) from country_master_detail cmd2 where cmd.country_id=cmd2.country_id and cmd.status=cmd2.status and cmd.cross_voyage_yn=cmd2.cross_voyage_yn)
GET_COUNT_CRS_DEST=select count(*) from country_master_detail cmd where cmd.country_id=? and cmd.status in ('Y','R') and cmd.cross_voyage_yn='Y' and  (CASE WHEN upper(cmd.cross_voyage_DEST_country) = upper(?) THEN 'A'  when Upper(cmd.cross_voyage_DEST_country)<>upper(?) and upper(cmd.cross_voyage_DEST_country)=upper('Warehouse') then 'A' ELSE 'R' END)='A' and cmd.amend_id=(select max(AMEND_ID) from country_master_detail cmd2 where cmd.country_id=cmd2.country_id and cmd.status=cmd2.status and cmd.cross_voyage_yn=cmd2.cross_voyage_yn)
GET_CATEGORY_GROUP_LIST=SELECT GROUP_ID CODE,GROUP_DESC CODEDESC FROM COMMODITY_GROUPING_TABLE WHERE STATUS = 'Y'
referral.conveyance=SELECT CM.STATUS FROM CONVEYAN_MASTER CM WHERE CM.SNO = ? AND CM.BRANCH_CODE = ? AND CM.AMEND_ID = (SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE SNO = CM.SNO AND BRANCH_CODE = CM.BRANCH_CODE)
GET_SHIPMENT_TRANSIT=select STATUS from constant_detail where CATEGORY_ID='161' and CATEGORY_DETAIL_ID=? and Branch_code=?
report.quoteregister.paymentpending= SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.STATUS  \= 'O' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
PAYMENT_REPORT_LIST=SELECT PREMIUM,MERCHANT_REFERENCE,CUSTOMER_EMAIL,CUSTOMER_NAME,RESPONSE_TRAN_NO,RES_AUTH_CODE,RESPONSE_TIME,REQUEST_TIME,RESPONSE_STATUS,RESPONSE_MESSAGE,CARD_NUMBER_MASKED,RES_REQ_CURRENCY,RES_DECISION,BILL_TO_ADDRESS_LINE1,BILL_TO_ADDRESS_CITY,BILL_TO_ADDRESS_COUNTRY,BILL_TO_ADDRESS_POSTAL_CODE,PAYMENT_LINK,ONLINE_PAYLINK_EXPTIME,QUOTE_NO FROM PAYMENT_DETAIL WHERE PAYMENT_TYPE='ONLINE'  AND REQUEST_TIME BETWEEN TO_TIMESTAMP(?,'dd/mm/yyyy hh24:mi:ss') AND TO_TIMESTAMP(?,'dd/mm/yyyy hh24:mi:ss')
SELECT_PAYMENTLIST_1=select PREMIUM,MERCHANT_REFERENCE,CUSTOMER_EMAIL,CUSTOMER_NAME,RESPONSE_TRAN_NO,RES_AUTH_CODE,RESPONSE_TIME,REQUEST_TIME,RESPONSE_STATUS,RESPONSE_MESSAGE,CARD_NUMBER_MASKED,RES_REQ_CURRENCY,RES_DECISION,BILL_TO_ADDRESS_LINE1,BILL_TO_ADDRESS_CITY,BILL_TO_ADDRESS_COUNTRY,BILL_TO_ADDRESS_POSTAL_CODE,PAYMENT_LINK,ONLINE_PAYLINK_EXPTIME,QUOTE_NO from payment_detail where (to_char(quote_no)=? or merchant_reference=?) AND PAYMENT_TYPE='ONLINE'
SELECT_PAYMENTLIST_2=SELECT PREMIUM,MERCHANT_REFERENCE,CUSTOMER_EMAIL,CUSTOMER_NAME,RESPONSE_TRAN_NO,RES_AUTH_CODE,RESPONSE_TIME,REQUEST_TIME,RESPONSE_STATUS,RESPONSE_MESSAGE,CARD_NUMBER_MASKED,RES_REQ_CURRENCY,RES_DECISION,BILL_TO_ADDRESS_LINE1,BILL_TO_ADDRESS_CITY,BILL_TO_ADDRESS_COUNTRY,BILL_TO_ADDRESS_POSTAL_CODE,PAYMENT_LINK,ONLINE_PAYLINK_EXPTIME,QUOTE_NO FROM PAYMENT_DETAIL WHERE PAYMENT_TYPE='ONLINE'  AND REQUEST_TIME BETWEEN TO_TIMESTAMP(?,'dd/mm/yyyy hh24:mi:ss') AND TO_TIMESTAMP(?,'dd/mm/yyyy hh24:mi:ss')
SELECT_PAYMENTLIST_3=SELECT RESPONSE_MESSAGE,RESPONSE_STATUS,RES_AUTH_TRANS_REF_NO,RES_AUTH_AMOUNT,RES_AUTH_TIME,RES_TRANSACTION_ID,RES_AUTH_CODE,CARD_NUMBER_MASKED,RES_REASON_CODE,RES_DECISION,	RESPONSE_TRAN_NO,APPLICATION_NO,QUOTE_NO,PREMIUM FROM payment_detail where  MERCHANT_REFERENCE=?
UPD_PAYMENT_LIST_1=Update payment_detail set RESPONSE_MESSAGE=?,RESPONSE_STATUS=? ,RES_AUTH_TRANS_REF_NO=?,RES_AUTH_AMOUNT=?,RES_TRANSACTION_ID=?,RES_AUTH_CODE=?,CARD_NUMBER_MASKED=?,RES_REASON_CODE=?,RES_DECISION=?,RESPONSE_TIME=sysdate,	RESPONSE_TRAN_NO=?	 where  MERCHANT_REFERENCE=?
UPD_PAYMENT_LIST_2=update position_master set pdf_broker_status='1' where QUOTE_NO=? 
UPD_PAYMENT_LIST_3=Update payment_detail set RESPONSE_STATUS=? where  MERCHANT_REFERENCE!=? and QUOTE_NO=? and RESPONSE_STATUS='PENDING'
SELECT_WEBSERV_1=select * from WEBSERVICE_MARINE_QUOTE where QUOTE_NO=?
SELECT_PAYMENTLIST_4=select * from payment_detail where MERCHANT_REFERENCE=?
SELECT_PAYMENTLIST_5=select * from payment_detail where quote_no=? and PAYMENT_TYPE='ONLINE' and RESPONSE_STATUS='PENDING' and MERCHANT_REFERENCE=?
SELECT_PAYMENTVENDORMASTER=select * from payment_vendor_master where status='Y' and vendor_id='1'
SELECT_PAYMENTCHK=select NVL(MD.PREMIUM,0)+NVL(MD.EXCESS_PREMIUM,0)+NVL(MD.VAT_TAX_AMT,0) TOTAL_PREMIUM from MARINE_DATA MD where MD.APPLICATION_NO=?
UPD_PAYMENT_LIST_5=Update payment_detail set RESPONSE_MESSAGE=?,RESPONSE_STATUS=? ,RES_AUTH_TRANS_REF_NO=?,RES_AUTH_AMOUNT=?,RES_AUTH_TIME=?,RES_TRANSACTION_ID=?,RES_AUTH_CODE=?,CARD_NUMBER_MASKED=?,RES_REASON_CODE=?,RES_DECISION=?	,RESPONSE_TIME=sysdate,	RESPONSE_TRAN_NO=?  where  MERCHANT_REFERENCE=?
UPD_PAYMENT_LIST_6=Update payment_detail set RESPONSE_STATUS=? where  MERCHANT_REFERENCE!=? and QUOTE_NO=? and RESPONSE_STATUS='PENDING'
SELECT_PAYMENTLIST_6=select * from payment_detail where  PAYMENT_TYPE='ONLINE' and RESPONSE_STATUS='PENDING' and MERCHANT_REFERENCE=?